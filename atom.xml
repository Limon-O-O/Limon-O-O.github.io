<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Limon's Blog]]></title>
  <link href="http://limon.top/atom.xml" rel="self"/>
  <link href="http://limon.top/"/>
  <updated>2016-02-23T11:58:44+08:00</updated>
  <id>http://limon.top/</id>
  <author>
    <name><![CDATA[Limon]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[è¯‘] æ­ç§˜æ§åˆ¶å™¨è§†å›¾çš„åŠ è½½è¿‡ç¨‹]]></title>
    <link href="http://limon.top/controller-load-process/"/>
    <updated>2016-02-02T04:20:57+08:00</updated>
    <id>http://limon.top/controller-load-process</id>
    <content type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥:
<a href="http://szulctomasz.com/ios-uiviewcontrollers-view-loading-process-demystified/">iOS: UIViewControllerâ€™s view loading process demystified</a></p>

<p><a href="https://twitter.com/NatashaTheRobot">@NatashaTheRobot</a>åœ¨å¥¹çš„åšå®¢é‡Œå‘è¿‡ä¸€ç¯‡å…³äºæµ‹è¯•æ§åˆ¶å™¨åŠè§†å›¾åŠ è½½é—®é¢˜çš„æ–‡ç« <a href="http://natashatherobot.com/ios-testing-view-controllers-swift/">The One Weird Trick For Testing View Controllers in Swift</a></p>

<blockquote><p>å¥¹å†™é“ï¼š
    è¿™é‡Œçš„å…³é”®æ˜¯è‹¹æœé‡è½½äº†æ§åˆ¶å™¨è§†å›¾çš„getterå»è°ƒç”¨åŠ è½½è§†å›¾çš„æ–¹æ³•ï¼Œå¹¶åšäº†è®¸å¤šæˆ‘ä»¬æ²¡æœ‰æƒé™è®¿é—®çš„å…¶å®ƒäº‹æƒ…ã€‚å¦‚æœæœ‰è°æ·±å…¥äº†è§£è¿‡å…¶ä¸­çš„å·¥ä½œåŸç†ï¼Œå°½æƒ…åœ°è¯´å‡ºæ¥å§ã€‚</p></blockquote>

<p>äº†è§£èƒŒåçš„å·¥ä½œåŸç†ç¡®å®æ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£çš„äº‹æƒ…ã€‚åœ¨å¥¹çš„é¼“åŠ±ä¸‹ï¼Œæˆ‘å¼€å§‹è¿›è¡Œæ·±å…¥çš„æ¢ç´¢ã€‚</p>

<p>æˆ‘å‘ç°æœ‰ä¸¤ç§æƒ…å†µï¼šæ§åˆ¶å™¨è¢«è®¾ç½®ä¸º window çš„æ ¹æ§åˆ¶å™¨æˆ–è€… æ§åˆ¶å™¨ä¸ä½œä¸ºæ ¹æ§åˆ¶å™¨ï¼ˆä¾‹å¦‚ï¼Œå½“ä½ æƒ³è¦æµ‹è¯•è§†å›¾æ§åˆ¶å™¨ï¼Œå¹¶ä» Storyboard ä¸­å®ä¾‹åŒ–äº†ä¸€ä¸ªæ—¶ï¼‰</p>

<h2>æ§åˆ¶å™¨ä½œä¸ºæ ¹æ§åˆ¶å™¨</h2>

<pre><code>if self.window == nil {
    self.window = UIWindow(frame: UIScreen.mainScreen().bounds)
}

let storyboard = UIStoryboard(name: "Main", bundle: NSBundle.mainBundle())
let vc = storyboard.instantiateViewControllerWithIdentifier("ViewController")
self.window!.rootViewController = vc
</code></pre>

<p>æ¯”å¦‚è¯´ï¼Œè¿™éƒ¨åˆ†ç¨‹åºæµè¿è¡Œåœ¨ <code>-application:DidFinishLaunchingWithOptions:</code> æ–¹æ³•ä¸­ï¼Œ
<img src="http://szulctomasz.com/wp-content/uploads/2015/08/ex-1.png" alt="" />
<code>UIWindow</code> çš„ <code>-makeKeyAndVisible</code> æ˜¯ç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„æ–¹æ³•ï¼Œæ­¤æ–¹æ³•è°ƒç”¨äº† UIWindow çš„ç§æœ‰æ–¹æ³• <code>-addRootViewControllerViewIfPossible</code> å»ä¸ºå…¶æ ¹æ§åˆ¶å™¨æ·»åŠ  viewï¼Œå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚<code>UIWindow</code>  è·å–æ ¹æ§åˆ¶å™¨çš„ <code>view</code> å±æ€§ä¹‹åï¼Œå°±å¼€å§‹äº†è§†å›¾åŠ è½½çš„ä¸€ç³»åˆ—è¿‡ç¨‹ï¼Œé¦–å…ˆè¢«è°ƒç”¨çš„æ–¹æ³•æ˜¯ <code>-loadViewIfRequired</code>ï¼Œæ­¤æ–¹æ³•å†è°ƒç”¨ <code>-loadView</code> æ–¹æ³•ã€‚<code>-loadView</code> æ–¹æ³•è°ƒç”¨ <code>UIViewController</code> çš„çš„å†…éƒ¨æ–¹æ³•æ¥åŠ è½½ Nib ä»¥è¾¾åˆ°è®¾ç½®è§†å›¾çš„ç›®çš„ã€‚</p>

<p>ä»Šå¹´ï¼ˆ2015å¹´ï¼‰çš„ WWDC ä¸Šæœ‰ä¸ªéå¸¸å¥½çš„æ¼”è®²ï¼Œä»‹ç»äº† <code>storyboard</code> åŠ <code>nibs</code> åœ¨è¿è¡Œæ—¶æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚<a href="https://developer.apple.com/videos/wwdc/2015/?id=407">Implementing UI Design in Interface Builder</a></p>

<p>åœ¨ <code>loadView</code> è®¾ç½®å¥½åï¼Œæ§åˆ¶å™¨è°ƒç”¨å®ƒå†…éƒ¨çš„æ–¹æ³• <code>-_window</code>ï¼Œå¹¶è¯»å–äº†è¯¸å¦‚<code>preferedInterfaceOrientation</code>ã€<code>supportedInterfaceOrientations</code>ã€<code>shouldAutorotate</code>çš„è®¸å¤šè®¾ç½®ã€‚äº‹å®ä¸Šï¼Œæ§åˆ¶å™¨è°ƒç”¨äº† <code>-_window</code> è®¸å¤šæ¬¡ï¼Œæ­¤å¤–ä¹Ÿè°ƒç”¨äº†è®¸å¤šå…¶å®ƒæ–¹æ³•ã€‚</p>

<p>æ¥ç€ï¼Œ<code>-viewDidLoad</code> æ–¹æ³•è¢«è°ƒç”¨ï¼Œç§æœ‰ <code>-__viewWillAppear</code> è°ƒç”¨ <code>-viewWillAppear</code>ã€‚è§†å›¾å³å°†è¢«å‘ˆç°å‡ºæ¥ï¼Œæ‰€ä»¥ <code>-willMoveToWindow:</code> <code>-willMoveToSuperview:</code> å’Œç§æœ‰ <code>-_didMoveFromWindow:toWindow:</code> ç­‰æ–¹æ³•è¢«è°ƒç”¨ã€‚</p>

<p>ä¸‹ä¸€æ­¥æ˜¯ä¸ºè§†å›¾ä½œè‡ªåŠ¨å¸ƒå±€ï¼Œæ‰€ä»¥ <code>layoutMarginsDidChange, didMoveToWindow, didMoveToSuperview, updateViewConstraints, updateConstraints, layoutSublayersOfLayer, viewWillLayoutSubviews, layoutSubviews</code> ç­‰ä¸€ç³»åˆ—æ–¹æ³•è¢«è°ƒç”¨</p>

<p>æœ€åï¼Œ<code>-viewDidAppear:</code>è¢«è°ƒç”¨äº†ï¼Œè§†å›¾ä¹Ÿå‘ˆç°å‡ºæ¥äº†ã€‚</p>

<h4>.</h4>

<h2>æ™®é€šæ§åˆ¶å™¨çš„åŠ è½½æµ‹è¯•</h2>

<p>è¿™æ˜¯å¦å¤–ä¸€ä¸ªå€¼å¾—å»ç ”ç©¶çš„é‡è¦æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ ä¸ç”¨åˆ›å»º <code>window</code> å¹¶æŠŠä½ çš„ <code>view controller</code> åŠ åˆ°å…¶ä¸Šæ¥è¿›è¡Œæµ‹è¯•ï¼Œåªéœ€è¦é€šè¿‡storyboardåˆ›å»ºæ§åˆ¶å™¨çš„å®ä¾‹ä»¥è¿›è¡Œæµ‹è¯•ã€‚åœ¨çœ‹äº† Natasha çš„æ–‡ç« ä¹‹å‰ï¼Œæˆ‘åªçŸ¥é“ç›´æ¥é€šè¿‡è®¿é—®æ§åˆ¶å™¨çš„ <code>view</code> å±æ€§æ¥è·å–è§†å›¾ã€‚ç°åœ¨æˆ‘çŸ¥é“åœ¨ iOS9 ä¹‹åï¼Œ<code>-loadViewIfNeeded</code> æ–¹æ³•å’Œè®¿é—®å±æ€§ <code>view</code> çš„è¡Œä¸ºæ˜¯ä¸€æ ·çš„ã€‚å¹¶ä¸”åœ¨<a href="https://github.com/orta">Ã˜rta</a>çš„æ¨èä¸‹ï¼Œæˆ‘çŸ¥é“äº†ä¸¤ä¸ªæ›´å¥½çš„æ–¹æ³• å»æµ‹è¯•æ§åˆ¶å™¨è§†å›¾çš„åŠ è½½å¹¶ç¡®ä¿å…¶å¯ç”¨ã€‚<code>-beginAppearanceTransition:animated</code> å’Œ <code>-endApperanceTransition</code>ã€‚<a href="https://github.com/artsy/eigen/blob/master/Artsy_Tests/Extensions/UIViewController+PresentWithFrame.m#L20-L22">è¿™æ˜¯ä»–æ¨èçš„æ–¹æ³•</a></p>

<h3>ç›´æ¥è®¿é—®Viewå±æ€§</h3>

<p>è®©æˆ‘ä»¬çœ‹çœ‹ç›´æ¥è®¿é—® <code>view</code> æ—¶çš„æƒ…å†µã€‚</p>

<pre><code>let storyboard = UIStoryboard(name: "Main", bundle: NSBundle.mainBundle())
let vc = storyboard.instantiateViewControllerWithIdentifier("ViewController")
_ = vc.view
</code></pre>

<p><img src="http://szulctomasz.com/wp-content/uploads/2015/08/ex-2.png" alt="" /></p>

<p>å¥½å§ï¼Œè®¸å¤šæ–¹æ³•æ²¡è¢«è°ƒç”¨ã€‚<code>window</code> ä¸º <code>nil</code>ï¼Œè§†å›¾å¯ä»¥è¢«è®¿é—®å’ŒåŠ è½½ï¼Œå›¾ä¸Šçš„åŠ è½½è¿‡ç¨‹å´åœ¨ <code>-viewDidLoad</code> ä¸­å°±ç»“æŸäº†ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºè¿˜æœ‰è®¸å¤šæ–¹æ³•æ²¡è¢«æ‰¾å‡ºæ¥ã€‚</p>

<p>è®©æˆ‘ä»¬çœ‹çœ‹ <code>-beginApperanceTransition:animated:</code> æ˜¯æ€æ ·å·¥ä½œçš„ã€‚</p>

<h3>beginApperanceTransition:animated</h3>

<pre><code>let storyboard = UIStoryboard(name: "Main", bundle: NSBundle.mainBundle())
let vc = storyboard.instantiateViewControllerWithIdentifier("ViewController")
vc.beginAppearanceTransition(true, animated: false)
vc.endAppearanceTransition()
</code></pre>

<p><img src="http://szulctomasz.com/wp-content/uploads/2015/08/ex-3.png" alt="" /></p>

<p>éå¸¸å¥½ï¼Œè¿™æ¬¡çš„åŠ è½½è¿‡ç¨‹æ¯”ç¬¬ä¸€ä¸ªè¦è¯¦ç»†ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œ <code>window</code> åŒæ ·æ˜¯ <code>nil</code>ï¼Œæ‰€ä»¥æ§åˆ¶å™¨çš„è§†å›¾ï¼Œæ²¡æœ‰å‡ºç°åœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼Œä¹Ÿæ²¡æœ‰è®¾ç½®å¸ƒå±€çš„ä»£ç åœ¨è¿è¡Œï¼Œä»…ä»…æ˜¯æ§åˆ¶å™¨çš„ä¸€äº›è®¾ç½®ã€‚</p>

<blockquote><p>è¯‘è€…ï¼šè¿™é‡Œå¯èƒ½å¾ˆéš¾ç†è§£ï¼Œå¯ä»¥ç»“åˆæœ¬æ–‡çš„ä¸‰ä¸ªå›¾ï¼Œå›¾éƒ½æ˜¯åˆ†ä¸‰åˆ—ï¼Œåˆ†åˆ«ä¸º <code>UIWindow</code>ã€<code>UIViewController</code>ã€<code>UIView</code>ï¼Œè¿™é‡Œè¯´ <code>window</code> åŒæ ·æ˜¯ <code>nil</code> çš„æ„æ€æ˜¯ï¼Œ<code>UIWindow</code> åˆ—æ²¡å‡ºç°ä¸œè¥¿ï¼ŒåŸå› æ˜¯æ§åˆ¶å™¨ä¸æ˜¯æ ¹æ§åˆ¶å™¨ï¼Œè¿™é‡Œä»…ä»…æµ‹è¯•å•ç‹¬ä¸€ä¸ªæ§åˆ¶å™¨ã€‚ä½œè€…åœ¨è¿™é‡Œæƒ³è¡¨è¾¾çš„æ„æ€æ˜¯</p></blockquote>

<h2>æ€»ç»“</h2>

<p>ç°åœ¨åº”è¯¥çŸ¥é“ï¼Œè§†å›¾çš„åŠ è½½è¿‡ç¨‹å–å†³äºæ§åˆ¶å™¨çš„ä¸Šä¸‹æ–‡ã€‚</p>

<p>åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œæ§åˆ¶å™¨ä½œä¸ºæ ¹æ§åˆ¶å™¨ï¼Œæ‰€ä»¥æ§åˆ¶å™¨å’Œè§†å›¾éƒ½è¿›è¡Œäº†è®¸å¤šè®¾ç½®ã€‚</p>

<p>åœ¨æœ€åçš„ä¸€ä¸ªä¾‹å­ä¸­ï¼Œå› ä¸ºæ²¡æœ‰ <code>UIWindow</code>ï¼Œåªæœ‰æ§åˆ¶å™¨åˆå§‹åŒ–äº†ï¼Œè¿è§†å›¾ä¹Ÿæ²¡æœ‰åˆå§‹åŒ–çš„éœ€è¦ å¿…è¦ã€‚è¿™ç§æƒ…å†µå°±ç±»ä¼¼äºæ¨¡æ‹Ÿ <code>present</code> ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œå› æ­¤ <code>-viewWillAppear</code> å’Œ <code>-viewDidAppear</code> æ–¹æ³•è¢«è°ƒç”¨äº†ã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹æˆ–è®¸å¾ˆé‡è¦ã€‚</p>

<p>æœ€åï¼Œæˆ‘è¦å†è°ˆè°ˆç¬¬äºŒä¸ªä¾‹å­ã€‚
åœ¨ä¸çŸ¥é“ <code>-beginApperanceTransition:animated</code> ä¹‹å‰ï¼Œæˆ‘ä»¥ä¸º viewWill/viewDid ä¼šè¢«è°ƒç”¨ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ï¼Œå°±å¦‚ä»¥ä¸Šå›¾äºŒæ‰€ç¤ºã€‚Ã˜rta æä¾›çš„æ–¹æ³•å¯èƒ½æ˜¯æµ‹è¯•æ§åˆ¶å™¨çš„æœ€å¥½é€”å¾„ä¹‹ä¸€ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Realm Thread æµ…æ]]></title>
    <link href="http://limon.top/RealmThread/"/>
    <updated>2016-01-14T02:27:14+08:00</updated>
    <id>http://limon.top/RealmThread</id>
    <content type="html"><![CDATA[<p>ä¸¤ä¸ªåŒä¸€ï¼šåŒä¸€ä¸ª realmã€åŒä¸€ä¸ªçº¿ç¨‹ï¼Œä¸¤è€…ç¼ºä¸€ä¸å¯ã€‚</p>

<p>æ‰“å¼€ Appï¼Œé¦–å…ˆä» Realm ä¸­è·å–é¦–é¡µçš„æ•°æ®ï¼Œæ­¤æ—¶åœ¨ <strong>ä¸»çº¿ç¨‹</strong> è°ƒç”¨ <code>-fetchArticlesFromRealmByType(.Home)</code>ï¼Œæ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªå…ƒç»„ï¼š <code>result: (articles: [Article], articleObjects: [ArticleObject])</code>ï¼Œå‰è€…æ˜¯æ¨¡å‹ï¼Œåè€…æ˜¯ Realm çš„ <code>Object</code>ã€‚</p>

<p>ç„¶åå†è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œç½‘ç»œè¯·æ±‚å®Œä¹‹åï¼Œ<strong>ä¸»çº¿ç¨‹</strong> æ›´æ–° UIï¼Œå¹¶ä¿å­˜æ•°æ®æœ€æ–°çš„æ•°æ®å’Œåˆ é™¤æ—§çš„æ•°æ®ï¼ˆ[ArticleObject]ï¼‰ã€‚
ä¿å­˜æ•°æ®ç›´æ¥å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ª Realmï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘ <strong>ä¸¤ä¸ªåŒä¸€</strong>ã€‚</p>

<p>é‡ç‚¹è®²åˆ é™¤æ•°æ®çš„ä¸¤ä¸ªåŒä¸€ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">func</span> <span class="nf">fetchArticlesFromRealmByType</span><span class="p">(</span><span class="nl">articleType</span><span class="p">:</span> <span class="n">ArticleType</span><span class="p">,</span> <span class="nl">result</span><span class="p">:</span> <span class="p">(</span><span class="nl">articles</span><span class="p">:</span> <span class="p">[</span><span class="n">Article</span><span class="p">],</span> <span class="nl">articleObjects</span><span class="p">:</span> <span class="p">[</span><span class="n">ArticleObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Void</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// çœç•¥éƒ¨åˆ†ä»£ç ...</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// æˆåŠŸä»æœ¬åœ°æ•°æ®åº“ä¸­è·å–æ•°æ®ä¹‹åï¼Œåœ¨ **ä¸»çº¿ç¨‹*** å›è°ƒï¼Œåœ¨å¤–é¢æ›´æ–° UIï¼Œå¹¶æŒæœ‰ articleObjectsï¼Œå¾…ç½‘ç»œè¯·æ±‚å®Œï¼Œåˆ é™¤æ­¤ articleObjects</span>
</span><span class='line'>  <span class="k">let</span> <span class="n">articleRealmObjects</span> <span class="o">=</span> <span class="n">realm</span><span class="p">.</span><span class="n">objects</span><span class="p">(</span><span class="n">ArticleObject</span><span class="p">)</span>
</span><span class='line'>  <span class="n">result</span><span class="p">(</span><span class="nl">articles</span><span class="p">:</span> <span class="n">articles</span><span class="p">,</span> <span class="nl">articleObjects</span><span class="p">:</span> <span class="n">articleRealmObjects</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// æ³¨æ„ï¼ŒObject ä¸èƒ½åˆ‡æ¢çº¿ç¨‹ï¼Œæ„æ€å°±æ˜¯è¯´ï¼Œä½ å¦‚æœåœ¨ Background çº¿ç¨‹å¾—åˆ° articleRealmObjectsï¼Œä¸èƒ½å†åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹å›è°ƒå‡ºå»ï¼Œæ¨èä½¿ç”¨é€šçŸ¥ã€‚</span>
</span><span class='line'>  <span class="n">Queue</span><span class="p">.</span><span class="n">Background</span><span class="p">.</span><span class="n">execute</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">articleRealmObjects</span> <span class="o">=</span> <span class="n">realm</span><span class="p">.</span><span class="n">objects</span><span class="p">(</span><span class="n">ArticleObject</span><span class="p">)</span>
</span><span class='line'>    <span class="n">Queue</span><span class="p">.</span><span class="n">Main</span><span class="p">.</span><span class="n">execute</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">result</span><span class="p">(</span><span class="nl">articles</span><span class="p">:</span> <span class="n">articles</span><span class="p">,</span> <span class="nl">articleObjects</span><span class="p">:</span> <span class="n">articleRealmObjects</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">func</span> <span class="nf">deleteObject</span><span class="p">(</span><span class="nl">articleObjects</span><span class="p">:</span> <span class="p">[</span><span class="n">ArticleObject</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">guard</span> <span class="k">let</span> <span class="n">articleObjects</span> <span class="o">=</span> <span class="n">articleObjects</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">let</span> <span class="n">_</span> <span class="o">=</span> <span class="n">try</span><span class="o">?</span> <span class="n">articleObjects</span><span class="p">.</span><span class="n">first</span><span class="o">?</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">write</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">articleObjects</span><span class="p">.</span><span class="n">first</span><span class="o">?</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">articleObjects</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>åŒä¸€ä¸ªçº¿ç¨‹</h3>

<p>å¾…ç½‘ç»œè¯·æ±‚å®Œåï¼Œæƒ³è¦åˆ é™¤æ—§çš„ <code>articleObjects</code>ï¼Œåº”è¯¥åœ¨ <code>articleObjects</code> åŒä¸€çº¿ç¨‹å†…åˆ é™¤ï¼Œåœ¨æ­¤ä¾‹å­ä¸­ï¼Œ<code>articleObjects</code> æ˜¯ä» <code>Queue.Main</code> ä¸­å¾—åˆ°ï¼Œé‚£åˆ é™¤æ—¶ä¹Ÿè¦åœ¨æ­¤çº¿ç¨‹åˆ é™¤ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">Queue</span><span class="p">.</span><span class="n">Main</span><span class="p">.</span><span class="n">execute</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="s">&quot;delete action on thread: \(NSThread.currentThread())&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">deleteObject</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">articleObjects</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœæ‰“å°å‡ºæ¥çš„å†…å­˜åœ°å€å’Œåœ¨ <code>-fetchArticlesFromRealmByType(.Home)</code> æ‰“å°çš„ä¸åŒï¼Œæ­¤æ—¶å°±ä¼š Crash: <code>Realm accessed from incorrect thread.</code></p>

<blockquote><p>å¦‚æœæ˜¯åœ¨ä¸²è¡Œé˜Ÿåˆ—ä¸­ï¼Œéœ€è¦æŒæœ‰æ­¤é˜Ÿåˆ—ï¼Œå°±ç®— <code>-dispatch_queue_create(key, _)</code> ä¸­çš„ key æ¯æ¬¡åˆ›å»ºéƒ½æ˜¯åŒä¸€ä¸ª keyï¼Œä¹Ÿä¸èƒ½ä¿è¯æ‰€æœ‰ä¸²è¡Œä»»åŠ¡éƒ½åœ¨åŒä¸€ä¸ªé˜Ÿåˆ—å¯¹è±¡ä¸­ã€‚</p></blockquote>

<h3>åŒä¸€ä¸ª realm</h3>

<p>å¯ä»¥ç›´æ¥ä» <code>ArticleObject</code> è·å– <code>realm</code>ï¼Œå‰ææ˜¯æ•°ç»„å†…æ‰€æœ‰çš„ Object éƒ½æ˜¯åœ¨åŒä¸€ä¸ª <code>realm</code> å†…ã€‚(è¿˜æ²¡é‡åˆ°è¿‡ï¼Œä¸€ä¸ªæ•°ç»„å†…æ”¾ä¸åŒ realm çš„ Object è¿™æ ·å˜æ€çš„éœ€æ±‚ -.- )</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">_</span> <span class="o">=</span> <span class="n">try</span><span class="o">?</span> <span class="n">articleObjects</span><span class="p">.</span><span class="n">first</span><span class="o">?</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">write</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">articleObjects</span><span class="p">.</span><span class="n">first</span><span class="o">?</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">articleObjects</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåˆ é™¤äº†æ­¤ <code>articleObject</code>ä¹‹åï¼Œå¦‚æœä½ è¿˜è®¿é—®äº†æ­¤å¯¹è±¡çš„è‡ªå®šä¹‰å±æ€§ï¼Œå°±ä¼š Crash: <code>Object has been deleted or invalidated.</code></p>

<p>ä¾‹å¦‚ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">_</span> <span class="o">=</span> <span class="n">try</span><span class="o">?</span> <span class="n">articleObject</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">write</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">articleObject</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="n">articleObject</span><span class="p">.</span><span class="n">title</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>å› ä¸º <code>articleObject</code> å·²ç»æ— æ•ˆäº†ï¼Œå› æ­¤ç¨³å¦¥ç‚¹ï¼Œåœ¨è®¿é—®å‰å…ˆåˆ¤æ–­æ­¤ <code>Object</code> çš„æœ‰æ•ˆæ€§ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">func</span> <span class="nf">deleteObject</span><span class="p">(</span><span class="nl">articleObjects</span><span class="p">:</span> <span class="p">[</span><span class="n">ArticleObject</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">guard</span> <span class="k">let</span> <span class="n">articleObject</span> <span class="o">=</span> <span class="n">articleObjects</span><span class="p">.</span><span class="n">first</span> <span class="k">where</span> <span class="o">!</span><span class="n">articleObject</span><span class="p">.</span><span class="n">invalidated</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">articleObject</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">isEmpty</span> <span class="o">??</span> <span class="nb">true</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">let</span> <span class="n">_</span> <span class="o">=</span> <span class="n">try</span><span class="o">?</span> <span class="n">articleObject</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">write</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">articleObject</span><span class="p">.</span><span class="n">realm</span><span class="o">?</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>åœ¨ <a href="http://nshipster.com/new-years-2016/#swiftier-gcd">NSHipster</a> æ‰¾åˆ°çš„ GCD å°è£…</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">protocol</span> <span class="n">ExcutableQueue</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">var</span> <span class="nl">queue</span><span class="p">:</span> <span class="kt">dispatch_queue_t</span> <span class="p">{</span> <span class="kr">get</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">extension</span> <span class="n">ExcutableQueue</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">func</span> <span class="n">execute</span><span class="p">(</span><span class="nl">closure</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Void</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">dispatch_async</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="n">closure</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">enum</span> <span class="nl">Queue</span><span class="p">:</span> <span class="n">ExcutableQueue</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Main</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">UserInteractive</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">UserInitiated</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Utility</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Background</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">var</span> <span class="nl">queue</span><span class="p">:</span> <span class="kt">dispatch_queue_t</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">switch</span> <span class="nb">self</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="p">.</span><span class="nl">Main</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">dispatch_get_main_queue</span><span class="p">()</span>
</span><span class='line'>        <span class="k">case</span> <span class="p">.</span><span class="nl">UserInteractive</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">QOS_CLASS_USER_INTERACTIVE</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="k">case</span> <span class="p">.</span><span class="nl">UserInitiated</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">QOS_CLASS_USER_INITIATED</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="k">case</span> <span class="p">.</span><span class="nl">Utility</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">QOS_CLASS_UTILITY</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="k">case</span> <span class="p">.</span><span class="nl">Background</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">QOS_CLASS_BACKGROUND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Debug æ¨¡å¼ä¸ Release æ¨¡å¼çš„åŒºåˆ†]]></title>
    <link href="http://limon.top/debugbuild/"/>
    <updated>2016-01-08T11:31:30+08:00</updated>
    <id>http://limon.top/debugbuild</id>
    <content type="html"><![CDATA[<h1>Debug æ¨¡å¼ä¸ Release æ¨¡å¼çš„åŒºåˆ†</h1>

<p><br />
åŒºåˆ† Debug æ¨¡å¼ä¸ Release æ¨¡å¼æœ‰ä¸¤ç§æ–¹æ³•ï¼Œæ­¤æ–‡çš„ç›®çš„æ˜¯å‘Šè¯‰è¯»è€…å°½é‡é¿å…ç”¨ <code>-DDEBUG</code>ã€‚</p>

<h4>ç¬¬ä¸€ç§æ–¹æ³•ï¼š</h4>

<p>åœ¨ (Build Settings -> Swift Compiler - Custom Flags) ä¸­åŠ å…¥ <code>-DDEBUG</code>ï¼Œ
<a href="http://stackoverflow.com/questions/24111854/in-absence-of-preprocessor-macros-is-there-a-way-to-define-practical-scheme-spe/#answer-24112024">Stackoverflow</a>ã€‚</p>

<p><img src="http://i.stack.imgur.com/dqp5H.png" alt="" /></p>

<p>ä½†æ˜¯åœ¨ NSHipster ä¸­æœ‰æåˆ°<strong><em>ä¸æ¨è</em></strong>æ­¤æ–¹æ³•  <a href="http://nshipster.com/new-years-2016/#avoiding--ddebug-in-swift">Avoiding -DDEBUG in Swift</a></p>

<p><br /></p>

<h4>ç¬¬äºŒç§æ–¹æ³•</h4>

<p>é€šè¿‡ Preprocessor Macros (é¢„å¤„ç†å®å‘½ä»¤) æ¥åŒºåˆ†æ¨¡å¼ã€‚</p>

<p><br /></p>

<p>1.æ–°å»ºä¸€ä¸ª <code>PreProcessorMacros.h</code> æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="cp">#import &lt;Foundation/Foundation.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@interface</span> <span class="nc">PreProcessorMacros</span> : <span class="bp">NSObject</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifndef PreProcessorMacros_h</span>
</span><span class='line'><span class="cp">#define PreProcessorMacros_h</span>
</span><span class='line'>
</span><span class='line'><span class="k">extern</span> <span class="kt">BOOL</span> <span class="k">const</span> <span class="n">DEBUG_BUILD</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">@implementation</span> <span class="nc">PreProcessorMacros</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef DEBUG</span>
</span><span class='line'>    <span class="kt">BOOL</span> <span class="k">const</span> <span class="n">DEBUG_BUILD</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>    <span class="kt">BOOL</span> <span class="k">const</span> <span class="n">DEBUG_BUILD</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<p>2.åœ¨ Bridged Header: <code>#import "PreProcessorMacros.h"</code></p>

<blockquote><p>ä¹Ÿå¯ç›´æ¥æŠŠæ­¥éª¤ä¸€çš„ä»£ç æ”¾è¿› Bridged Header</p></blockquote>

<p><br /></p>

<p>3.æµ‹è¯•</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">if</span> <span class="n">DEBUG_BUILD</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;It&#39;s Debug build&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;It&#39;s Release build&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>âŒ˜â‡§&lt;</strong> è¿›å…¥ä¸‹å›¾å¯æ¨¡å¼åˆ‡æ¢</p>

<p><img src="https://raw.githubusercontent.com/Limon-O-O/DEBUGBUILD/master/images/switch.png" alt="" /></p>

<p><br /></p>

<h2>åŸç†</h2>

<p>å…³é”®çš„ä»£ç åœ¨ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="cp">#ifdef DEBUG</span>
</span><span class='line'>    <span class="kt">BOOL</span> <span class="k">const</span> <span class="n">DEBUG_BUILD</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>    <span class="kt">BOOL</span> <span class="k">const</span> <span class="n">DEBUG_BUILD</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'><span class="cp">#endif</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ­¤å¤„çš„ <code>DEBUG</code> ç©¶ç«Ÿæ¥è‡ªå“ªï¼Ÿ</p>

<p>è¿›å…¥ &lsquo;Build Settings&rsquo; -> æœç´¢ &lsquo;Preprocessor Macros&#8217;ï¼ŒçœŸç›¸å¤§ç™½</p>

<p><img src="https://raw.githubusercontent.com/Limon-O-O/DEBUGBUILD/master/images/PreprocessorMacros.png" alt="" /></p>

<p><br />
æºç ï¼š<a href="https://github.com/Limon-O-O/DEBUGBUILD">DEBUGBUILD</a></p>

<p>æŠ½å–äºå¹²è´§æå¤šçš„ï¼š<a href="http://nshipster.com/new-years-2016/">Reader Submissions -
New Year&rsquo;s 2016</a>  ğŸº</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[èŠ±å¼è‡ªå®šä¹‰ä¸‹æ ‡]]></title>
    <link href="http://limon.top/subscriptswift/"/>
    <updated>2016-01-05T17:56:42+08:00</updated>
    <id>http://limon.top/subscriptswift</id>
    <content type="html"><![CDATA[<h1>èŠ±å¼è‡ªå®šä¹‰ä¸‹æ ‡</h1>

<h3>ä¸€ã€æšä¸¾ä½œ Key</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">dictionaryOne</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>        <span class="n">MyDictionaryKeys</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nl">rawValue</span><span class="p">:</span> <span class="s">&quot;Limon&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="n">MyDictionaryKeys</span><span class="p">.</span><span class="n">Age</span><span class="p">.</span><span class="nl">rawValue</span><span class="p">:</span> <span class="n">Int</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
</span><span class='line'><span class="p">]</span>
</span><span class='line'><span class="k">let</span> <span class="n">name</span> <span class="o">=</span> <span class="n">dictionaryOne</span><span class="p">[.</span><span class="n">Name</span><span class="p">]</span><span class="o">!</span>
</span><span class='line'><span class="k">let</span> <span class="n">age</span> <span class="o">=</span> <span class="n">dictionaryOne</span><span class="p">[.</span><span class="n">Age</span><span class="p">]</span><span class="o">!</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">enum</span> <span class="nl">MyDictionaryKeys</span><span class="p">:</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Name</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Age</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">extension</span> <span class="n">Dictionary</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">subscript</span><span class="p">(</span><span class="nl">customKey</span><span class="p">:</span> <span class="n">MyDictionaryKeys</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyObject</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">guard</span> <span class="k">let</span> <span class="n">key</span> <span class="o">=</span> <span class="n">customKey</span><span class="p">.</span><span class="n">rawValue</span> <span class="kt">as</span><span class="o">?</span> <span class="n">Key</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="nb">nil</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">in</span> <span class="nb">self</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">k</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">return</span> <span class="n">value</span> <span class="kt">as</span><span class="o">?</span> <span class="n">String</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="nb">nil</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">extension</span> <span class="bp">NSDictionary</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">subscript</span><span class="p">(</span><span class="nl">customKey</span><span class="p">:</span> <span class="n">MyDictionaryKeys</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyObject</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">objectForKey</span><span class="p">(</span><span class="n">customKey</span><span class="p">.</span><span class="n">rawValue</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h3>äºŒã€å£°æ˜ Key æ—¶ï¼ŒåŒæ—¶å®šä¹‰ Value çš„ç±»å‹</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">userID</span> <span class="o">=</span> <span class="n">dictionaryTwo</span><span class="p">[.</span><span class="n">tip_UserIDKey</span><span class="p">]</span><span class="o">!</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">userID</span> <span class="kt">is</span> <span class="n">Int</span><span class="p">)</span> <span class="c1">// Always true</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">extension</span> <span class="n">DictionaryKeys</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">static</span> <span class="k">let</span> <span class="n">tip_UserIDKey</span> <span class="o">=</span> <span class="n">DictionaryKey</span><span class="o">&lt;</span><span class="n">Int</span><span class="o">?&gt;</span><span class="p">(</span><span class="s">&quot;userID&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">extension</span> <span class="bp">NSDictionary</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">subscript</span><span class="p">(</span><span class="nl">key</span><span class="p">:</span> <span class="n">DictionaryKey</span><span class="o">&lt;</span><span class="n">String</span><span class="o">?&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">String</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>        <span class="kr">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">objectForKey</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">value</span><span class="p">)</span> <span class="kt">as</span><span class="o">?</span> <span class="n">String</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">subscript</span><span class="p">(</span><span class="nl">key</span><span class="p">:</span> <span class="n">DictionaryKey</span><span class="o">&lt;</span><span class="n">Int</span><span class="o">?&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>        <span class="kr">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">objectForKey</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">value</span><span class="p">)</span> <span class="kt">as</span><span class="o">?</span> <span class="n">Int</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="n">DictionaryKeys</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">private</span> <span class="k">init</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="n">DictionaryKey</span><span class="o">&lt;</span><span class="n">ValueType</span><span class="o">&gt;:</span> <span class="n">DictionaryKeys</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">let</span> <span class="nl">value</span><span class="p">:</span> <span class="n">String</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">init</span><span class="p">(</span><span class="n">_</span> <span class="nl">key</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nb">self</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">key</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h3>ä¸‰ã€ç”¨æšä¸¾è·å– Set çš„å…ƒç´ </h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">qqAccount</span> <span class="o">=</span> <span class="n">accountSet</span><span class="p">[.</span><span class="n">QQ</span><span class="p">]</span>
</span><span class='line'><span class="k">let</span> <span class="n">weChatAccount</span> <span class="o">=</span> <span class="n">accountSet</span><span class="p">[.</span><span class="n">WeChat</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="s">&quot;æ ·å¼ä¸‰ã€qqAppID: \(qqAccount!.appID)  weChatAppID: \(weChatAccount!.appID)&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<p>æºç ï¼š<a href="https://github.com/Limon-catch/SubscriptSwift">SubscriptSwift</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Matching Option]]></title>
    <link href="http://limon.top/matching-option/"/>
    <updated>2015-12-23T22:36:43+08:00</updated>
    <id>http://limon.top/matching-option</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>    "articles": [
</span><span class='line'>        {
</span><span class='line'>            "type": "app", // AppSoæ–‡ç« 
</span><span class='line'>            "cellHeight": "100"
</span><span class='line'>        },
</span><span class='line'>        {
</span><span class='line'>            "type": "number", // æ•°ç‹¬æ–‡ç« 
</span><span class='line'>            "cellHeight": "200"
</span><span class='line'>        },
</span><span class='line'>        {
</span><span class='line'>            "type": "mindStore", // MindStoreæ–‡ç« 
</span><span class='line'>            "cellHeight": "300"
</span><span class='line'>        }
</span><span class='line'>    ]
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>å‡è®¾æœåŠ¡å™¨è¿”å›ä»¥ä¸Šçš„JSONï¼Œå®¢æˆ·ç«¯éœ€è¦æ ¹æ®æ–‡ç« ç±»å‹æ¥ä½œä¸åŒçš„å¸ƒå±€ã€‚</p>

<p>ç¬¬ä¸€æ—¶é—´å¯èƒ½ä¼šæƒ³åˆ°ä»¥ä¸‹çš„æ–¹æ³•æ¥switchï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='Swift'><span class='line'><span class="k">let</span> <span class="n">typeString</span> <span class="o">=</span> <span class="s">&quot;app&quot;</span>
</span><span class='line'><span class="k">switch</span> <span class="n">typeString</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">case</span> <span class="s">&quot;app&quot;</span><span class="o">:</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;AppSo Article&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">case</span> <span class="s">&quot;number&quot;</span><span class="o">:</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;Number Article&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">default</span><span class="o">:</span>
</span><span class='line'>    <span class="k">break</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<p>è¾ƒä¸ºä¼˜é›…çš„æ–¹æ³•æ˜¯ç”¨<code>enum</code>æ¥ç®¡ç†ç±»å‹ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='Swift'><span class='line'><span class="k">enum</span> <span class="nl">Occupation</span><span class="p">:</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">case</span> <span class="n">AppSo</span> <span class="o">=</span> <span class="s">&quot;app&quot;</span>
</span><span class='line'>  <span class="k">case</span> <span class="n">Number</span> <span class="o">=</span> <span class="s">&quot;number&quot;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">typeString</span> <span class="o">=</span> <span class="s">&quot;mindStore&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">switch</span> <span class="n">Occupation</span><span class="p">(</span><span class="nl">rawValue</span><span class="p">:</span> <span class="n">typeString</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">case</span> <span class="p">.</span><span class="n">AppSo</span><span class="o">?:</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;AppSo Article&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">case</span> <span class="p">.</span><span class="n">Number</span><span class="o">?:</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;Number Article&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">case</span> <span class="nb">nil</span><span class="o">:</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;Article?&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<p>æŠ½å–äºï¼š<a href="http://www.figure.ink/blog/2015/12/6/matching-with-swifts-optional-pattern?utm_campaign=This%2BWeek%2Bin%2BSwift&amp;utm_medium=web&amp;utm_source=This_Week_in_Swift_65">Matching with Swift&rsquo;s Optional Pattern</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ä¼˜é›…åœ°è‡ªå®šä¹‰XibView]]></title>
    <link href="http://limon.top/customxibview/"/>
    <updated>2015-12-23T21:38:17+08:00</updated>
    <id>http://limon.top/customxibview</id>
    <content type="html"><![CDATA[<h2>ä¼˜é›…åœ°è‡ªå®šä¹‰XibView</h2>

<p>å¥½ä¹ æƒ¯ï¼Œå…ˆä¸Š<a href="https://github.com/Limon-catch/XibView">æºç </a>ã€‚</p>

<p>å…ˆåˆ›å»ºä¸€ä¸ªUIViewæ–‡ä»¶å’Œä¸€ä¸ªXibæ–‡ä»¶ï¼Œåœ¨Xibæ–‡ä»¶é‡Œè®¾ç½®å¦‚ä¸‹ï¼Œ</p>

<p><img src="https://raw.githubusercontent.com/Limon-catch/XibView/master/XibView/Image/XibView_Step1.png" alt="" /></p>

<p>åœ¨UIViewæ–‡ä»¶ä¸­ï¼Œä¸æ˜¯ç”¨<code>-awakeFromNib()</code>ä½œä¸ºæ„é€ å™¨ï¼Œè€Œæ˜¯æ­£å¸¸çš„<code>-init(frame: CGRect)</code>ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="kr">override</span> <span class="nf">init</span><span class="p">(</span><span class="nl">frame</span><span class="p">:</span> <span class="bp">CGRect</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nb">super</span><span class="p">.</span><span class="k">init</span><span class="p">(</span><span class="nl">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">xibSetup</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è€Œ<code>-xibSetup()</code>æ‰æ˜¯å…³é”®ï¼Œå…·ä½“å¯çœ‹æºç ã€‚</p>

<p><br />
å¦‚æœéœ€è¦UIViewå’ŒXibæ–‡ä»¶å»ºç«‹æ§ä»¶å±æ€§å…³è”ï¼Œæ˜¯è®¾ç½®Xibæ–‡ä»¶çš„File`s Ownerï¼Œ<strong><em>è€Œä¸æ˜¯è®¾ç½®Viewçš„Custom Class</em></strong>ã€‚</p>

<p><img src="https://raw.githubusercontent.com/Limon-catch/XibView/master/XibView/Image/XibView_Step2.png" alt="" /></p>

<p>è®¾ç½®äº†File`s Ownerå°±å¯ä»¥åƒå¾€å¸¸ä¸€æ ·æ‹–çº¿äº†ã€‚</p>

<p>å¦‚æœæƒ³åœ¨<code>Main.storyboard</code>æ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨æ­¤Xibï¼ŒåŒæ—¶ä¹Ÿæƒ³åœ¨SBä¸­è®¾ç½®å±æ€§ï¼Œé‚£æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ</p>

<ol>
<li>åœ¨SBä¸­åŠ å…¥ä¸€ä¸ªUIViewï¼Œå°†å…¶Classè®¾ç½®æˆ<code>XibView</code><br /></li>
<li>ä½¿ç”¨<code>@IBInspectable</code></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="p">@</span><span class="n">IBInspectable</span> <span class="k">var</span> <span class="nl">title</span><span class="p">:</span> <span class="n">String</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>  <span class="kr">get</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">xibLabel</span><span class="p">.</span><span class="n">text</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kr">set</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">xibLabel</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">newValue</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br />
æ·»åŠ äº†<code>@IBInspectable</code>ä¹‹åï¼Œå°±å¯ä»¥åƒç³»ç»Ÿè‡ªå¸¦çš„æ§ä»¶ä¸€æ ·è®¾ç½®å±æ€§äº†ã€‚</p>

<p><img src="https://raw.githubusercontent.com/Limon-catch/XibView/master/XibView/Image/XibView_Step3.png" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CheatSheet]]></title>
    <link href="http://limon.top/cheatsheet/"/>
    <updated>2015-12-23T04:22:06+08:00</updated>
    <id>http://limon.top/cheatsheet</id>
    <content type="html"><![CDATA[<h4>Swift å‡ ç§ä¸é”™çš„éå†</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mf">1.</span><span class="p">.</span><span class="mf">.10</span> <span class="k">where</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="s">&quot;\(i) is even&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">for</span> <span class="n">word</span> <span class="k">in</span> <span class="p">[</span><span class="s">&quot;Lorem&quot;</span><span class="p">,</span> <span class="s">&quot;ipsum&quot;</span><span class="p">,</span> <span class="s">&quot;dolor&quot;</span><span class="p">,</span> <span class="s">&quot;sit&quot;</span><span class="p">,</span> <span class="s">&quot;amet&quot;</span><span class="p">,</span> <span class="s">&quot;consectetur&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s">&quot;adipiscing&quot;</span><span class="p">,</span> <span class="s">&quot;elit&quot;</span><span class="p">]</span> <span class="k">where</span> <span class="n">word</span><span class="p">.</span><span class="n">characters</span><span class="p">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="p">{</span>
</span><span class='line'>     <span class="n">print</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s">&quot;is a long word&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="nl">items</span><span class="p">:</span> <span class="p">[</span><span class="n">String</span><span class="o">?</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">nil</span><span class="p">,</span> <span class="nb">nil</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="nb">nil</span><span class="p">,</span> <span class="s">&quot;World&quot;</span><span class="p">]</span>
</span><span class='line'><span class="k">for</span> <span class="k">case</span> <span class="k">let</span> <span class="n">item</span><span class="o">?</span> <span class="k">in</span> <span class="n">items</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">mySwitch</span> <span class="o">=</span> <span class="bp">UISwitch</span><span class="p">()</span>
</span><span class='line'><span class="k">let</span> <span class="n">myView</span> <span class="o">=</span> <span class="bp">UIView</span><span class="p">()</span>
</span><span class='line'><span class="k">let</span> <span class="n">myDate</span> <span class="o">=</span> <span class="bp">NSDate</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="nl">myItems</span><span class="p">:</span> <span class="p">[</span><span class="bp">NSObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mySwitch</span><span class="p">,</span> <span class="n">myDate</span><span class="p">,</span> <span class="n">myView</span><span class="p">]</span>
</span><span class='line'><span class="k">for</span> <span class="k">case</span> <span class="k">let</span> <span class="n">item</span> <span class="kt">as</span> <span class="bp">UIView</span> <span class="k">in</span> <span class="n">myItems</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">frame</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">protocol</span> <span class="n">MyCustomProtocol</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">var</span> <span class="nl">frame</span><span class="p">:</span> <span class="bp">CGRect</span> <span class="p">{</span><span class="kr">get</span><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">struct</span> <span class="n">Bar</span> <span class="p">{}</span>
</span><span class='line'><span class="k">struct</span> <span class="nl">Foo</span><span class="p">:</span> <span class="n">MyCustomProtocol</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">let</span> <span class="nl">frame</span><span class="p">:</span> <span class="bp">CGRect</span> <span class="o">=</span> <span class="p">.</span><span class="n">zero</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">extension</span> <span class="nl">UIView</span><span class="p">:</span> <span class="n">MyCustomProtocol</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">otherItems</span> <span class="o">=</span> <span class="p">[</span><span class="n">Bar</span><span class="p">(),</span> <span class="n">Foo</span><span class="p">(),</span> <span class="bp">UIView</span><span class="p">()]</span> <span class="kt">as</span> <span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</span><span class='line'><span class="k">for</span> <span class="k">case</span> <span class="k">let</span> <span class="n">item</span> <span class="kt">as</span> <span class="n">MyCustomProtocol</span> <span class="k">in</span> <span class="n">otherItems</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">frame</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>å­—å…¸åˆå¹¶</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">var</span> <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>    <span class="s">&quot;page&quot;</span><span class="o">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s">&quot;offset&quot;</span><span class="o">:</span> <span class="s">&quot;20&quot;</span>
</span><span class='line'><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;type&quot;</span><span class="o">:</span> <span class="s">&quot;news&quot;</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="n">parameters</span><span class="p">.</span><span class="n">ifr_merge</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="c1">// Output: [&quot;offset&quot;: &quot;20&quot;, &quot;type&quot;: &quot;news&quot;, &quot;page&quot;: &quot;1&quot;]</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">extension</span> <span class="n">Dictionary</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="kr">mutating</span> <span class="k">func</span> <span class="n">ifr_merge</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="o">&gt;</span><span class="p">(</span><span class="nl">dictionaries</span><span class="p">:</span> <span class="n">Dictionary</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="o">&gt;</span><span class="p">...)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">dict</span> <span class="k">in</span> <span class="n">dictionaries</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">in</span> <span class="n">dict</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span> <span class="k">let</span> <span class="n">v</span> <span class="o">=</span> <span class="n">value</span> <span class="kt">as</span><span class="o">?</span> <span class="n">Value</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">key</span> <span class="kt">as</span><span class="o">?</span> <span class="n">Key</span> <span class="p">{</span>
</span><span class='line'>                    <span class="nb">self</span><span class="p">.</span><span class="n">updateValue</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nl">forKey</span><span class="p">:</span> <span class="n">k</span><span class="p">)</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>ä¼˜åŒ– Cell çš„ä½¿ç”¨ä½“éªŒ</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">collectionView</span><span class="p">.</span><span class="n">registerNib</span><span class="p">(</span><span class="bp">UINib</span><span class="p">(</span><span class="nl">nibName</span><span class="p">:</span> <span class="n">NewsCell</span><span class="p">.</span><span class="n">ifr_className</span><span class="p">,</span> <span class="nl">bundle</span><span class="p">:</span> <span class="nb">nil</span><span class="p">),</span> <span class="nl">forCellWithReuseIdentifier</span><span class="p">:</span> <span class="n">NewsCell</span><span class="p">.</span><span class="n">ifr_className</span><span class="p">)</span>
</span><span class='line'><span class="k">let</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">collectionView</span><span class="p">.</span><span class="n">dequeueReusableCellWithReuseIdentifier</span><span class="p">(</span><span class="n">NewsCell</span><span class="p">.</span><span class="n">ifr_className</span><span class="p">,</span> <span class="nl">forIndexPath</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="kt">as</span><span class="o">!</span> <span class="n">NewsCell</span>
</span><span class='line'>
</span><span class='line'><span class="k">extension</span> <span class="bp">UICollectionReusableView</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">static</span> <span class="k">var</span> <span class="nl">ifr_className</span><span class="p">:</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">&quot;\(self)&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>ä¼˜åŒ– ReloadDataã€Insert çš„ä½¿ç”¨ä½“éªŒ</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">var</span> <span class="nl">wayToUpdate</span><span class="p">:</span> <span class="bp">UICollectionView</span><span class="p">.</span><span class="n">WayToUpdate</span> <span class="o">=</span> <span class="p">.</span><span class="n">None</span>
</span><span class='line'><span class="n">wayToUpdate</span> <span class="o">=</span> <span class="n">page</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="p">.</span><span class="nl">ReloadData</span> <span class="p">:</span> <span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">indexPaths</span><span class="p">)</span>
</span><span class='line'><span class="n">wayToUpdate</span><span class="p">.</span><span class="n">performWithCollectionView</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">collectionView</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">extension</span> <span class="bp">UICollectionView</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">enum</span> <span class="n">WayToUpdate</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">case</span> <span class="n">None</span>
</span><span class='line'>        <span class="k">case</span> <span class="n">ReloadData</span>
</span><span class='line'>        <span class="k">case</span> <span class="n">Insert</span><span class="p">([</span><span class="bp">NSIndexPath</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">var</span> <span class="nl">needsLabor</span><span class="p">:</span> <span class="n">Bool</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">switch</span> <span class="nb">self</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="p">.</span><span class="nl">None</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="nb">false</span>
</span><span class='line'>            <span class="k">case</span> <span class="p">.</span><span class="nl">ReloadData</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="nb">true</span>
</span><span class='line'>            <span class="k">case</span> <span class="p">.</span><span class="nl">Insert</span><span class="p">:</span>
</span><span class='line'>                <span class="k">return</span> <span class="nb">true</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">func</span> <span class="n">performWithCollectionView</span><span class="p">(</span><span class="nl">collectionView</span><span class="p">:</span> <span class="bp">UICollectionView</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">switch</span> <span class="nb">self</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">case</span> <span class="p">.</span><span class="nl">None</span><span class="p">:</span>
</span><span class='line'>                    <span class="k">break</span>
</span><span class='line'>                <span class="k">case</span> <span class="p">.</span><span class="nl">ReloadData</span><span class="p">:</span>
</span><span class='line'>                    <span class="n">collectionView</span><span class="p">.</span><span class="n">reloadData</span><span class="p">()</span>
</span><span class='line'>                <span class="k">case</span> <span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="k">let</span> <span class="n">indexPaths</span><span class="p">)</span><span class="o">:</span>
</span><span class='line'>                    <span class="n">collectionView</span><span class="p">.</span><span class="n">insertItemsAtIndexPaths</span><span class="p">(</span><span class="n">indexPaths</span><span class="p">)</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>å­—ä½“çš„é€‚é…</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="bp">UIFont</span><span class="p">.</span><span class="n">ifr_adaptiveFont</span><span class="p">(.</span><span class="n">Regular</span><span class="p">(</span><span class="nl">fontSize</span><span class="p">:</span> <span class="mf">16.0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">enum</span> <span class="n">FontWeight</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Light</span><span class="p">(</span><span class="nl">fontSize</span><span class="p">:</span> <span class="n">CGFloat</span><span class="p">)</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Regular</span><span class="p">(</span><span class="nl">fontSize</span><span class="p">:</span> <span class="n">CGFloat</span><span class="p">)</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Medium</span><span class="p">(</span><span class="nl">fontSize</span><span class="p">:</span> <span class="n">CGFloat</span><span class="p">)</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">Bold</span><span class="p">(</span><span class="nl">fontSize</span><span class="p">:</span> <span class="n">CGFloat</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">extension</span> <span class="bp">UIFont</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">class</span> <span class="k">func</span> <span class="n">ifr_adaptiveFont</span><span class="p">(</span><span class="nl">weight</span><span class="p">:</span> <span class="n">FontWeight</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">UIFont</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">var</span> <span class="n">weightString</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>        <span class="k">var</span> <span class="nl">size</span><span class="p">:</span> <span class="n">CGFloat</span> <span class="o">=</span> <span class="mf">16.0</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">switch</span> <span class="n">weight</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">case</span> <span class="p">.</span><span class="n">Light</span><span class="p">(</span><span class="k">let</span> <span class="n">fontSize</span><span class="p">)</span><span class="o">:</span>
</span><span class='line'>                <span class="n">weightString</span> <span class="o">=</span> <span class="s">&quot;-Light&quot;</span>
</span><span class='line'>                <span class="n">size</span> <span class="o">=</span> <span class="n">fontSize</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">case</span> <span class="p">.</span><span class="n">Regular</span><span class="p">(</span><span class="k">let</span> <span class="n">fontSize</span><span class="p">)</span><span class="o">:</span>
</span><span class='line'>                <span class="n">weightString</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>                <span class="n">size</span> <span class="o">=</span> <span class="n">fontSize</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">case</span> <span class="p">.</span><span class="n">Medium</span><span class="p">(</span><span class="k">let</span> <span class="n">fontSize</span><span class="p">)</span><span class="o">:</span>
</span><span class='line'>                <span class="n">weightString</span> <span class="o">=</span> <span class="s">&quot;-Medium&quot;</span>
</span><span class='line'>                <span class="n">size</span> <span class="o">=</span> <span class="n">fontSize</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">case</span> <span class="p">.</span><span class="n">Bold</span><span class="p">(</span><span class="k">let</span> <span class="n">fontSize</span><span class="p">)</span><span class="o">:</span>
</span><span class='line'>                <span class="n">weightString</span> <span class="o">=</span> <span class="s">&quot;-Bold&quot;</span>
</span><span class='line'>                <span class="n">size</span> <span class="o">=</span> <span class="n">fontSize</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">guard</span> <span class="k">let</span> <span class="n">systemFont</span> <span class="o">=</span> <span class="bp">UIFont</span><span class="p">(</span><span class="nl">name</span><span class="p">:</span> <span class="s">&quot;PingFangSC\(weightString)&quot;</span><span class="p">,</span> <span class="nl">size</span><span class="p">:</span> <span class="n">size</span><span class="p">)</span> <span class="o">??</span>
</span><span class='line'>            <span class="bp">UIFont</span><span class="p">(</span><span class="nl">name</span><span class="p">:</span> <span class="s">&quot;STHeitiSC\(weightString)&quot;</span><span class="p">,</span> <span class="nl">size</span><span class="p">:</span> <span class="n">size</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">return</span> <span class="bp">UIFont</span><span class="p">.</span><span class="n">systemFontOfSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">systemFont</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>HTML å­—ç¬¦è½¬ä¹‰</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">var</span> <span class="nl">ifr_htmlEntityDecode</span><span class="p">:</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">var</span> <span class="n">text</span> <span class="o">=</span> <span class="n">stringByReplacingOccurrencesOfString</span><span class="p">(</span><span class="s">&quot;&amp;quot;&quot;</span><span class="p">,</span> <span class="nl">withString</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">stringByReplacingOccurrencesOfString</span><span class="p">(</span><span class="s">&quot;&amp;apos;&quot;</span><span class="p">,</span> <span class="nl">withString</span><span class="p">:</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">stringByReplacingOccurrencesOfString</span><span class="p">(</span><span class="s">&quot;&amp;lt;&quot;</span><span class="p">,</span> <span class="nl">withString</span><span class="p">:</span> <span class="s">&quot;&lt;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">stringByReplacingOccurrencesOfString</span><span class="p">(</span><span class="s">&quot;&amp;gt;&quot;</span><span class="p">,</span> <span class="nl">withString</span><span class="p">:</span> <span class="s">&quot;&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">stringByReplacingOccurrencesOfString</span><span class="p">(</span><span class="s">&quot;&amp;amp;&quot;</span><span class="p">,</span> <span class="nl">withString</span><span class="p">:</span> <span class="s">&quot;&amp;&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">text</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>repeat ä¸€å¼ å°å›¾ç‰‡</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">patternImage</span> <span class="o">=</span> <span class="bp">UIImage</span><span class="p">(</span><span class="nl">named</span><span class="p">:</span> <span class="s">&quot;comment_bottomLine&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">bottomImageView</span><span class="p">.</span><span class="n">image</span> <span class="o">=</span> <span class="nb">nil</span>
</span><span class='line'><span class="n">bottomImageView</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">(</span><span class="nl">patternImage</span><span class="p">:</span> <span class="n">patternImage</span><span class="o">!</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>NSURL è§£æ</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">extension</span> <span class="bp">NSURL</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">var</span> <span class="nl">prt_URLItems</span><span class="p">:</span> <span class="p">[</span><span class="nl">String</span><span class="p">:</span> <span class="n">String</span><span class="p">]</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">let</span> <span class="n">components</span> <span class="o">=</span> <span class="bp">NSURLComponents</span><span class="p">(</span><span class="nl">URL</span><span class="p">:</span> <span class="nb">self</span><span class="p">,</span> <span class="nl">resolvingAgainstBaseURL</span><span class="p">:</span> <span class="nb">false</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">guard</span> <span class="k">let</span> <span class="n">items</span> <span class="o">=</span> <span class="n">components</span><span class="o">?</span><span class="p">.</span><span class="n">queryItems</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="nb">nil</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">var</span> <span class="n">infos</span> <span class="o">=</span> <span class="p">[</span><span class="nl">String</span><span class="p">:</span> <span class="n">String</span><span class="p">]()</span>
</span><span class='line'>        <span class="n">items</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">infos</span><span class="p">[</span><span class="err">$</span><span class="mf">0.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="err">$</span><span class="mf">0.</span><span class="n">value</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">infos</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">items</span> <span class="o">=</span> <span class="bp">NSURL</span><span class="p">(</span><span class="nl">string</span><span class="p">:</span> <span class="s">&quot;http://www.weibo.com/1783821582/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo&quot;</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="n">prt_URLItems</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Optional([&quot;mod&quot;: &quot;personinfo&quot;, &quot;rightmod&quot;: &quot;1&quot;, &quot;wvr&quot;: &quot;6&quot;])</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>è·å–ç‰ˆæœ¬å·å’Œ Build å·</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="bp">NSBundle</span><span class="p">.</span><span class="n">mainBundle</span><span class="p">().</span><span class="n">infoDictionary</span><span class="o">?</span><span class="p">[</span><span class="s">&quot;CFBundleVersion&quot;</span><span class="p">]</span> <span class="kt">as</span><span class="o">?</span> <span class="n">String</span> <span class="c1">// Build</span>
</span><span class='line'><span class="bp">NSBundle</span><span class="p">.</span><span class="n">mainBundle</span><span class="p">().</span><span class="n">infoDictionary</span><span class="o">?</span><span class="p">[</span><span class="s">&quot;CFBundleShortVersionString&quot;</span><span class="p">]</span> <span class="kt">as</span><span class="o">?</span> <span class="n">String</span> <span class="c1">// ç‰ˆæœ¬å·</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>åˆ¤æ–­ä¸€ä¸ª view æ˜¯å¦æ˜¯å¦ä¸€ä¸ª view çš„å­è§†å›¾</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">isDescendantOfView:</span><span class="p">(</span><span class="bp">UIView</span> <span class="o">*</span><span class="p">)</span><span class="nv">view</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>éšè—æˆ–æ˜¾ç¤º&#8221;éšè—æ–‡ä»¶&#8221;</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">defaults</span> <span class="n">write</span> <span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">finder</span> <span class="n">AppleShowAllFiles</span> <span class="o">-</span><span class="n">boolean</span> <span class="nb">true</span><span class="p">;</span> <span class="n">killall</span> <span class="n">Finder</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>è®¾ç½®åœ†è§’ï¼ˆå·¦ä¸Šè§’ï¼Œå³ä¸Šè§’ï¼‰</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="bp">UIBezierPath</span><span class="p">(</span><span class="nl">roundedRect</span><span class="p">:</span> <span class="n">ScreenBounds</span><span class="p">,</span> <span class="nl">byRoundingCorners</span><span class="p">:</span> <span class="p">[.</span><span class="n">TopLeft</span><span class="p">,</span> <span class="p">.</span><span class="n">TopRight</span><span class="p">],</span> <span class="nl">cornerRadii</span><span class="p">:</span> <span class="bp">CGSize</span><span class="p">(</span><span class="nl">width</span><span class="p">:</span> <span class="n">cornerRadius</span><span class="p">,</span> <span class="nl">height</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>é˜´å½±</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">whiteView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">.</span><span class="n">redColor</span><span class="p">().</span><span class="bp">CGColor</span>
</span><span class='line'><span class="n">whiteView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowOffset</span> <span class="o">=</span> <span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'><span class="n">whiteView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowOpacity</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span class='line'><span class="n">whiteView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowRadius</span> <span class="o">=</span> <span class="mf">20.0</span>
</span><span class='line'><span class="n">whiteView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowPath</span> <span class="o">=</span> <span class="bp">UIBezierPath</span><span class="p">(</span><span class="nl">rect</span><span class="p">:</span> <span class="n">whiteView</span><span class="p">.</span><span class="n">bounds</span><span class="p">).</span><span class="bp">CGPath</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>BasicAnimation</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">pathAnimation</span> <span class="o">=</span> <span class="bp">CABasicAnimation</span><span class="p">(</span><span class="nl">keyPath</span><span class="p">:</span> <span class="s">&quot;path&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="n">startPath</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="n">endPath</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">0.3</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="bp">CAMediaTimingFunction</span><span class="p">(</span><span class="nl">name</span><span class="p">:</span> <span class="n">kCAMediaTimingFunctionEaseOut</span><span class="p">)</span> <span class="c1">// animation curve is Ease Out</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeBoth</span> <span class="c1">// keep to value after finishing</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="nb">false</span> <span class="c1">// don&#39;t remove after finishing</span>
</span><span class='line'>
</span><span class='line'><span class="n">shapeLayer</span><span class="p">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="n">pathAnimation</span><span class="p">,</span> <span class="nl">forKey</span><span class="p">:</span> <span class="n">pathAnimation</span><span class="p">.</span><span class="n">keyPath</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p><a href="http://jamesonquave.com/blog/fun-with-cashapelayer/">Fun with CAShapeLayer</a></p></blockquote>

<p><br /></p>

<h4>ç¦æ­¢ <code>WKWebView</code> é•¿æŒ‰å¤åˆ¶</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">let</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&quot;var style = document.createElement(&#39;style&#39;); style.type = &#39;text/css&#39;; style.innerText = &#39;*:not(input):not(textarea) { -webkit-user-select: none; -webkit-touch-callout: none; }&#39;; var head = document.getElementsByTagName(&#39;head&#39;)[0]; head.appendChild(style);&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="nl">script</span><span class="p">:</span> <span class="n">WKUserScript</span> <span class="o">=</span> <span class="n">WKUserScript</span><span class="p">(</span><span class="nl">source</span><span class="p">:</span> <span class="n">source</span> <span class="kt">as</span> <span class="n">String</span><span class="p">,</span> <span class="nl">injectionTime</span><span class="p">:</span> <span class="p">.</span><span class="n">AtDocumentEnd</span><span class="p">,</span> <span class="nl">forMainFrameOnly</span><span class="p">:</span> <span class="nb">true</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Create the user content controller and add the script to it</span>
</span><span class='line'><span class="k">let</span> <span class="nl">userContentController</span><span class="p">:</span> <span class="n">WKUserContentController</span> <span class="o">=</span> <span class="n">WKUserContentController</span><span class="p">()</span>
</span><span class='line'><span class="n">userContentController</span><span class="p">.</span><span class="n">addUserScript</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Create the configuration with the user content controller</span>
</span><span class='line'><span class="k">let</span> <span class="nl">configuration</span><span class="p">:</span> <span class="n">WKWebViewConfiguration</span> <span class="o">=</span> <span class="n">WKWebViewConfiguration</span><span class="p">()</span>
</span><span class='line'><span class="n">configuration</span><span class="p">.</span><span class="n">userContentController</span> <span class="o">=</span> <span class="n">userContentController</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>ç¦æ­¢ <code>WKWebView</code> æ”¾å¤§ç¼©å°</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="c1">// Javascript that disables pinch-to-zoom by inserting the HTML viewport meta tag into &lt;head&gt;</span>
</span><span class='line'><span class="k">let</span> <span class="nl">source</span><span class="p">:</span> <span class="bp">NSString</span> <span class="o">=</span> <span class="s">&quot;var meta = document.createElement(&#39;meta&#39;);&quot;</span> <span class="o">+</span>
</span><span class='line'>    <span class="s">&quot;meta.name = &#39;viewport&#39;;&quot;</span> <span class="o">+</span>
</span><span class='line'>    <span class="s">&quot;meta.content = &#39;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&#39;;&quot;</span> <span class="o">+</span>
</span><span class='line'>    <span class="s">&quot;var head = document.getElementsByTagName(&#39;head&#39;)[0];&quot;</span> <span class="o">+</span>
</span><span class='line'><span class="s">&quot;head.appendChild(meta);&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="nl">script</span><span class="p">:</span> <span class="n">WKUserScript</span> <span class="o">=</span> <span class="n">WKUserScript</span><span class="p">(</span><span class="nl">source</span><span class="p">:</span> <span class="n">source</span> <span class="kt">as</span> <span class="n">String</span><span class="p">,</span> <span class="nl">injectionTime</span><span class="p">:</span> <span class="p">.</span><span class="n">AtDocumentEnd</span><span class="p">,</span> <span class="nl">forMainFrameOnly</span><span class="p">:</span> <span class="nb">true</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Create the user content controller and add the script to it</span>
</span><span class='line'><span class="k">let</span> <span class="nl">userContentController</span><span class="p">:</span> <span class="n">WKUserContentController</span> <span class="o">=</span> <span class="n">WKUserContentController</span><span class="p">()</span>
</span><span class='line'><span class="n">userContentController</span><span class="p">.</span><span class="n">addUserScript</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Create the configuration with the user content controller</span>
</span><span class='line'><span class="k">let</span> <span class="nl">configuration</span><span class="p">:</span> <span class="n">WKWebViewConfiguration</span> <span class="o">=</span> <span class="n">WKWebViewConfiguration</span><span class="p">()</span>
</span><span class='line'><span class="n">configuration</span><span class="p">.</span><span class="n">userContentController</span> <span class="o">=</span> <span class="n">userContentController</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>æ ¹æ®è§¦æ‘¸ç‚¹åˆ¤æ–­æ˜¯å¦ touch ç‚¹å‡»äº†æŸä¸ª view</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="kr">override</span> <span class="k">func</span> <span class="nf">touchesBegan</span><span class="p">(</span><span class="nl">touches</span><span class="p">:</span> <span class="n">Set</span><span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">withEvent</span> <span class="nl">event</span><span class="p">:</span> <span class="bp">UIEvent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">super</span><span class="p">.</span><span class="n">touchesBegan</span><span class="p">(</span><span class="n">touches</span><span class="p">,</span> <span class="nl">withEvent</span><span class="p">:</span> <span class="n">event</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="k">let</span> <span class="n">location</span> <span class="o">=</span> <span class="p">(</span><span class="n">touches</span><span class="p">.</span><span class="n">first</span> <span class="kt">as</span><span class="o">?</span> <span class="bp">UITouch</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="n">locationInView</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">let</span> <span class="n">searchCircleY</span> <span class="o">=</span> <span class="n">bottomView</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">searchCircleImageView</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span>
</span><span class='line'>        <span class="k">let</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">CGRect</span><span class="p">(</span><span class="nl">origin</span><span class="p">:</span> <span class="bp">CGPoint</span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="n">searchCircleImageView</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="nl">y</span><span class="p">:</span><span class="n">searchCircleY</span><span class="p">)</span> <span class="p">,</span> <span class="nl">size</span><span class="p">:</span> <span class="n">searchCircleImageView</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">CGRectContainsPoint</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// ç‚¹å‡»åœ¨searchCircleImageView</span>
</span><span class='line'>            <span class="n">dismissViewControllerAnimated</span><span class="p">(</span><span class="nb">true</span><span class="p">,</span> <span class="nl">completion</span><span class="p">:</span> <span class="nb">nil</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<h4>éšè—é”®ç›˜(ç‚¹å‡»å±å¹•ä»»æ„ä½ç½®)</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">touchesBegan:</span><span class="p">(</span><span class="bp">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="nv">touches</span> <span class="nf">withEvent:</span><span class="p">(</span><span class="bp">UIEvent</span> <span class="o">*</span><span class="p">)</span><span class="nv">event</span><span class="p">{</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">super</span> <span class="nl">touchesBegan</span><span class="p">:</span><span class="n">touches</span> <span class="nl">withEvent</span><span class="p">:</span><span class="n">event</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">endEditing</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>

<p>åœ¨åŒ…å« <code>UITableView</code> è§†å›¾ä¸­æ·»åŠ å•å‡»æ‰‹åŠ¿
å¦‚æœåœ¨åŒ…å« <code>UITableView</code> è§†å›¾ä¸­æ·»åŠ å•å‡»æ‰‹åŠ¿ï¼Œè¿™ä¸ªå•å‡»æ‰‹åŠ¿ä¼šå±è”½æ‰ <code>UITableView</code>çš„ <code>-didSelectRowAtIndexPath</code></p>

<p>åœ¨å•å‡»ç‚¹ä½äºUITableViewå†…çš„æ—¶å€™å–æ¶ˆå“åº”</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">gestureRecognizerShouldBegin:</span><span class="p">(</span><span class="bp">UIGestureRecognizer</span> <span class="o">*</span><span class="p">)</span><span class="nv">gestureRecognizer</span><span class="p">{</span>
</span><span class='line'>  <span class="bp">CGPoint</span> <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">gestureRecognizer</span> <span class="nl">locationInView</span><span class="p">:</span><span class="nb">self</span><span class="p">];</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">CGRectContainsPoint</span><span class="p">(</span><span class="n">menuTableView</span><span class="p">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">point</span><span class="p">)){</span>
</span><span class='line'>      <span class="k">return</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ç®€å•ç‚¹çš„å°±å°†å•å‡»æ‰‹åŠ¿çš„ <code>cancelsTouchesInView</code> è®¾ç½®ä¸º NO å³å¯</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">singleTap</span><span class="p">.</span><span class="n">cancelsTouchesInView</span> <span class="o">=</span> <span class="nb">false</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>é»˜è®¤ä¸ºYESï¼Œè‹¥NOï¼ŒGesture Recognizerså’Œhit-test viewåŒæ—¶å“åº”è§¦æ‘¸åºåˆ—</p></blockquote>

<p><br /></p>

<h4>Octopress</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">rake</span> <span class="s">&quot;new_post[Post Title]&quot;</span> <span class="c1">// zshä¸‹</span>
</span><span class='line'><span class="n">rake</span> <span class="n">generate</span>                                  <span class="err">ç”Ÿæˆ</span><span class="n">html</span><span class="err">æ–‡ä»¶</span>
</span><span class='line'><span class="n">rake</span> <span class="n">preview</span>
</span><span class='line'><span class="n">rake</span> <span class="n">deploy</span>                                    <span class="err">éƒ¨ç½²æ–‡ç« ï¼ˆåšå®¢ï¼‰</span>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">git</span> <span class="n">add</span> <span class="p">.</span>
</span><span class='line'><span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="err">&#39;</span><span class="n">initial</span> <span class="n">source</span> <span class="n">commit</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">source</span>
</span></code></pre></td></tr></table></div></figure>


<p>deploy æ—¶ <code>non-fast-forward</code> é—®é¢˜è§£å†³æ–¹æ¡ˆ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="n">cd</span> <span class="n">octopress</span><span class="o">/</span><span class="n">_deploy</span>
</span><span class='line'><span class="n">git</span> <span class="n">pull</span> <span class="n">origin</span> <span class="n">master</span>
</span><span class='line'><span class="n">cd</span> <span class="p">..</span>
</span><span class='line'><span class="n">rake</span> <span class="n">deploy</span>
</span></code></pre></td></tr></table></div></figure>


<p><br /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GitHubåº“]]></title>
    <link href="http://limon.top/githubku/"/>
    <updated>2015-12-23T02:31:25+08:00</updated>
    <id>http://limon.top/githubku</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/phimage/Erik">Erik</a> &mdash;  WebKitçš„åˆ†è£…ï¼Œè¾ƒå¥½æ”¯æŒCSSå’ŒJS</p>

<p><a href="https://github.com/kishikawakatsumi/KeychainAccess">KeychainAccess</a></p>

<p><a href="https://github.com/danielgindi/ios-charts">ios-charts</a> &mdash;   è¡¨æ ¼</p>

<p><a href="http://www.jianshu.com/p/b45655e23a42">é¡¶éƒ¨æ ‡é¢˜æ»šåŠ¨æ¡</a></p>

<p><a href="https://github.com/xxycode/XXYAudioEngine">XXYAudioEngine</a> &mdash; åŸºäºNSURLSessionå’ŒAVAudioPlayerå°è£…çš„ä¸€ä¸ªæ’­æ”¾åœ¨çº¿éŸ³ä¹çš„å·¥å…·ï¼Œå¯ä»¥æŠŠéŸ³ä¹ä¸‹è½½è‡³æœ¬åœ°ï¼Œæ”¯æŒæ¸…é™¤ç¼“å­˜</p>

<p><a href="https://github.com/daisuke0131/ViewMonitor">VirwMonitor ç‚¹å‡»æµ‹é‡è§†å›¾ä½ç½®ã€å¤§å°ã€èƒŒæ™¯ã€å­—ä½“å¤§å°ç­‰ä¿¡æ¯</a></p>

<p><a href="https://github.com/wojteklu/Watchdog">Watchdog</a> &mdash; iOSå®æ—¶å¡é¡¿ç›‘æ§</p>

<p><a href="https://github.com/kasketis/netfox">netfoxï¼šiOS ç½‘ç»œè°ƒè¯•å·¥å…·</a> &mdash; é…ç½®åªéœ€ä¸€è¡Œä»£ç ï¼Œå¯ä»¥è°ƒè¯•åŒ…æ‹¬ç¬¬ä¸‰æ–¹åº“åœ¨å†…çš„ç½‘ç»œè¯·æ±‚</p>

<p><a href="https://github.com/hyperoslo/ImagePicker">ImagePicker is an all-in-one camera solution for your iOS app</a></p>

<p><a href="https://github.com/FlexMonkey/Filterpedia">Filterpedia</a> &mdash; åŸºäº Core Image æ¡†æ¶ï¼Œå®Œæ•´ã€å¼ºå¤§çš„å›¾ç‰‡æ»¤é•œç±»åº“</p>

<p><a href="https://github.com/KyoheiG3/AttributedLabel">é«˜æ€§èƒ½ AttributedLabel</a></p>

<p><a href="https://github.com/hackiftekhar/IQKeyboardManager">KeyboardManager</a></p>

<p><a href="https://github.com/DeveloperLx/LxTabBadgePoint">tabBarä¸Šçš„è§’æ ‡Categoryå†™æ³•ï¼Œæ— éœ€ç»§æ‰¿å­ç±»</a></p>

<p><a href="https://github.com/neonichu/LiveGIFs">Export your Live Photos as animated GIFs</a></p>

<p><a href="https://github.com/Roxasora/RxWebViewController">å®ç°ç±»ä¼¼å¾®ä¿¡çš„ webView å¯¼èˆªæ•ˆæœï¼Œå·¦æ»‘è¿”å›ä¸Šä¸ªç½‘é¡µ</a></p>

<p><a href="https://github.com/onevcat/APNGKit">ä¸€ä¸ªé«˜æ€§èƒ½çš„ APNG åº“</a></p>

<p><a href="https://github.com/khaledmtaha/XAnimatedImage">XAnimatedImage</a> &mdash; ä¸€ä¸ªé«˜æ€§èƒ½çš„ GIF åŠ¨ç”»å¼•æ“åŸºäº FLAnimatedImage</p>

<p><a href="https://github.com/Aufree/Hodor?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io">Hodor</a> &mdash; åº”ç”¨å†…ç›´æ¥æ›´æ”¹åº”ç”¨è¯­è¨€è€Œæ— éœ€é€€å‡ºåº”ç”¨, ç±»ä¼¼å¾®ä¿¡</p>

<p><a href="https://github.com/nixzhu/AudioBot">AudioBot</a> &mdash; å½•éŸ³Demoï¼Œå½•éŸ³æ—¶ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å½•å…¥æ­£åœ¨æ’­æ”¾çš„éŸ³ä¹</p>

<p><a href="https://github.com/audiokit/AudioKit">AudioKit</a> &mdash; ä¸€ä¸ªå¾ˆæ£’çš„å½•éŸ³åº“ï¼Œæ–‡æ¡£æ•™ç¨‹é½å…¨ï¼Œå·²æœ‰ä¸€ä¸ªä¸Šæ¶<a href="http://matthewfecher.com/app-developement/swift-synth/">App</a></p>

<p><a href="https://github.com/Shannon-s-Dreamland/DropdownMenu">å¤šçº§ä¸‹æ‹‰èœå•</a></p>

<p><a href="https://github.com/VerbalExpressions/SwiftVerbalExpressions">æ­£åˆ™åº“</a></p>

<p><a href="http://www.weibo.com/mygroups?gid=3771498714262571&amp;wvr=6&amp;leftnav=1">é¢å‘åè®®ç¼–ç¨‹å•å…ƒæµ‹è¯• Mock æ¡†æ¶</a></p>

<p><a href="https://github.com/GJGroup/GJRatioAutoLayout">RatioAutoLayout</a> &mdash; Autolayoutä¸‹ï¼Œåªéœ€ä¸€ä¸ªå¼€å…³ï¼Œå³å¯è®©å½“å‰viewè¿›è¡Œç­‰æ¯”ç¼©æ”¾</p>

<p><a href="https://github.com/lra/mackup">Macup</a> &mdash; dotfiles ç®¡ç†ï¼Œé€šè¿‡gitï¼Œdropboxæ¥è¿›è¡Œå¤‡ä»½ï¼Œæ¢å¤è‡ªå®šä¹‰è®¾ç½®çš„æ–‡ä»¶</p>

<p><a href="https://github.com/yukiasai/Gecco">æ”¯æŒå¯¹è§†å›¾è¿›è¡Œå±€éƒ¨é«˜äº®</a> &mdash; å¿«é€Ÿåˆ›å»ºäº§å“çš„æ–°æ‰‹æŒ‡å¯¼ç•Œé¢</p>

<p><a href="https://github.com/FolioReader/FolioReaderKit?utm_campaign=This%2BWeek%2Bin%2BSwift&amp;utm_medium=web&amp;utm_source=This_Week_in_Swift_71">é˜…è¯»å™¨</a></p>

<p><a href="https://github.com/pili-engineering/PLCameraStreamingKit">PLCameraStreamingKit, å¿«é€Ÿæ„å»ºä¸€æ¬¾ç±»ä¼¼ Meerkat æˆ– Periscope çš„æ‰‹æœºç›´æ’­åº”ç”¨</a> &mdash; ğŸ‘ğŸ‘ğŸ‘</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Animation]]></title>
    <link href="http://limon.top/animation/"/>
    <updated>2015-12-23T02:28:25+08:00</updated>
    <id>http://limon.top/animation</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/keefo/CATweaker"> CAMediaTimingFunction helper tool </a></p>

<p><a href="https://github.com/cjwirth/awesome-ios-ui"> åŠ¨ç”»é›†åˆ </a></p>

<p><a href="https://github.com/JakeLin/IBAnimatable/blob/master/Documentation/README.zh.md">IBAnimatable</a> &mdash; æ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬åœ¨Interface Builderå’ŒSwift playgroundé‡Œé¢è®¾è®¡UI, äº¤äº’, å¯¼èˆªæ¨¡å¼, æ¢åœºå’ŒåŠ¨ç”»çš„å¼€æºåº“</p>

<p><a href="https://github.com/antiguab/BAFluidView"> æ³¢æµª </a></p>

<p><a href="https://github.com/poolqf/FillableLoaders"> æ°´æ³¢ä¸Šæ¶¨å¡«æ»¡ </a></p>

<p><a href="https://github.com/FancyPixel/BallSwift"> UIDynamics iOS 9 </a></p>

<p><a href="https://github.com/okmr-d/DOFavoriteButton"> ç‚¹èµ </a></p>

<p><a href="https://github.com/IFTTT/RazzleDazzle"> A simple keyframe-based animation framework </a></p>

<p><a href="https://github.com/ninjaprox/NVActivityIndicatorView"> åŠ è½½åŠ¨ç”»é›†åˆ </a></p>

<p><a href="http://www.cocoachina.com/ios/20151202/14532.html"> ä¸€æ¬¾LoadingåŠ¨ç”»çš„å®ç°æ€è·¯ </a></p>

<p><a href="https://github.com/yoavlt/LiquidLoader"> ç²˜æ€§åŠ è½½åŠ¨ç”» </a></p>

<p><a href="http://pandara.xyz/2015/10/29/jelly_refresh/?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io">åˆ©ç”¨è´å¡å°”æ›²çº¿å®ç°Qå¼¹çš„ä¸‹æ‹‰åˆ·æ–°</a></p>

<p><a href="https://github.com/PandaraWen/WaterDropViewDemo">æ°´æ»´æ•ˆæœ</a></p>

<p><a href="https://github.com/overboming/ZCAnimatedLabel"> LabelåŠ¨ç”» </a></p>

<p><a href="https://github.com/gmertk/BusyNavigationBar"> NavigationBar åŠ¨ç”» </a></p>

<p><a href="https://github.com/ltebean/LTNavigationBar"> NavigationBarçš„èƒŒæ™¯é¢œè‰²ï¼Œé«˜åº¦ </a></p>

<p><a href="https://github.com/DanisFabric/RainbowNavigation/blob/master/README_CN.md"> åŠ¨æ€æ”¹å˜UINavigationBarèƒŒæ™¯è‰² </a></p>

<p><a href="https://github.com/MoZhouqi/KMNavigationBarTransition"> é¡ºæ»‘è¿‡æ¸¡å¯¼èˆªæ ï¼ˆä¸åŒèƒŒæ™¯é¢œè‰²ï¼‰ </a> &mdash; ğŸ‘</p>

<p><a href="https://github.com/overboming/ZCAnimatedLabel"> UILabel åŠ¨ç”» </a></p>

<p><a href="https://github.com/entotsu/PullToBounce"> ä¸‹æ‹‰åˆ·æ–° PullToBounce </a></p>

<p><a href="https://github.com/yoavlt/LiquidFloatingActionButton"> èœå•ç²˜æ€§æŒ‰é’® </a></p>

<p><a href="https://github.com/liuzhiyi1992/SpreadButton">è‡ªé€‚åº”è¾¹ç•Œçš„æ•£å¼€æŒ‰é’®</a></p>

<p><a href="https://github.com/noppefoxwolf/FlowBarButtonItem?utm_campaign=This%2BWeek%2Bin%2BSwift&amp;utm_medium=web&amp;utm_source=This_Week_in_Swift_71">æµ®åŠ¨çš„ Button</a></p>

<p><a href="https://github.com/Yalantis/Context-Menu.iOS">æŠ˜å èœå•</a></p>

<p><a href="https://github.com/Yalantis/Persei">æŠ˜å èœå• (Yalantiså‡ºå“)</a></p>

<p><a href="http://www.cocoachina.com/ios/20160104/14858.html">å›¾ç‰‡å®ç°å¤šå±‚æŠ˜å æ•ˆæœ</a></p>

<p><a href="https://github.com/Ramotion/folding-cell">Cell æŠ˜å åŠ¨</a> &mdash; ğŸ‘ğŸ‘ğŸ‘</p>

<p><a href="https://github.com/MartinRGB/MTMaterialDelete"> ç²‰ç¢åˆ é™¤ </a></p>

<p><a href="https://github.com/SergioChan/SCTableViewCell"> ä¾§æ»‘åˆ é™¤cell </a></p>

<p><a href="http://xxycode.com/ru-he-zhi-zuo-ge-xuan-ku-hao-wan-de-bao-zha-xiao-guo-2/"> å¦‚ä½•åˆ¶ä½œä¸€ä¸ªç‚«é…·å¥½ç©çš„çˆ†ç‚¸æ•ˆæœ </a></p>

<p><a href="https://github.com/Boris-Em/BEMCheckBox"> Check box </a></p>

<p><a href="https://github.com/gontovnik/DGElasticPullToRefresh"> çš®ç­‹å¼å¼¹æ€§ä¸‹æ‹‰å³åˆ·æ–° </a></p>

<p><a href="http://iostuts.io/2015/10/17/elastic-bounce-using-uibezierpath-and-pan-gesture/">çš®ç­‹å¼å¼¹æ€§ä¸‹æ‹‰å³åˆ·æ–° æ–‡ç«  Elastic view animation using UIBezierPath </a></p>

<p><a href="https://github.com/lkzhao/ElasticTransition">çš®ç­‹å¼åŠ¨ç”»è½¬åœºæ•ˆæœ</a></p>

<p><a href="https://github.com/Yalantis/StarWars.iOS"> ç¬é—´å´©å¡Œä¸ºå°æ–¹å—åŠ¨ç”»æ•ˆæœ </a></p>

<p><a href="https://github.com/TBXark/TKRubberIndicator"> page control </a></p>

<p><a href="https://github.com/AliThink/HorizontalProgress"> HorizontalProgress è¿›ç¨‹ </a></p>

<p><a href="https://github.com/SergioChan/SCTrelloNavigation"> trello çš„å¯¼èˆªåŠ¨æ•ˆæ§ä»¶ </a></p>

<p><a href="https://github.com/DroidsOnRoids/MPParallaxView"> Apple TV Parallax æ•ˆæœçš„è§†å›¾ </a></p>

<p><a href="https://github.com/CosmicMind/MaterialKit"> MaterialKit æ˜¯ä¸€ä¸ªç”¨ Swift å†™çš„ Material Design æ¡†æ¶, æ‹¥æœ‰å¤šç§æ¼‚äº®çš„åŠ¨ç”»æ•ˆæœå’Œæ ·å¼ </a></p>

<p><a href="https://github.com/Guidebook/gbkui-button-progress-view"> Download Button Aniamtion </a></p>

<p><a href="https://github.com/Magic-Unique/DoubleThumbSlider">åŒæ»‘å—Slideræ§ä»¶</a></p>

<p><a href="https://github.com/Ramotion/reel-search">æ·è¾“å…¥å¹¶é€‰æ‹©ç»„ä»¶</a> &mdash; ğŸ‘ğŸ‘</p>

<p><a href="https://github.com/AfryMask/AFWaveView">å¿ƒå½¢æ³¢æµª</a></p>

<p><a href="https://github.com/mukyasa/MMTextFieldEffects">å„ç§è¾“å…¥æ¡†äº¤äº’åŠ¨ç”»</a></p>

<p><a href="https://github.com/lovels/LBTagView">å¯æ‹–æ‹½çš„æ ‡ç­¾</a></p>

<p><a href="https://github.com/hyperoslo/Hue#user-content-gradients-1">Gradient æ¸å˜ æ»‘åŠ¨</a></p>

<p><br />
<br /></p>

<h2>CollectionView</h2>

<p><a href="https://github.com/CezaryKopacz/CKWaveCollectionViewTransition"> CollectionView è½¬åœºåŠ¨ç”» </a></p>

<p><a href="https://github.com/nathanwhy/HYAwesomeTransition"> æ ¼ç“¦æ‹‰ cellç§»åŠ¨åŠ¨ç”»Demo </a></p>

<p><a href="https://github.com/nshintio/uicollectionview-reordering"> UICollectionViews æ‹–åŠ¨ </a></p>

<p><a href="https://github.com/alienjun/MyTags"> CollectionViewå®ç°çš„ä¸ªäººæ ‡ç­¾ </a></p>

<p><a href="https://github.com/CezaryKopacz/CKWaveCollectionViewTransition"> Wave CollectionView Transition </a></p>

<p><a href="http://t.cn/Rybxgpy?u=1783821582&amp;amp;amp;amp;amp;amp;amp;m=3885611247173418&amp;amp;amp;amp;amp;amp;amp;cu=1783821582"> iOS ä¹¦æœ¬æ‰“å¼€åŠ¨ç”»åˆ¶ä½œæ•™ç¨‹ </a></p>

<p><a href="https://github.com/zhxnlai/ZLSwipeableViewSwift"> å¡ç‰‡ </a></p>

<p><a href="https://github.com/seedante/CardAnimation"> å¡ç‰‡å¼å‚ç›´ç¿»è½¬åŠ¨ç”» </a></p>

<p><a href="https://github.com/seedante/SDECollectionViewAlbumTransition"> ç›¸å†Œç¿»å¼€åŠ¨ç”»æ•ˆæœ </a></p>

<p><a href="https://github.com/demonnico/PinterestSwift"> ç€‘å¸ƒæµ </a></p>

<p><a href="http://allsome.love/yin-xiang-bi-ji-jiao-hu-xiao-guo-de-shi-xian/?u=1783821582&amp;amp;m=3905429706568663&amp;amp;cu=1783821582&amp;amp;ru=2029464644&amp;amp;rm=3905408588445881"> å°è±¡ç¬”è®°äº¤äº’æ•ˆæœ </a></p>

<p><a href="https://github.com/SmallLang/UICollectionViewLayoutDemo">è‡ªå®šä¹‰UICollectionViewFlowLayoutå’ŒUICollectionViewLayoutçš„ä¸¤ä¸ªä¾‹å­</a></p>

<p><a href="https://medium.com/@victor_wang/build-your-cells-in-a-way-of-lego-fbf6a1133bb1#.eh7fkk93s">å“åº”å¼CollectionView</a></p>

<p><br />
<br /></p>

<h2>Animations By Emails</h2>

<p><a href="http://www.ios-animations-by-emails.com/posts/2015-may#tutorial">Transitions with CoreImage</a></p>

<p><a href="http://ios-animations-by-emails.com/posts/2015-july">Fun with Gradients and Masks</a></p>

<p><a href="http://ios-animations-by-emails.com/posts/2015-november">fireworks</a></p>

<p><a href="http://www.jianshu.com/p/76c588893b19?utm_campaign=hugo&amp;utm_medium=reader_share&amp;utm_content=note&amp;utm_source=weibo">ä½¿ç”¨CAReplicatorLayeråˆ›å»ºåŠ¨ç”»</a></p>

<p><br />
<br /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å†…å­˜ç®¡ç† - ARC]]></title>
    <link href="http://limon.top/nei-cun-guan-li-arc/"/>
    <updated>2015-01-22T18:20:16+08:00</updated>
    <id>http://limon.top/nei-cun-guan-li-arc</id>
    <content type="html"><![CDATA[<h2>ä»€ä¹ˆæ˜¯ARC</h2>

<p>Automatic Reference Countingï¼Œè‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼Œå³ARCã€‚</p>

<p>åœ¨ARCä¸‹ï¼Œä¸éœ€ç”¨retain,release,autorelease,deallocæ¥ç®¡ç†å†…å­˜ï¼Œå®ƒæä¾›äº†è‡ªåŠ¨è¯„ä¼°å†…å­˜ç”Ÿå­˜æœŸçš„åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨ç¼–è¯‘æœŸé—´è‡ªåŠ¨åŠ å…¥åˆé€‚çš„ç®¡ç†å†…å­˜çš„æ–¹æ³•ã€‚ç¼–è¯‘å™¨ä¹Ÿä¼šè‡ªåŠ¨ç”Ÿæˆdeallocå‡½æ•°ã€‚</p>

<h3>ARCå·¥ä½œåŸç†</h3>

<p>ARCå¹¶ä¸æ˜¯ä¸€é¡¹è¿è¡Œæ—¶çš„æœåŠ¡ï¼Œå®é™…ä¸Šå®ƒæ˜¯ç”±Clang front-endæä¾›çš„ä¸¤æ®µè¿‡ç¨‹ã€‚ä¸‹å›¾æ¼”ç¤ºäº†è¿™ä¸¤æ®µè¿‡ç¨‹ã€‚åœ¨front-endæ®µæ—¶ï¼ŒClangæ£€æŸ¥æ¯ä¸ªé¢„å¤„ç†æ–‡ä»¶çš„å¯¹è±¡å’Œå±æ€§ã€‚ç„¶åå®ƒè·Ÿæ®ä¸€äº›å›ºå®šçš„è§„åˆ™å°†retainï¼Œreleaseå’Œautoreleaseè¯­å¥åŠ å…¥å…¶ä¸­ã€‚</p>

<blockquote><p>å®é™…ä¸Šï¼ŒARCåœ¨è°ƒç”¨retain,release,autorelease,deallocæ–¹æ³•æ—¶ï¼Œå¹¶ä¸é€šè¿‡Objective-Cæ¶ˆæ¯æ´¾é€æœºåˆ¶ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨Cã€‚æ¯”å¦‚ï¼ŒARCä¼šè°ƒç”¨ä¸retainç­‰ä»·çš„objc_retain</p></blockquote>

<p><img src="http://limons-gitimage.stor.sinaapp.com/CFigure4.gif" alt="" /></p>

<p>ä¸¾ä¾‹æ¥è¯´ï¼š</p>

<ul>
<li>å¦‚æœå¯¹è±¡è¢«åˆ†é…å†…å­˜å¹¶å¤„äºä¸€ä¸ªæ–¹æ³•å½“ä¸­ï¼Œå®ƒä¼šåœ¨è¿™ä¸ªæ–¹æ³•çš„ç»“å°¾å¤„è·å¾—ä¸€ä¸ªreleaseè¯­å¥</li>
<li>å¦‚æœæ˜¯ä¸€ä¸ªç±»å±æ€§ï¼Œå®ƒçš„releaseè¯­å¥ä¼šåŠ å…¥åˆ°ç±»çš„deallocæ–¹æ³•ä¸­</li>
<li>å¦‚æœè¿™ä¸ªå¯¹è±¡æ˜¯ç”¨æ¥è¿”å›çš„æˆ–è€…å®ƒæ˜¯ä¸€ä¸ªå®¹å™¨å¯¹è±¡ï¼Œå®ƒä¼šåŠ å…¥ä¸€ä¸ªautoreleaseè¯­å¥</li>
<li>å¦‚æœè¿™ä¸ªå¯¹è±¡æ˜¯å¼±å¼•ç”¨ï¼ŒæŠŠå®ƒæ”¾åœ¨ä¸€è¾¹ä¸ç®¡å®ƒã€‚</li>
</ul>


<blockquote><p>è¯‘äºï¼š<a href="http://www.drdobbs.com/mobile/automatic-reference-counting-on-ios/240000820">Automatic Reference Counting on iOS</a></p></blockquote>

<h3>ä»£ç æ¼”ç¤º</h3>

<h4>MRCä¸‹</h4>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>@class Bar;
</span><span class='line'>@interface Foo
</span><span class='line'>{
</span><span class='line'>@private
</span><span class='line'>    NSString *myStr;
</span><span class='line'>}
</span><span class='line'>@property (readonly) NSString *myStr;
</span><span class='line'>  
</span><span class='line'>- (Bar *)foo2Bar:(NSString *)aStr;
</span><span class='line'>- (Bar *)makeBar;
</span><span class='line'>//...
</span><span class='line'>@end
</span><span class='line'>  
</span><span class='line'>  
</span><span class='line'>@implementation Foo;
</span><span class='line'>@dynamic myStr;
</span><span class='line'>  
</span><span class='line'>â€“ (Bar *)foo2Bar:(NSString *)aStr
</span><span class='line'>{
</span><span class='line'>    Bar *tBar;
</span><span class='line'>      
</span><span class='line'>    if (![self.myStr isEqualToString:aStr])
</span><span class='line'>    {
</span><span class='line'>        [aStr retain];
</span><span class='line'>        [myStr release];
</span><span class='line'>        myStr = aStr;
</span><span class='line'>    }  
</span><span class='line'>    return ([self makeBar]);
</span><span class='line'>}
</span><span class='line'>  
</span><span class='line'>- (Bar *)makeBar
</span><span class='line'>{
</span><span class='line'>    Bar *tBar
</span><span class='line'>    //...
</span><span class='line'>    //... conversion code goes here
</span><span class='line'>    //...
</span><span class='line'>    [tBar autorelease];
</span><span class='line'>    return (tBar);
</span><span class='line'>}
</span><span class='line'>//...
</span><span class='line'>  
</span><span class='line'>- (void)dealloc
</span><span class='line'>{
</span><span class='line'>    [myStr release];
</span><span class='line'>    [super dealloc];
</span><span class='line'>}
</span><span class='line'>@end</span></code></pre></td></tr></table></div></figure>


<h4>ARCä¸‹</h4>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>@class Bar;
</span><span class='line'>@interface Foo
</span><span class='line'>{
</span><span class='line'>@private
</span><span class='line'>    NSString *myStr;
</span><span class='line'>}
</span><span class='line'>@property(readonly) NSString *myStr;
</span><span class='line'>  
</span><span class='line'>- (Bar *)foo2Bar:(NSString *)aStr;
</span><span class='line'>- (Bar *)makeBar;
</span><span class='line'>//...
</span><span class='line'>@end
</span><span class='line'>  
</span><span class='line'>  
</span><span class='line'>@implementation Foo;
</span><span class='line'>@dynamic myStr;
</span><span class='line'>  
</span><span class='line'>â€“ (Bar *)foo2Bar:(NSString *)aStr
</span><span class='line'>{
</span><span class='line'>    Bar *tBar;
</span><span class='line'>      
</span><span class='line'>    if (![self.myStr isEqualToString:aStr])
</span><span class='line'>    {
</span><span class='line'>        myStr = aStr;
</span><span class='line'>    }  
</span><span class='line'>    return ([self makeBar]);
</span><span class='line'>}
</span><span class='line'>  
</span><span class='line'>- (Bar *)makeBar
</span><span class='line'>{
</span><span class='line'>    Bar *tBar
</span><span class='line'>    //...
</span><span class='line'>    //... conversion code goes here
</span><span class='line'>    //...
</span><span class='line'>    return (tBar);
</span><span class='line'>}
</span><span class='line'>//...
</span><span class='line'>@end</span></code></pre></td></tr></table></div></figure>


<blockquote><p>ä»¥ä¸Šä»£ç æ¥æºäºï¼š<a href="http://www.drdobbs.com/mobile/automatic-reference-counting-on-ios/240000820">Automatic Reference Counting on iOS</a></p></blockquote>

<h2>ARCä¸‹å†…å­˜ç®¡ç† &mdash; å†…å­˜ç®¡ç†è¯­ä¹‰</h2>

<p>ARCå¸®åŠ©æˆ‘ä»¬è§£å†³90%å†…å­˜ç®¡ç†ä¸ºé¢˜ï¼Œå‰©ä½™çš„10%åŒ…æ‹¬ï¼š</p>

<ul>
<li>å±æ€§(property)çš„å†…å­˜ç®¡ç†è¯­ä¹‰æ˜¯ç”¨strongã€è¿˜æ˜¯weakï¼Ÿ</li>
<li>å¾ªç¯å¼•ç”¨ï¼ˆretain cycleï¼‰é—®é¢˜</li>
<li>CoreFoundationå¯¹è±¡ä¸å½’ARCç®¡ç†</li>
</ul>


<h3>å±æ€§</h3>

<p>å±æ€§(property)æ˜¯Objective-Cçš„ä¸€é¡¹ç‰¹æ€§ï¼Œç”¨äºå°è£…å¯¹è±¡ä¸­çš„æ•°æ®ã€‚Objective-Cå¯¹è±¡é€šå¸¸ä¼šæŠŠå…¶æ‰€éœ€è¦çš„æ•°æ®ä¿å­˜ä¸ºå„ç§å®ä¾‹å˜é‡ã€‚å®ä¾‹å˜é‡ä¸€èˆ¬é€šè¿‡getterã€setteræ¥è®¿é—®ã€‚</p>

<p><code>@property(nonatomic, strong) NSArray *emailList;</code></p>

<p>æ­¤<code>@property</code>ä¼šè‡ªåŠ¨ç”Ÿæˆä¸‰ä¸ªä¸œè¥¿ï¼š_emailListå®ä¾‹å˜é‡ã€getterã€setter</p>

<p>å±æ€§ç”¨äºå°è£…æ•°æ®ï¼Œè€Œæ•°æ®åˆ™è¦æœ‰â€œå…·ä½“çš„æ‰€æœ‰æƒè¯­ä¹‰â€(concrete ownership semantic)ï¼Œä¹Ÿç§°ä¸ºå†…å­˜ç®¡ç†è¯­ä¹‰ã€‚</p>

<p>å›å½’æœ¬é¢˜ï¼Œåœ¨ARCä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨<strong>å†…å­˜ç®¡ç†è¯­ä¹‰</strong>æ¥ç®¡ç†å†…å­˜ï¼Œä¸‹é¢è¿™ä¸€ç»„è¯­ä¹‰ä»…ä¼šå½±å“setterã€‚ä¾‹å¦‚ï¼Œç”¨setterè®¾å®šä¸€ä¸ªæ–°å€¼æ—¶ï¼Œå®ƒæ˜¯åº”è¯¥â€œä¿ç•™â€(retain)æ­¤å€¼å‘¢ï¼Œè¿˜æ˜¯åªå°†å…¶èµ‹ç»™åº•å±‚å®ä¾‹å˜é‡å°±å¥½ï¼Ÿè¿™äº›å–å†³äºä½ æ˜¯ç”¨strongï¼Œè¿˜æ˜¯copyï¼Œè¿˜æ˜¯assignç­‰</p>

<ul>
<li><p><code>assign</code>  å¯¹â€œçº¯é‡ç±»å‹â€(scalar type)çš„ç®€å•èµ‹å€¼</p>

<pre><code>  -(void)setState:(int)State{  
      _state = state;  
  }
</code></pre></li>
<li><p><code>unsafe_unretained</code>  æ­¤è¯­ä¹‰ä¸<code>assign</code>ç›¸åŒï¼Œä½†æ˜¯å®ƒé€‚ç”¨äº&#8221;å¯¹è±¡ç±»å‹&#8221;ï¼Œè¯¥è¯­ä¹‰è¡¨è¾¾ä¸€ç§&#8221;éæ‹¥æœ‰å…³ç³»&#8221;(unretained),å½“å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå±æ€§å€¼ä¸ä¼šè‡ªåŠ¨æ¸…ç©º(&ldquo;ä¸å®‰å…¨&rdquo;,unsafe)ï¼Œè¿™ä¸€ç‚¹ä¸<code>weak</code>æœ‰åŒºåˆ«</p></li>
<li><p><code>weak</code>  è¯¥è¯­ä¹‰è¡¨è¾¾ä¸€ç§&#8221;éæ‹¥æœ‰å…³ç³»&#8221;ï¼Œä¸ºè¿™ç§å±æ€§è®¾ç½®æ–°å€¼æ—¶ï¼Œè®¾ç½®æ–¹æ³•æ—¢ä¸ä¿ç•™æ–°å€¼ï¼Œä¹Ÿä¸é‡Šæ”¾æ—§å€¼ï¼Œå³ä»…ä½œç®€å•èµ‹å€¼ï¼Œç±»ä¼¼<code>assign</code>ï¼Œå½“å¯¹è±¡é”€æ¯ï¼Œå±æ€§å€¼è¢«èµ‹å€¼ä¸º<code>nil</code></p></li>
<li><p><code>strong</code>  è¯¥è¯­ä¹‰è¡¨è¾¾ä¸€ç§&#8221;æ‹¥æœ‰å…³ç³»&#8221;ï¼Œä¸ºè¿™ç§å±æ€§å€¼è®¾ç½®æ–°å€¼æ—¶ï¼Œè®¾ç½®æ–¹æ³•ä¼šå…ˆä¿ç•™æ–°å€¼ï¼Œå†é‡Šæ”¾æ—§å€¼ï¼Œæœ€åæŠŠæ–°å€¼è®¾ç½®ä¸Šå»</p>

<pre><code>  -(void)setName:(NSArray *)emailList{    
      if ( emailList != _emailList){
          [emailList retain]; // ä¿ç•™æ–°å€¼
          [_emailList release]; // é‡Šæ”¾æ—§å€¼
          _emailList = emailList;
      }   
  }
</code></pre></li>
</ul>


<p>æ­¤setterå°†ä¿ç•™æ–°å€¼å¹¶é‡Šæ”¾æ—§å€¼ï¼Œç„¶åæ›´æ–°å®ä¾‹å˜é‡ï¼Œä»¤å…¶æŒ‡å‘æ–°å€¼ã€‚é¡ºåºå¾ˆé‡è¦ï¼Œå‡å¦‚ä¸¤ä¸ªå€¼éƒ½æŒ‡å‘å¯¹è±¡Aï¼Œè¿˜æœªä¿ç•™æ–°å€¼å°±å…ˆæŠŠæ—§å€¼é‡Šæ”¾äº†ï¼Œé‚£ä¹ˆå…ˆæ‰§è¡Œçš„releaseæ“ä½œå°±å¯èƒ½å¯¼è‡´å¯¹è±¡Aè¢«å›æ”¶ï¼Œè€Œåç»­çš„retainæ“ä½œå¹¶æ— æ³•ä»¤å¯¹è±¡Aå¤ç”Ÿï¼Œäºæ˜¯å®ä¾‹å˜é‡å°±æˆäº†æ‚¬æŒ‚æŒ‡é’ˆ</p>

<blockquote><p>å½“æ‰€æŒ‡å‘çš„å¯¹è±¡è¢«é‡Šæ”¾æˆ–è€…æ”¶å›ï¼Œæ­¤æƒ…å†µä¸‹è¯¥æŒ‡é’ˆä¾¿ç§°æ‚¬å‚æŒ‡é’ˆï¼ˆä¹Ÿå«è¿·é€”æŒ‡é’ˆï¼‰ã€‚</p></blockquote>

<ul>
<li><p>copy  æ­¤è¯­ä¹‰ä¸strongç±»ä¼¼ï¼Œä¸åŒåœ¨äºsetterå¹¶ä¸ä¿ç•™æ–°å€¼ï¼Œè€Œæ˜¯å°†å…¶<code>copy</code>ï¼Œå¦‚ä¸‹ï¼š</p>

<pre><code>  @property (nonatomic, copy) NSString *name;

  -(void)setName:(NSString*)name{  
      if ( name != _name){  
          [_name release];
          _name = nil;
          _name = [name copy]; 
      }  
  }
</code></pre></li>
</ul>


<p>ä½¿ç”¨copyå¯ä»¥ç”¨æ¥ä¿æŠ¤æ•°æ®çš„å°è£…æ€§ï¼Œæ¯”æ–¹è¯´ï¼Œä¼ é€’è¿‡æ¥çš„æ–°å€¼æ˜¯ä¸€ä¸ªNSMutableStringçš„å®ä¾‹ï¼Œæ­¤æ—¶è‹¥ä¸<code>copy</code>ï¼Œå½“è®¾ç½®å®Œå±æ€§å€¼ä¹‹åï¼Œè¯¥å¯å˜æ–°å€¼åœ¨å¯¹è±¡ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹é­äººæ›´æ”¹ã€‚æ‰€ä»¥ï¼Œè¿™æ—¶å°±è¦<code>copy</code>ä¸€ä»½â€œä¸å¯å˜â€(immutable)çš„å­—ç¬¦ä¸²ï¼Œç¡®ä¿å¯¹è±¡ä¸­çš„å­—ç¬¦ä¸²å€¼ä¸ä¼šä¸ä¼šæ— æ„é—´å˜åŠ¨ã€‚</p>

<h3>ARCä¸‹å†…å­˜ç®¡ç† &mdash; åŸºæœ¬è§„åˆ™</h3>

<p>ARCä¸‹å†…å­˜ç®¡ç†çš„ä¸€ä¸ªåŸºæœ¬è§„åˆ™ï¼šåªè¦æŸä¸ªå¯¹è±¡è¢«ä»»ä¸€strongæŒ‡é’ˆæŒ‡å‘ï¼Œé‚£ä¹ˆå®ƒå°†ä¸ä¼šè¢«å›æ”¶ã€‚</p>

<h4>strong</h4>

<p>åœ¨MRCä¸‹ï¼Œå¦‚æœæƒ³ä»¤ä¸€ä¸ªå¯¹è±¡ç»§ç»­å­˜æ´»ï¼Œéœ€ç”¨retainæ¥é€’å¢è®¡æ•°å™¨ï¼Œä¸è¿‡ARCå·²ç»åœ¨ç¼–è¯‘æ—¶å¸®æˆ‘ä»¬åŠ å…¥äº†retainã€releaseç­‰ï¼Œç°åœ¨å”¯ä¸€éœ€è¦çš„æ˜¯ï¼Œç”¨ä¸€ä¸ªå¼ºæŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡ï¼Œåªè¦æŒ‡é’ˆæ²¡æœ‰è¢«ç©ºç½®ï¼Œè¯¥å¯¹è±¡ä¼šä¸€ç›´åœ¨å †ä¸Šã€‚</p>

<blockquote><p>å®é™…ä¸Šï¼Œä¸è®ºMRCå’ŒARCä¸‹ï¼Œè¿˜æ˜¯åœ¨ç”¨å¼•ç”¨è®¡æ•°æ¥ç®¡ç†å†…å­˜ï¼Œå…·ä½“è¯·çœ‹ï¼š<a href="http://limon-.github.io/blog/2015/01/13/nei-cun-guan-li-yin-yong-ji-shu-qi/">å†…å­˜ç®¡ç† - å¼•ç”¨è®¡æ•°å™¨</a></p></blockquote>

<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„å®ä¾‹å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½æ˜¯strongç±»å‹çš„ã€‚å¯ä»¥è¯´strongç±»å‹çš„æŒ‡é’ˆåœ¨è¡Œä¸ºä¸Šå’ŒMRCæ—¶ä»£çš„retainæ˜¯æ¯”è¾ƒç›¸ä¼¼çš„ã€‚</p>

<h4>weak</h4>

<p>weakå¸¸ç”¨åœ¨ä¸¤ä¸ªå¯¹è±¡é—´å­˜åœ¨åŒ…å«å…³ç³»æ—¶ï¼šå¯¹è±¡Aæœ‰ä¸€ä¸ªstrongæŒ‡é’ˆæŒ‡å‘å¯¹è±¡Bï¼Œå¹¶æŒæœ‰å®ƒï¼Œè€Œå¯¹è±¡Bä¸­ä¹Ÿæœ‰ä¸€ä¸ªweakæŒ‡é’ˆæŒ‡å›å¯¹è±¡Bï¼Œä»è€Œé¿å…äº†å¾ªç¯æŒæœ‰ã€‚</p>

<p>ä¸€ä¸ªå¸¸è§çš„ä¾‹å­å°±æ˜¯delegateè®¾è®¡æ¨¡å¼ï¼ŒviewControllerä¸­æœ‰ä¸€ä¸ªstrongæŒ‡é’ˆæŒ‡å‘å®ƒæ‰€è´Ÿè´£ç®¡ç†çš„UITableViewï¼Œè€ŒUITableViewä¸­çš„dataSourceå’ŒdelegateæŒ‡é’ˆéƒ½æ˜¯æŒ‡å‘viewControllerçš„weakæŒ‡é’ˆã€‚å¯ä»¥è¯´ï¼ŒweakæŒ‡é’ˆçš„è¡Œä¸ºå’ŒMRCæ—¶ä»£çš„assignæœ‰ä¸€äº›ç›¸ä¼¼ç‚¹ï¼Œä½†æ˜¯è€ƒè™‘åˆ°weakæŒ‡é’ˆæ›´èªæ˜äº›ï¼ˆä¼šè‡ªåŠ¨æŒ‡å‘nilï¼‰</p>

<p><img src="http://limons-gitimage.stor.sinaapp.com/arcpic7.png" alt="" /></p>

<blockquote><p>ä»£ç†æ¨¡å¼å¯ä»¥ç®€å•è®¤ä¸ºï¼Œä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆ&#8221;åŠä¿ç•™ç¯&#8221;ï¼ˆAå¯¹è±¡å¼ºæŒ‡é’ˆæŒ‡å‘Bå¯¹è±¡ï¼ŒBå¯¹è±¡å¼±æŒ‡é’ˆæŒ‡å‘Aå¯¹è±¡ï¼‰</p></blockquote>

<h3>ARCä¸‹å†…å­˜ç®¡ç† &mdash; å¾ªç¯å¼•ç”¨</h3>

<p>æ¥ä¸‹æ¥ç®€å•è®²è®²å®¹æ˜“å¾ªç¯å¼•ç”¨çš„åœºæ™¯ï¼Œè¯¦æƒ…è¯·çœ‹<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/EncapsulatingData/EncapsulatingData.html#//apple_ref/doc/uid/TP40011210-CH5-SW3">å®˜æ–¹æ–‡æ¡£</a>çš„ç›¸å…³èµ„æ–™</p>

<h4>å§”æ‰˜æ¨¡å¼</h4>

<pre><code>@property (nonatomic,weak) id&lt;ComposeToolbarButtonTypeDelegate&gt; delegate; 
</code></pre>

<p>ç”¨<code>weak</code>å½¢æˆâ€œåŠä¿ç•™ç¯â€ï¼Œé˜²æ­¢å¾ªç¯å¼•ç”¨</p>

<h4>block</h4>

<p>è¿™ä¸ªç½‘ä¸Šå¤§æŠŠï¼Œå¯ä»¥çœ‹çœ‹<a href="http://www.cnbluebox.com/?p=255">blockä½¿ç”¨å°ç»“ã€åœ¨arcä¸­ä½¿ç”¨blockã€å¦‚ä½•é˜²æ­¢å¾ªç¯å¼•ç”¨</a></p>

<h3>ARCä¸‹å†…å­˜ç®¡ç† &mdash; self</h3>

<p>ARCä¸‹ï¼Œæ–¹æ³•å†…çš„selfæ—¢ä¸æ˜¯strongä¹Ÿä¸æ˜¯weakï¼Œè€Œæ˜¯unsafe_unretainedçš„ï¼ˆinitç³»åˆ—æ–¹æ³•çš„selfé™¤å¤–ï¼‰ã€‚
æ¢è€Œè¨€ä¹‹ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒARCä¸ä¼šå¯¹<code>self</code>åš<code>retain</code>å’Œ<code>release</code>æ“ä½œï¼Œç”Ÿå‘½å‘¨æœŸå…¨ç”±è°ƒç”¨æ–¹æ¥å†³å®šï¼Œå¦‚æœè°ƒç”¨æ–¹æ²¡æœ‰ä¿è¯<code>self</code>åœ¨è¢«è°ƒç”¨æ–¹æ³•ä¸­çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯èƒ½åœ¨æ­¤æ–¹æ³•ä¸­è¿è¡Œåˆ°ä¸€åŠï¼Œ<code>self</code>å°±è¢«é‡Šæ”¾äº†ï¼Œå¯èƒ½ç¨‹åºå°±å´©æºƒäº†ã€‚</p>

<h2>æ€»ç»“</h2>

<ul>
<li>ARCç®¡ç†å¯¹è±¡ç”Ÿå‘½æœŸçš„åŸºæœ¬åŠæ³•ï¼šåœ¨ç¼–è¯‘æœŸé—´ï¼Œåœ¨åˆé€‚çš„åœ°æ–¹æ’å…¥<code>retain</code>å’Œ<code>release</code>æ“ä½œ</li>
<li>åœ¨ARCä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡<code>å†…å­˜ç®¡ç†è¯­ä¹‰</code>æ¥ç®¡ç†å†…å­˜ï¼Œå¸¸è§çš„æœ‰ï¼š<code>strong</code>ã€<code>weak</code>ã€<code>copy</code></li>
</ul>


<h2>ç•ªå¤–</h2>

<p>ç ”è¯»äº†@sunnyå¤§å¤§çš„<a href="http://blog.sunnyxx.com/2015/01/17/self-in-arc/">ã€ŠARCå¯¹selfçš„å†…å­˜ç®¡ç†ã€‹</a>ä¹‹åä½œä¸€äº›ç¬”è®°ï¼Œ</p>

<h2>å‚è€ƒèµ„æ–™</h2>

<p><a href="http://clang.llvm.org/docs/AutomaticReferenceCounting.html">Objective-C Automatic Reference Counting (ARC)</a> &mdash;&ndash; å…³äºARCçš„è¯¦ç»†æ–‡æ¡£</p>

<p><a href="http://blog.sunnyxx.com/2015/01/17/self-in-arc/">ARCå¯¹selfçš„å†…å­˜ç®¡ç†</a> &mdash;&ndash; ä¸“é—¨å¯¹ARCä¸‹selfçš„å‰–æ</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å†…å­˜ç®¡ç† - Autorelease]]></title>
    <link href="http://limon.top/autoreleasepool/"/>
    <updated>2015-01-19T16:12:34+08:00</updated>
    <id>http://limon.top/autoreleasepool</id>
    <content type="html"><![CDATA[<p>Autoreleaseå®é™…ä¸Šåªæ˜¯æŠŠå¯¹releaseçš„è°ƒç”¨å»¶è¿Ÿäº†ï¼Œå¯¹äºæ¯ä¸€ä¸ªAutoreleaseï¼Œç³»ç»Ÿåªæ˜¯æŠŠè¯¥Objectæ”¾å…¥äº†å½“å‰çš„Autorelease poolä¸­ï¼Œå½“è¯¥poolè¢«é‡Šæ”¾æ—¶ï¼Œè¯¥poolä¸­çš„æ‰€æœ‰Objectä¼šè¢«è°ƒç”¨releaseï¼Œä¹Ÿå°±æ˜¯è®¡æ•°å™¨ä¼šå‡1ï¼Œä½†æ˜¯è‡ªåŠ¨é‡Šæ”¾æ± è¢«é”€æ¯äº†ï¼Œé‡Œé¢çš„å¯¹è±¡å¹¶ä¸ä¸€å®šä¼šè¢«é”€æ¯ã€‚</p>

<p>ç®€è€Œè¨€ä¹‹ï¼Œautorelease pool é¿å…äº†é¢‘ç¹ç”³è¯·/é‡Šæ”¾å†…å­˜ã€‚</p>

<h2>poolä»€ä¹ˆæ—¶å€™è¢«é”€æ¯ï¼Ÿ</h2>

<p>åœ¨æ¯ä¸€ä¸ªRunloopç»“æŸæ—¶ï¼Œå½“å‰æ ˆé¡¶çš„Autorelease poolä¼šè¢«é”€æ¯ï¼Œæ­¤poolå†…çš„OCå¯¹è±¡ä¼šè¢«releaseã€‚
é‚£ä»€ä¹ˆæ˜¯ä¸€ä¸ªRunloopå‘¢ï¼Ÿ ä¸€ä¸ªUIäº‹ä»¶ï¼ŒTimer callï¼Œ delegate callï¼Œ éƒ½ä¼šæ˜¯ä¸€ä¸ªæ–°çš„Runloop</p>

<p>åœ¨Iphoneé¡¹ç›®ä¸­ï¼Œå¤§å®¶ä¼šçœ‹åˆ°ä¸€ä¸ªé»˜è®¤çš„Autorelease poolï¼Œç¨‹åºå¼€å§‹æ—¶åˆ›å»ºï¼Œç¨‹åºé€€å‡ºæ—¶é”€æ¯ï¼ŒæŒ‰ç…§å¯¹Autoreleaseçš„ç†è§£ï¼Œå²‚ä¸æ˜¯æ‰€æœ‰autorelease poolé‡Œçš„å¯¹è±¡åœ¨ç¨‹åºé€€å‡ºæ—¶æ‰releaseï¼Œ è¿™æ ·è·Ÿå†…å­˜æ³„éœ²æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>

<p>ç­”æ¡ˆæ˜¯ï¼Œå¯¹äºæ¯ä¸€ä¸ªRunloopï¼Œ ç³»ç»Ÿä¼šéšå¼åˆ›å»ºä¸€ä¸ªAutorelease poolï¼Œè¿™æ ·æ‰€æœ‰çš„release poolä¼šæ„æˆä¸€ä¸ªæ ˆå¼ç»“æ„ï¼Œéµå¾ªå…ˆè¿›åå‡ºï¼Œåœ¨æ¯ä¸€ä¸ªRunloopç»“æŸæ—¶ï¼Œå½“å‰æ ˆé¡¶çš„Autorelease poolä¼šè¢«é”€æ¯ï¼Œè¿™æ ·è¿™ä¸ªpoolé‡Œçš„æ¯ä¸ªOCå¯¹è±¡ä¼šè¢«releaseã€‚</p>

<h2>poolåµŒå¥—ï¼Œæ ˆå¼ç»“æ„</h2>

<p>å¯¹äºæ¯ä¸€ä¸ªRunloopï¼Œ ç³»ç»Ÿä¼šéšå¼åˆ›å»ºä¸€ä¸ªAutorelease poolï¼Œè¿™æ ·æ‰€æœ‰çš„release poolä¼šæ„æˆä¸€ä¸ªæ ˆå¼ç»“æ„ï¼Œéµå¾ªå…ˆè¿›åå‡º</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>#import &lt;Foundation/Foundation.h&gt; 
</span><span class='line'>#import "Person.h" 
</span><span class='line'>int main(int argc, const char * argv[]) 
</span><span class='line'>{ 
</span><span class='line'>     
</span><span class='line'>    // è‡ªåŠ¨é‡Šæ”¾æ± 1 
</span><span class='line'>    @autoreleasepool { 
</span><span class='line'>         
</span><span class='line'> // å¯¹è±¡çš„é‡Šæ”¾äº¤ç»™ è‡ªåŠ¨é‡Šæ”¾æ± å»ç®¡ç† ä¸ç”¨å†å†™[person release] 
</span><span class='line'>        Person *person = [[Person alloc] init];  
</span><span class='line'>         
</span><span class='line'>        // å†åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨é‡Šæ”¾æ± 2 
</span><span class='line'>        @autoreleasepool { 
</span><span class='line'>             
</span><span class='line'>            Person *person2 = [[Person alloc] init]; 
</span><span class='line'>        } 
</span><span class='line'>        
</span><span class='line'>        Person *person3 = [[Person alloc] init];    
</span><span class='line'>    } 
</span><span class='line'>    return 0; 
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>pool2å…ˆè¢«é”€æ¯ï¼Œæœ€åæ‰æ˜¯pool1ï¼Œå³é‡Šæ”¾é¡ºåºï¼šperson2 -> person3/person2</p>

<h3>#</h3>

<h4>ä¸€ä¸‹å†…å®¹æ•´ç†äº #<a href="http://blog.sunnyxx.com/2014/10/15/behind-autorelease/">é»‘å¹•èƒŒåçš„Autorelease</a></h4>

<p>åœ¨ARCä¸‹ï¼Œ<code>@autoreleasepool{}</code>åˆ›å»ºä¸€ä¸ªAutoreleasePoolï¼Œéšåç¼–è¯‘å™¨å°†å…¶æ”¹å†™æˆä¸‹é¢çš„æ ·å­ï¼š</p>

<pre><code>void *context = objc_autoreleasePoolPush();
// {}ä¸­çš„ä»£ç 
objc_autoreleasePoolPop(context);
</code></pre>

<p>è€Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯¹AutoreleasePoolPageçš„ç®€å•å°è£…ï¼Œæ‰€ä»¥è‡ªåŠ¨é‡Šæ”¾æœºåˆ¶çš„æ ¸å¿ƒå°±åœ¨äºè¿™ä¸ªç±»ã€‚</p>

<pre><code>class AutoreleasePoolPage 
{
    .....
    magic_t const magic;
    id *next;
    pthread_t const thread;
    AutoreleasePoolPage * const parent;
    AutoreleasePoolPage *child;
    uint32_t const depth;
    uint32_t hiwat;
    ....
}
</code></pre>

<ul>
<li>AutoreleasePoolå¹¶æ²¡æœ‰å•ç‹¬çš„ç»“æ„ï¼Œè€Œæ˜¯ç”±è‹¥å¹²ä¸ªAutoreleasePoolPageä»¥åŒå‘é“¾è¡¨çš„å½¢å¼ç»„åˆè€Œæˆï¼ˆåˆ†åˆ«å¯¹åº”ç»“æ„ä¸­çš„parentæŒ‡é’ˆå’ŒchildæŒ‡é’ˆï¼‰</li>
<li>AutoreleasePoolæ˜¯æŒ‰çº¿ç¨‹ä¸€ä¸€å¯¹åº”çš„ï¼ˆç»“æ„ä¸­çš„threadæŒ‡é’ˆæŒ‡å‘å½“å‰çº¿ç¨‹ï¼‰</li>
<li>AutoreleasePoolPageæ¯ä¸ªå¯¹è±¡ä¼šå¼€è¾Ÿ4096å­—èŠ‚å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯è™šæ‹Ÿå†…å­˜ä¸€é¡µçš„å¤§å°ï¼‰ï¼Œé™¤äº†ä¸Šé¢çš„å®ä¾‹å˜é‡æ‰€å ç©ºé—´ï¼Œå‰©ä¸‹çš„ç©ºé—´å…¨éƒ¨ç”¨æ¥å‚¨å­˜autoreleaseå¯¹è±¡çš„åœ°å€</li>
<li>ä¸Šé¢çš„id *nextæŒ‡é’ˆä½œä¸ºæ¸¸æ ‡æŒ‡å‘æ ˆé¡¶æœ€æ–°addè¿›æ¥çš„autoreleaseå¯¹è±¡çš„ä¸‹ä¸€ä¸ªä½ç½®</li>
<li>ä¸€ä¸ªAutoreleasePoolPageçš„ç©ºé—´è¢«å æ»¡æ—¶ï¼Œä¼šæ–°å»ºä¸€ä¸ªAutoreleasePoolPageå¯¹è±¡ï¼Œè¿æ¥é“¾è¡¨ï¼Œåæ¥çš„autoreleaseå¯¹è±¡åœ¨æ–°çš„pageåŠ å…¥</li>
</ul>


<h2>æ€»ç»“</h2>

<ul>
<li>autoreleaseæ–¹æ³•ä¸ä¼šæ”¹å˜å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ï¼Œåªæ˜¯å°†è¿™ä¸ªå¯¹è±¡æ”¾åˆ°è‡ªåŠ¨é‡Šæ”¾æ± ä¸­ï¼›</li>
<li>è‡ªåŠ¨é‡Šæ”¾æ± å®è´¨æ˜¯å½“è‡ªåŠ¨é‡Šæ”¾æ± é”€æ¯åè°ƒç”¨å¯¹è±¡çš„releaseæ–¹æ³•ï¼Œä¸ä¸€å®šå°±èƒ½é”€æ¯å¯¹è±¡ï¼ˆä¾‹å¦‚å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨>1åˆ™æ­¤æ—¶å°±æ— æ³•é”€æ¯ï¼‰ï¼›</li>
<li>ç”±äºè‡ªåŠ¨é‡Šæ”¾æ± æœ€åç»Ÿä¸€é”€æ¯å¯¹è±¡ï¼Œå› æ­¤å¦‚æœä¸€ä¸ªæ“ä½œæ¯”è¾ƒå ç”¨å†…å­˜ï¼ˆå¯¹è±¡æ¯”è¾ƒå¤šæˆ–è€…å¯¹è±¡å ç”¨èµ„æºæ¯”è¾ƒå¤šï¼‰ï¼Œæœ€å¥½ä¸è¦æ”¾åˆ°è‡ªåŠ¨é‡Šæ”¾æ± æˆ–è€…è€ƒè™‘æ”¾åˆ°å¤šä¸ªè‡ªåŠ¨é‡Šæ”¾æ± ï¼›</li>
<li>ObjCä¸­ç±»åº“ä¸­çš„é™æ€æ–¹æ³•ä¸€èˆ¬éƒ½ä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾ï¼Œå†…éƒ¨å·²ç»è°ƒç”¨äº†autoreleaseæ–¹æ³•ï¼›</li>
</ul>


<p><a href="http://blog.sunnyxx.com/2014/10/15/behind-autorelease/">é»‘å¹•èƒŒåçš„Autorelease</a></p>

<p><a href="http://www.cnblogs.com/kenshincui/p/3870325.html#autoreleasepool">Objective-Cä¹‹å†…å­˜ç®¡ç†</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å†…å­˜ç®¡ç† - å¼•ç”¨è®¡æ•°]]></title>
    <link href="http://limon.top/nei-cun-guan-li-yin-yong-ji-shu-qi/"/>
    <updated>2015-01-13T14:27:14+08:00</updated>
    <id>http://limon.top/nei-cun-guan-li-yin-yong-ji-shu-qi</id>
    <content type="html"><![CDATA[<h2>å†…å­˜ç®¡ç†æ¦‚è¿°</h2>

<p>åœ¨Objective-Cä¸­ï¼Œç³»ç»Ÿå¹¶ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾å †ä¸­çš„å†…å­˜ï¼Œå…¶ä»–é«˜çº§è¯­è¨€C#ã€JAVAéƒ½æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä½†åœ¨Objective-Cä¸­å¹¶æ²¡æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œé‚£ä¹ˆObjective-Cä¸­çš„å†…å­˜æ˜¯å¦‚ä½•ç®¡ç†ï¼Ÿ
Objective-Cè¯­è¨€ä½¿ç”¨å¼•ç”¨è®¡æ•°å™¨æ¥ç®¡ç†å†…å­˜ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸ªå¯ä»¥é€’å¢æˆ–é€’å‡çš„è®¡æ•°å™¨ã€‚å¦‚æœæƒ³ä½¿æŸä¸ªå¯¹è±¡ç»§ç»­å­˜æ´»ï¼Œé‚£å°±é€’å¢å…¶å¼•ç”¨è®¡æ•°å™¨ï¼›ç”¨å®Œä¹‹åï¼Œå°±é€’å‡å…¶è®¡æ•°å™¨ï¼›å½“è®¡æ•°å™¨ä¸º0ï¼Œå°±è¡¨ç¤ºæ²¡äººå…³æ³¨æ­¤å¯¹è±¡ï¼Œæ­¤å¯¹è±¡å°±ä¼šè¢«é”€æ¯ã€‚</p>

<h2>å¼•ç”¨è®¡æ•°å·¥ä½œåŸç†</h2>

<p>åœ¨å¼•ç”¨è®¡æ•°æ¶æ„ä¸‹ï¼Œå¯¹è±¡æœ‰ä¸ªè®¡æ•°å™¨ï¼Œç”¨ä»¥è¡¨ç¤ºå½“å‰æœ‰å¤šå°‘ä¸ªäº‹ç‰©æƒ³ä»¤æ­¤å¯¹è±¡ç»§ç»­å­˜æ´»ã€‚
NSObjectåè®®å£°æ˜äº†ä¸‰ä¸ªæ–¹æ³•ç”¨äºæ“ä½œè®¡æ•°å™¨</p>

<ul>
<li>Retain é€’å¢è®¡æ•°å™¨</li>
<li>Release é€’å‡è®¡æ•°å™¨</li>
<li>autorelease å¾…é”€æ¯autorelease poolæ—¶ï¼Œå†é€’å‡poolå†…çš„å…¨éƒ¨è®¡æ•°å™¨</li>
</ul>


<p>1.å¯¹ä¸€ä¸ªå¯¹è±¡å‘é€allocã€retainã€newã€copyæ¶ˆæ¯ï¼Œè®¡æ•°å™¨ +1</p>

<p>2.å¯¹ä¸€ä¸ªå¯¹è±¡å‘é€releaseæ¶ˆæ¯ï¼Œè®¡æ•°å™¨ -1</p>

<p>3.å½“ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ä¸º0ï¼Œå¯¹è±¡å°±è¢«å›æ”¶(dealloced)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿä¼šå°†å¯¹è±¡å…¶å ç”¨çš„å†…å­˜æ ‡è®°ä¸ºâ€œå¯é‡ç”¨â€(reuse)ï¼Œæ”¾åˆ°â€œå¯ç”¨å†…å­˜æ± â€(avaiable pool)</p>

<h3>æ‰‹åŠ¨ç®¡ç†å†…å­˜çš„ä¸‰ç‚¹åŸåˆ™</h3>

<ul>
<li>å¦‚æœéœ€è¦æŒæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå¯¹å…¶å‘é€retain</li>
<li>å¦‚æœä¹‹åä¸å†ä½¿ç”¨è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆéœ€è¦å¯¹å…¶å‘é€releaseï¼ˆæˆ–è€…autorealseï¼‰</li>
<li>æ¯ä¸€æ¬¡å¯¹retain,allocæˆ–è€…newçš„è°ƒç”¨ï¼Œéœ€è¦å¯¹åº”ä¸€æ¬¡releaseæˆ–autorealseè°ƒç”¨</li>
</ul>


<h3>å›¾è¡¨æ¼”ç¤º</h3>

<p>ä¸‹å›¾æ¼”ç¤ºäº†ä¸€ä¸ªå¯¹è±¡è‡ªåˆ›å»ºå‡ºæ¥ä¹‹åç»å†ä¸€æ¬¡retainåŠä¸¤æ¬¡releaseæ“ä½œçš„è¿‡ç¨‹</p>

<p><img src="http://limons-gitimage.stor.sinaapp.com/Memory.png" alt="Memory" /></p>

<p>ä¸‹å›¾æ‰€ç¤ºçš„å¯¹è±¡å›¾ä¸­ï¼ŒObjectBå’ŒObjectCéƒ½å¼•ç”¨äº†ObjectAï¼Œè‹¥Bå’ŒCéƒ½ä¸å†ä½¿ç”¨Aï¼Œåˆ™å…¶è®¡æ•°å™¨ä¸º0ï¼Œä¾¿è¢«å›æ”¶ã€‚è¿˜æœ‰OrderObjectæƒ³ä»¤Bå’ŒCç»§ç»­å­˜æ´»ï¼Œè€Œåº”ç”¨ç¨‹åºé‡Œåˆæœ‰å¦å¤–çš„å¯¹è±¡æƒ³ä»¤OrderObjectç»§ç»­å­˜æ´»ï¼Œå¦‚æœæŒ‰â€œå¼•ç”¨æ ‘â€œå›æº¯ï¼Œé‚£ä¹ˆä¼šå‘ç°ä¸€ä¸ªâ€œæ ¹å¯¹è±¡â€ï¼Œåœ¨iOSä¸­ï¼Œåˆ™æ˜¯UIApplicationå¯¹è±¡ã€‚æ­¤â€æ ¹å¯¹è±¡â€æ˜¯åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºçš„å•ä¾‹ã€‚</p>

<p><img src="http://limons-gitimage.stor.sinaapp.com/Memory-2.png" alt="Memory" /></p>

<h3>ä»£ç æ¼”ç¤º</h3>

<pre><code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    NSMutableArray *array = [[NSMutableArray alloc] init];
    NSNumber *number = [[NSNumber alloc] initWithInt:1337]; 

    [array addObject:number]; //numberçš„å¼•ç”¨è®¡æ•°å™¨+1ï¼ˆæ­¤æ—¶numberçš„å¼•ç”¨è®¡æ•°å™¨è‡³å°‘ä¸º2ï¼‰
    [number release]; // -1

    // do something with `arrayâ€™

    [array release];
    return YES;
}
</code></pre>

<blockquote><p>åœ¨è°ƒç”¨æ•°ç»„çš„<code>-addObject</code>æ–¹æ³•æ—¶ï¼Œæ•°ç»„ä¹Ÿä¼šåœ¨numberä¸Šè°ƒç”¨retainï¼Œä»¥æœŸä»¤æ­¤å¯¹è±¡å­˜æ´»</p></blockquote>

<h2>å¼•ç”¨è®¡æ•°çš„åº”ç”¨åœºæ™¯</h2>

<p>åœ¨ä¸Šé¢çš„ä»£ç æ¼”ç¤ºä¸­ï¼Œè¿˜ä¸çœ‹å‡ºå¼•ç”¨è®¡æ•°çš„çœŸæ­£ç”¨å¤„ã€‚åœ¨å‡½æ•°å†…ä½¿ç”¨ä¸€ä¸ªä¸´æ—¶çš„å¯¹è±¡ï¼Œé€šå¸¸ä¸éœ€è¦ä¿®æ”¹å¼•ç”¨è®¡æ•°ï¼Œåªéœ€åœ¨è¿”å›å‰å°†è¯¥å¯¹è±¡é”€æ¯å³å¯ã€‚
å¼•ç”¨è®¡æ•°çœŸæ­£çš„åº”ç”¨åœºæ™¯æ˜¯ï¼Œç”¨äºå¯¹è±¡ä¹‹é—´ä¼ é€’å’Œå…±äº«æ•°æ®ã€‚</p>

<h2>å¼•ç”¨è®¡æ•°çš„æ³¨æ„è¦ç‚¹</h2>

<h3>retainCountå¯èƒ½æ°¸è¿œä¸ä¸º0</h3>

<p>å¯èƒ½æœ‰äººä¼šæµ‹è¯•å¯¹è±¡é‡Šæ”¾æ—¶ï¼Œçœ‹retainCountæ˜¯å¦ä¸º0ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code>NSObject *object = [[NSObject alloc] init];
NSLog(@"%lu",(unsigned long)[object retainCount]);
[object release];
NSLog(@"%lu",(unsigned long)[object retainCount]);
</code></pre>

<p>ä½†æ˜¯ï¼Œæ‰“å°çš„ç»“æœæ˜¯ 1  1</p>

<p>æœ€åä¸€æ¬¡è¾“å‡ºï¼Œå¼•ç”¨è®¡æ•°å¹¶æ²¡æœ‰å˜æˆ0ï¼ŒåŸå› æ˜¯åœ¨æœ€åä¸€æ¬¡ release æ—¶ï¼Œç³»ç»Ÿé©¬ä¸Šå°±å›æ”¶äº†å†…å­˜ï¼Œå°±æ²¡æœ‰å†å°†retainCountå‡1ï¼Œå› ä¸ºä¸å°†å€¼ä»1å˜æˆ0ï¼Œå¯ä»¥å‡å°‘ä¸€æ¬¡å†…å­˜æ“ä½œï¼ŒåŠ å¿«å¯¹è±¡çš„å›æ”¶ï¼Œåªæœ‰åœ¨ç³»ç»Ÿä¸æ‰“ç®—è¿™ä¹ˆä¼˜åŒ–æ—¶ï¼Œè®¡æ•°å€¼æ‰ä¼šé€’å‡ä¸º0</p>

<h3>æ‚¬æŒ‚æŒ‡é’ˆ</h3>

<p>å½“æ‰€æŒ‡å‘çš„å¯¹è±¡è¢«é‡Šæ”¾æˆ–è€…æ”¶å›ï¼Œæ­¤æƒ…å†µä¸‹è¯¥æŒ‡é’ˆä¾¿ç§°æ‚¬å‚æŒ‡é’ˆï¼ˆä¹Ÿå«è¿·é€”æŒ‡é’ˆï¼‰ã€‚</p>

<blockquote><p>æŸäº›ç¼–ç¨‹è¯­è¨€å…è®¸æœªåˆå§‹åŒ–çš„æŒ‡é’ˆçš„å­˜åœ¨ï¼Œè€Œè¿™ç±»æŒ‡é’ˆå³ä¸ºé‡æŒ‡é’ˆã€‚</p></blockquote>

<p>ä¸ºä»€ä¹ˆå¯¹è±¡è¢«å›æ”¶äº†ï¼Œå‘å…¶å‘é€æ¶ˆæ¯ä¸ä¼šå´©ï¼Ÿä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code>NSNumber *number = [[NSNumber alloc] initWithInt:1337];

[number release];

NSLog(@"number = %@",number);
</code></pre>

<p>å†…å­˜å·²ç»è¢«å›æ”¶ï¼Œå¦‚æœå‘å…¶å‘é€æ¶ˆæ¯ï¼Œå¯èƒ½ä½¿ç¨‹åºå´©æºƒã€‚ä¸ºä»€ä¹ˆè¯´â€œå¯èƒ½â€ï¼Œè€Œæ²¡è¯´â€œä¸€å®šâ€ï¼Œæ˜¯å› ä¸ºå¯¹è±¡çš„æ‰€å çš„å†…å­˜åœ¨â€œè§£é™¤åˆ†é…â€(deallocated)ä¹‹åï¼Œåªæ˜¯æ”¾å›äº†â€œå¯ç”¨å†…å­˜æ± â€(avaiable pool)ã€‚å¦‚æœåœ¨æ‰§è¡ŒNSLogæ—¶å°šæœªè¦†å†™å¯¹è±¡å†…å­˜ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡ä»ç„¶æœ‰æ•ˆã€‚</p>

<blockquote><p>ç”±æ­¤å¯è§ï¼Œå› è¿‡æ—©é‡Šæ”¾å¯¹è±¡è€Œå¯¼è‡´çš„bugå¾ˆéš¾è°ƒè¯•</p></blockquote>

<p>ä¸ºäº†é˜²æ­¢æ­¤æƒ…å†µçš„å‘é€ï¼Œä¸€èˆ¬releaseä¹‹åéƒ½ä¼šæ¸…ç©ºæŒ‡é’ˆ</p>

<pre><code>NSNumber *number = [[NSNumber alloc] initWithInt:1337];

[number release];
number = nil; 
</code></pre>

<blockquote><p>åœ¨Objective-Cä¸­ï¼Œå‘nilå‘é€æ¶ˆæ¯ä¸ä¼šå‡ºé”™ã€‚</p></blockquote>

<h2>æ€»ç»“</h2>

<ul>
<li>Objective-Cé€šè¿‡<code>å¼•ç”¨è®¡æ•°æœºåˆ¶</code>æ¥ç®¡ç†å†…å­˜</li>
<li>å¯¹è±¡åˆ›å»ºä¹‹åï¼Œå…¶å¼•ç”¨è®¡æ•°å™¨è‡³å°‘ä¸º1ï¼Œ<code>retain</code>å’Œ<code>release</code>åˆ†åˆ«ä¼šé€’å¢åŠé€’å‡è®¡æ•°å™¨</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[çˆ¬æ”¯ä»˜å®çš„å„ç§å‘]]></title>
    <link href="http://limon.top/pa-zhi-fu-bao-de-ge-chong-keng/"/>
    <updated>2015-01-07T13:57:57+08:00</updated>
    <id>http://limon.top/pa-zhi-fu-bao-de-ge-chong-keng</id>
    <content type="html"><![CDATA[<p>çˆ¬äº†å‡ å¤©å‘ï¼Œåœ¨ç¬”è€…å´©æºƒä¹‹é™…ç»ˆäºé›†æˆå¥½äº†ï¼Œåœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ç»éªŒã€‚</p>

<p>ç¬”è€…ç”¨çš„æ˜¯<code>æ”¯ä»˜å®ç§»åŠ¨æ”¯ä»˜SDKæ ‡å‡†ç‰ˆ(iOS 2.1.2)</code>ï¼Œç”³è¯·çš„æ‰‹æœºå¿«æ·æ”¯ä»˜</p>

<h2>å¯†é’¥</h2>

<p>åˆ©ç”¨æ”¯ä»˜å®ç»™çš„<code>openssl.exe</code>å·¥å…·ç”Ÿæˆä¸€å…±ä¸‰ç§å¯†é’¥ï¼Œç§é’¥ã€å…¬é’¥ï¼ŒPKCS8ç±»å‹çš„ç§é’¥</p>

<ul>
<li>å…¬é’¥ï¼šæ”¾åœ¨æ”¯ä»˜å®ä¸Šï¼Œå»æ‰é¦–å°¾çš„<code>-----BEGIN PUBLIC KEY-----``-----END PUBLIC KEY-----</code></li>
<li>PKCS8ç±»å‹çš„ç§é’¥ï¼šå¦‚æœé€‰æ‹©åœ¨æ‰‹æœºç«¯ç­¾åï¼Œæ­¤ç§é’¥æ”¾åœ¨<code>NSString *privateKey = @"PKCS8ç±»å‹çš„ç§é’¥"</code></li>
<li>ç§é’¥ï¼šæ­¤ç§é’¥å¸¦æœ‰<code>-----BEGIN RSA PRIVATE KEY-----</code> <code>-----END RSA PRIVATE KEY-----</code>ï¼Œæ˜¯ä¸“é—¨ç»™PHPç”¨çš„ï¼Œå³åœ¨æœåŠ¡å™¨ç«¯(PHP)ç­¾åï¼Œéœ€è¦ç”¨åˆ°æ­¤ç§é’¥

<blockquote><p>Noteï¼šæ¨èæœåŠ¡å™¨ç«¯ç­¾åï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPHPç«¯ç”¨çš„æ˜¯å¸¦<code>-----BEGIN RSA PRIVATE KEY-----</code> <code>-----END RSA PRIVATE KEY-----</code>çš„ç§é’¥ã€‚</p></blockquote></li>
</ul>


<h2>é›†æˆæ”¯ä»˜å®</h2>

<p>æŒ‰ç…§æ–‡æ¡£ç»™çš„æµç¨‹ç†è®ºä¸Šæƒ³è¿è¡ŒDemoæ˜¯æŒºå®¹æ˜“çš„ï¼Œéœ€è¦æ³¨æ„ï¼š</p>

<ul>
<li>Demoæ˜¯åœ¨æœ¬åœ°ç­¾çš„åï¼Œæ‰€ä»¥Demoä¸Šå¡«å†™<code>NSString *privateKey = @"PKCS8ç±»å‹çš„ç§é’¥"</code></li>
</ul>


<p>å¦‚æœè®¤ä¸ºçœ‹ä¼¼Demoè¶…ç®€å•ï¼Œä½ å°±é”™äº†ã€‚</p>

<h3>å‘ä¸€ï¼šUndefined symbols for architecture x86_64:</h3>

<p>ç¬”è€…çˆ¬è¿‡çš„å‘ï¼Œ<code>sslåº“</code>ä¸æ”¯æŒx86_64å°±æ˜¯64ä½æ¨¡æ‹Ÿå™¨ã€‚ï¼ˆè‹¥åœ¨æœåŠ¡å™¨ç«¯ç­¾åä¸éœ€å¼•å…¥sslåº“ï¼‰</p>

<blockquote><p>ç¨‹åºç•Œå…¬è®¤å¥³ç¥@å¿µèŒœç»™å‡ºçš„ç­”æ¡ˆã€‚ã€‚ã€‚</p></blockquote>

<p>ä¹Ÿå°±æ˜¯ä»¥ä¸‹è¿™ç§é”™è¯¯</p>

<p><img src="http://limons-gitimage.stor.sinaapp.com/alipay.png" alt="alipay error" /></p>

<p>é’ˆå¯¹è¿™ä¸ªé”™è¯¯ï¼Œç¬”è€…å°è¯•äº†å„ç§æ–¹æ³•ï¼ŒArchitecturesçš„å„ç§è®¾ç½®ï¼Œç”šè‡³éƒ½æ˜¯ä¸€è¡Œä¸€è¡Œå¯¹ç€Demoæ¥æ”¹çš„ï¼Œè¿˜æœ‰C++ Flageç­‰ç­‰ï¼Œæœ€ç»ˆè¿˜æ˜¯ä¸è¡Œã€‚</p>

<p>å’Œå®¢æœèŠäº†ä¸€ä¸ªå¤šå°æ—¶ï¼Œæœ€åå®¢æœæŠŠæ”¯ä»˜å®æœ€è€çš„ç‰ˆæœ¬å’Œ13å¹´çš„ç‰ˆæœ¬ç»™ç¬”è€…ã€‚ã€‚ã€‚ã€‚æŒºå¥½äººçš„ã€‚ã€‚ã€‚ã€‚</p>

<h3>å‘äºŒï¼šrsaSign()å’ŒrsaVerify()</h3>

<p>ä½œä¸ºä¸€ä¸ªæŠ€æœ¯æ¸£ï¼ŒiOSæˆ‘æ˜¯æä¸æ‚äº†ï¼Œè¿˜æ˜¯æPHPå§ã€‚ã€‚ã€‚</p>

<p>åè¡€çš„æ˜¯ï¼Œç¬”è€…ç”¨æ”¯ä»˜å®ç»™çš„PHPç‰ˆDemoï¼Œç”¨å®ƒé‡Œé¢çš„æ–¹æ³•<code>rsaSign()</code>ç­¾åï¼Œç„¶åå†ç”¨<code>rsaVerify()</code>éªŒç­¾ï¼Œç»“æœ<code>rsaVerify()</code>è¿”å›çš„ç»“æœæ°¸è¿œéƒ½æ˜¯falseï¼Œåæ¥ç¬”è€…ç»ˆäºå‡†å¤‡å‡ºå‘äº†ï¼Œé†’æ‚Ÿè¿™ä¸ª<code>rsaVerify()</code>åº”è¯¥ä¸æ˜¯éªŒè¯è¿™ç­¾åçš„ã€‚</p>

<p>åæ¥ç™¾åº¦äº†è§£äº†ç‚¹çš®æ¯›ï¼š</p>

<p>RSAéå¯¹ç§°å¯†é’¥</p>

<p>â‘  å‡è®¾Aã€Bæœºå™¨è¿›è¡Œé€šä¿¡ï¼Œå·²Aæœºå™¨ä¸ºä¸»ï¼›</p>

<p>â‘¡ Aé¦–å…ˆéœ€è¦ç”¨è‡ªå·±çš„ç§é’¥ä¸ºå‘é€è¯·æ±‚æ•°æ®ç­¾åï¼Œå¹¶å°†å…¬é’¥ä¸€åŒå‘é€ç»™Bï¼›</p>

<p>â‘¢ Bæ”¶åˆ°æ•°æ®åï¼Œéœ€è¦ç”¨Aå‘é€çš„å…¬é’¥è¿›è¡ŒéªŒè¯ï¼Œå·²ç¡®ä¿æ”¶åˆ°çš„æ•°æ®æ˜¯æœªç»ç¯¡æ”¹çš„ï¼›</p>

<p>â‘£ BéªŒç­¾é€šè¿‡åï¼Œå¤„ç†é€»è¾‘ï¼Œå¹¶æŠŠå¤„ç†ç»“æœè¿”å›ï¼Œè¿”å›æ•°æ®éœ€è¦ç”¨Aå‘é€çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå…¬é’¥åŠ å¯†åï¼Œåªèƒ½ç”¨é…å¯¹çš„ç§é’¥è§£å¯†ï¼‰ï¼›</p>

<p>â‘¤ Aæ”¶åˆ°Bè¿”å›çš„æ•°æ®ï¼Œä½¿ç”¨ç§é’¥è§£å¯†ï¼Œè‡³æ­¤ï¼Œä¸€æ¬¡æ•°æ®äº¤äº’å®Œæˆã€‚</p>

<blockquote><p><code>rsaVerify</code>ç¬”è€…çŒœæµ‹æ˜¯éªŒè¯æ”¯ä»˜å®çš„å›è°ƒçš„ã€‚æ¢å¥è¯è¯´ï¼Œç­¾åç›´æ¥å°±ç”¨<code>rsaSign()</code>å°±å¥½äº†ï¼Œå°±ä»¥ä¸‹è¿™å‡ è¡Œä»£ç </p></blockquote>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'>include('alipay_rsa.function.php');
</span><span class='line'>
</span><span class='line'>$data = $_POST['data'];
</span><span class='line'>$sign = rsaSign($data,'../key/rsa_private_key.pem');
</span><span class='line'>
</span><span class='line'>$arr = array(
</span><span class='line'>  'sign' =&gt; $sign
</span><span class='line'>);
</span><span class='line'>
</span><span class='line'>echo json_encode($arr);
</span><span class='line'>?&gt;</span></code></pre></td></tr></table></div></figure>


<p>ä»¥ä¸ºè¿™æ ·å°±çˆ¬å®Œäº†ï¼Ÿ</p>

<h3>å‘ä¸‰ï¼šurlEncoded</h3>

<p>æƒ³ç€æœåŠ¡å™¨ç›´æ¥è¿”å›<code>sign</code>ç›´æ¥å†æ‹¼æ¥ä¸€ä¸‹å°±æäº¤ç»™æ”¯ä»˜å®ï¼Œç»“æœåˆæ‰å‘é‡Œã€‚</p>

<pre><code>NSString *signedString = json[@"sign"];
NSLog(@"signedString-----%@",signedString);

NSString *orderString = [NSString stringWithFormat:@"%@&amp;sign=\"%@\"&amp;sign_type=\"%@\"",
                             orderSpec, signedString, @"RSA"];

[[AlipaySDK defaultService] payOrder:orderString fromScheme:appScheme callback:^(NSDictionary *resultDic).....
</code></pre>

<p>åˆè·‘å»å’Œå®¢æœèŠå¤©ï¼Œç¬”è€…é—®å®¢æœï¼šæœåŠ¡å™¨è¿”å›çš„<code>sign</code>åº”è¯¥è¿˜éœ€è¦<code>urlEncoded</code>å¯¹å§ï¼Œå®¢æœå›æˆ‘è¯´ï¼šä¸ç”¨å•Šï¼ŒæœåŠ¡å™¨å·²ç»å¼„äº†å•Šã€‚</p>

<pre><code>/**
* RSAç­¾å
* @param $data å¾…ç­¾åæ•°æ®
* @param $private_key_path å•†æˆ·ç§é’¥æ–‡ä»¶è·¯å¾„
* return ç­¾åç»“æœ
*/
function rsaSign($data, $private_key_path) {
    $priKey = file_get_contents($private_key_path);
    $res = openssl_pkey_get_private($priKey);
    openssl_sign($data, $sign, $res);
    openssl_free_key($res);
    //base64ç¼–ç 
    $sign = base64_encode($sign);
    return $sign;
}
</code></pre>

<p>å®¢æœè¯´<code>base64_encode($sign)</code>å®Œå°±å¯ä»¥äº†ä¸éœ€è¦<code>urlEncoded</code>ã€‚ç¬”è€…æœæ–­è¿˜æ˜¯ä¸ç›¸ä¿¡å®¢æœã€‚</p>

<pre><code>NSString *signedString = json[@"sign"];
NSLog(@"signedString-----%@",signedString);

// æ·±å‘å•Š......    
signedString = [self urlEncodedString:signedString];

NSString *orderString = [NSString stringWithFormat:@"%@&amp;sign=\"%@\"&amp;sign_type=\"%@\"",
                             orderSpec, signedString, @"RSA"];

[[AlipaySDK defaultService] payOrder:orderString fromScheme:appScheme callback:^(NSDictionary *resultDic)....
</code></pre>

<p>éœ€è¦åœ¨<code>RSADataSigner.m</code>ä¸­æŠ½ç¦»<code>-urlEncodedString</code>æ–¹æ³•å‡ºæ¥ã€‚ã€‚ã€‚å‘å•Šï¼Œæ˜æ˜éƒ½ä¸éœ€è¦æ‰‹æœºç«¯ç­¾åäº†ï¼Œå½“ç„¶ä¸ä¼šå»çœ‹æ‰‹æœºç«¯ç­¾åçš„å…·ä½“æµç¨‹å•¦ã€‚åˆæ²¡çœ‹åˆ°å“ªé‡Œè¯´æ˜æœåŠ¡å™¨ç«¯è¿”å›çš„<code>sign</code>éœ€è¦<code>urlEncoded</code>ï¼Œè¿å®¢æœéƒ½ä¸çŸ¥é“éœ€è¦<code>urlEncoded</code>&hellip;..</p>

<h3>å¿ƒå¡ï¼Œä¸è¯´äº†&hellip;&hellip;.</h3>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Reading record]]></title>
    <link href="http://limon.top/reading-record/"/>
    <updated>2015-01-02T10:16:07+08:00</updated>
    <id>http://limon.top/reading-record</id>
    <content type="html"><![CDATA[<h2>Ask and Answer</h2>

<p><a href="http://stackoverflow.com/questions/24788283/ios-animate-morph-shape-from-circle-to-square">åœ†å½¢å’Œæ­£æ–¹å½¢ä¹‹é—´çš„åŠ¨ç”»</a></p>

<p><a href="http://codingobjc.com/blog/2014/10/15/shi-yong-autolayoutshi-xian-uitableviewde-celldong-tai-bu-ju-he-ke-bian-xing-gao/">ä½¿ç”¨Autolayoutå®ç°UITableViewçš„CellåŠ¨æ€å¸ƒå±€å’Œé«˜åº¦åŠ¨æ€æ”¹å˜</a></p>

<p><a href="http://stackoverflow.com/questions/20320591/uitableview-and-presentviewcontroller-takes-2-clicks-to-display">UITableViewç‚¹å‡»ä¸¤æ¬¡æ‰èƒ½Present</a></p>

<p><a href="http://www.it165.net/pro/html/201503/36130.html">iOSæ¨é€è·å–ä¸åˆ°è®¾å¤‡tokenï¼šæœªæ‰¾åˆ°åº”ç”¨ç¨‹åºçš„apsenvironmentçš„æƒåˆ©å­—ç¬¦ä¸²</a></p>

<p><a href="http://stackoverflow.com/questions/35023904/is-there-way-to-define-compare-function-automatically-for-struct-in-swi">å‡è®¾æœ‰ä¸€ä¸ªå·¨å¤§ï¼ˆåŒ…å«å¾ˆå¤šå±æ€§çš„ï¼‰çš„ç»“æ„ä½“ï¼Œç„¶åå®ç° â€œ==â€ æ“ä½œå°±ä¼šå¾ˆéº»çƒ¦ï¼Œå› ä¸ºè¦æ¯ä¸ªå±æ€§éƒ½æ¯”è¾ƒä¸€éæ‰è¡Œ</a> &mdash; ğŸ‘ğŸ‘ğŸ‘</p>

<h2>åŒ…ç½—ä¸‡è±¡</h2>

<p><a href="https://realm.io/cn/news/jack-nutting-search-api-ios/">iOS ç³»ç»Ÿæœç´¢é›†æˆ</a> &mdash; Realm</p>

<p><a href="http://www.devtalking.com/articles/ios-design-pattern-in-swift-1/">Swift ä¸­çš„iOSè®¾è®¡æ¨¡å¼ï¼ˆä¸€ï¼‰</a></p>

<p><a href="http://swiftist.org/topics/165">Swift ç¼–ç¨‹é£æ ¼æŒ‡å—</a></p>

<p><a href="http://nshipster.com/new-years-2016">Reader Submissions - New Year&rsquo;s 2016</a> &mdash; å¹²è´§å¤š ğŸº</p>

<p><a href="http://stackoverflow.com/questions/24183812/swift-warning-equivalent">Showing TODO as a warning in a Swift Xcode project</a> &mdash; ä»¥âš ï¸çš„å½¢å¼æ˜¾ç¤ºTODOã€FIXME</p>

<p><a href="http://mikebuss.com/2014/06/22/lazy-initialization-swift/">Lazy Initialization with Swift</a></p>

<p><a href="https://github.com/callmewhy/Swift90Days/blob/master/Day11-initialization.md">Swift90Days - è›‹ç–¼çš„åˆå§‹åŒ–è¿‡ç¨‹</a></p>

<p><a href="http://nomothetis.svbtle.com/error-handling-in-swift">Error Handling in Swift: Might and Magic</a></p>

<p><a href="http://natashatherobot.com/swift-guard-better-than-if/">Swift 2.0: Why Guard is Better than If</a></p>

<p><a href="https://github.com/100mango/zen/blob/master/2015%20WWDC%20%E6%80%BB%E7%BB%93/2015%20WWDC%20Best%20Practices.md">2015 WWDC Best Practices</a></p>

<p><a href="http://swifter.tips/lazy/">LAZY ä¿®é¥°ç¬¦å’Œ LAZY æ–¹æ³•</a></p>

<p><a href="http://oleb.net/blog/2015/12/lazy-properties-in-structs-swift/">Lazy Properties in Structs</a></p>

<p><a href="http://www.obqo.de/blog/2015/11/25/true-lazy-sequences/">True Lazy Sequences</a></p>

<p><a href="http://swift.gg/2015/09/25/ask-erica-how-do-i-loop-from-non-zero-n-swiftlang/">Swift 2.0 æ•°ç»„éå†</a></p>

<p><a href="http://www.mokacoding.com/blog/demistifying-swift-functor/">Swift Optionals, Functional Programming, and You</a> &mdash; å‡½æ•°å¼ç¼–ç¨‹</p>

<p><a href="http://www.cocoachina.com/ios/20150916/13324.html">ç”¨åŒä¸€ä¸ªå·¥ç¨‹åˆ›å»ºä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„åº”ç”¨</a> &mdash; å¦‚æœåŒä¸€ä¸ªåº”ç”¨, éœ€è¦åšä¸€ä¸ªå¸¦å¹¿å‘ŠLiteç‰ˆæœ¬, ä¸€ä¸ªä¸å¸¦å¹¿å‘Šçš„Proç‰ˆæœ¬. é‚£ä¹ˆé—®é¢˜æ¥äº†, è¯¥å¦‚ä½•ä¼˜é›…çš„å»å®ç°å‘¢ï¼Ÿ</p>

<p><a href="https://pspdfkit.com/blog/2015/presentation-controllers/">Presentation Controllers and Adaptive Presentations</a> &mdash; ğŸ‘</p>

<p><a href="https://www.omnigroup.com/developer/how-to-make-text-in-a-uivisualeffectview-readable-on-any-background">å¦‚ä½•è®© UIVisualEffectView ä¸Šé¢æ˜¾ç¤ºå¯è¯»çš„æ–‡å­—</a></p>

<p><a href="http://www.zoomfeng.com/blog/coretextshi-yong-jiao-cheng-%5B%3F%5D.html">CoreTextä½¿ç”¨æ•™ç¨‹</a> &mdash; äº”ç¯‡</p>

<p><a href="http://www.codeceo.com/article/https-worker.html">ç†è§£ HTTPS çš„å·¥ä½œåŸç†</a></p>

<p><a href="http://swift.gg/2016/01/07/app-thinning-appcoda/">å¦‚ä½•ä½¿ç”¨ iOS 9 App ç˜¦èº«åŠŸèƒ½</a></p>

<p><a href="http://blog.sunnyxx.com/2014/12/20/64-bit-tips/">64-bit Tips</a></p>

<p><a href="http://blog.sunnyxx.com/2014/10/15/behind-autorelease/">é»‘å¹•èƒŒåçš„Autorelease</a></p>

<p><a href="http://mobile.51cto.com/iphone-284112.htm">Objective-Cå†…å­˜ç®¡ç†å¦‚ä½•ç†è§£Autorelease</a></p>

<p><a href="http://cocoa.venj.me/blog/view-controller-based-status-bar-style-and-uinavigationcontroller/#comment-1501032470">UINavigationControllerå’ŒView Controller-basedçŠ¶æ€æ é£æ ¼</a> &mdash;&mdash; æŒ‡å®šçŠ¶æ€æ é£æ ¼</p>

<p><a href="http://gracelancy.com/blog/2014/05/05/variable-argument-lists/">Variable Argument Lists</a> &mdash;&mdash; å¯å˜å‚æ•°å‡½æ•°çš„å®šä¹‰</p>

<p><a href="http://www.imooc.com/wenda/detail/244497">100ä¸ªiOSå¼€å‘/è®¾è®¡é¢è¯•é¢˜æ±‡æ€»</a></p>

<p><a href="http://codingobjc.com/blog/2014/10/15/shi-yong-autolayoutshi-xian-uitableviewde-celldong-tai-bu-ju-he-ke-bian-xing-gao/">ä½¿ç”¨Autolayoutå®ç°UITableViewçš„CellåŠ¨æ€å¸ƒå±€å’Œé«˜åº¦åŠ¨æ€æ”¹å˜</a></p>

<p><a href="http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html">å¸¸ç”¨ Git å‘½ä»¤æ¸…å•</a></p>

<p><a href="http://flexmonkey.blogspot.co.nz/2015/12/scribe-handwriting-recognition.html"> æ‰‹å†™è¯†åˆ«ç»„å»º A Handwriting Recognition Component for iOS </a></p>

<p><a href="http://www.jianshu.com/p/98610bdc9bd6"> åŠ å¯†è§£å¯†ä»‹ç» </a></p>

<p><a href="http://tanqisen.github.io/blog/2014/06/06/how-to-prevent-app-crack/">å¦‚ä½•é˜²æ­¢å®¢æˆ·ç«¯è¢«ç ´è§£</a></p>

<p><a href="http://tech.glowing.com/cn/change-uinavigationbar-backgroundcolor-dynamically/">åŠ¨æ€ä¿®æ”¹UINavigationBarçš„èƒŒæ™¯è‰²</a></p>

<p><a href="http://www.jianshu.com/p/4af3b8179136">iOSå¼€å‘ä¸­ç”¨æˆ·å¯†ç åº”è¯¥ä¿å­˜åœ¨å“ªé‡Œ</a></p>

<p><a href="http://oncenote.com/2015/06/01/How-App-Launch/">ç”± App çš„å¯åŠ¨è¯´èµ·</a> &mdash; ğŸ‘</p>

<p><a href="https://medium.com/@pcperini/a-protocol-oriented-state-machine-for-layout-constraints-2c6c94bbd844#.g92o77vfm">State Machine for Layout Constraints</a> &mdash; é€šè¿‡åè®®å®ç° Layout çš„çŠ¶æ€æœº ğŸ‘ğŸ‘ğŸ‘</p>

<p><a href="http://alisoftware.github.io/swift/async/error/2016/02/06/async-errors/">Asynchronous error handling</a></p>

<h5>Enum</h5>

<p><a href="http://swift.gg/2015/11/20/advanced-practical-enum-examples/">Swift ä¸­æšä¸¾é«˜çº§ç”¨æ³•åŠå®è·µ</a></p>

<p><a href="http://ericasadun.com/2015/10/19/sets-vs-dictionaries-smackdown-in-swiftlang/?utm_campaign=Swift%252BSandbox&amp;utm_medium=email&amp;utm_source=Swift_Sandbox_12">ç”¨æšä¸¾ä½œ Options</a></p>

<p><a href="http://swift.gg/2015/11/20/advanced-practical-enum-examples/#API_%E7%AB%AF%E7%82%B9">ç”¨æšä¸¾ä½œ Rest API</a></p>

<h5>Protocol</h5>

<p><a href="http://natashatherobot.com/protocol-oriented-segue-identifiers-swift/">Protocol-Oriented Segue Identifiers in Swift</a></p>

<p><a href="http://swift.gg/2015/12/15/mixins-over-inheritance/">Mixins æ¯”ç»§æ‰¿æ›´å¥½</a> &mdash; é¢å‘åè®®ç¼–ç¨‹</p>

<h4>ç¿»è¯‘</h4>

<p><a href="http://wdxtub.com/2015/12/22/programming-ios9-translation-1/">Programming iOS9 ç¿»è¯‘</a></p>

<h2>ä¼˜åŒ–</h2>

<p><a href="http://pingguohe.net/2016/01/31/lazyscroll.html?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io">iOS é«˜æ€§èƒ½å¼‚æ„æ»šåŠ¨è§†å›¾æ„å»ºæ–¹æ¡ˆ â€”â€” LazyScrollView</a></p>

<p><a href="http://irace.me/swift-profiling/?utm_campaign=iOS%2BDev%2BWeekly&amp;utm_medium=email&amp;utm_source=iOS_Dev_Weekly_Issue_234">Profiling your Swift compilation times</a> &mdash; æŸ¥çœ‹ Swift æ–‡ä»¶ç¼–è¯‘çš„æ—¶é—´ ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘</p>

<p><a href="http://mp.weixin.qq.com/s?__biz=MjM5NTIyNTUyMQ==&amp;mid=444322139&amp;idx=1&amp;sn=c7bef4d439f46ee539aa76d612023d43&amp;scene=0#wechat_redirect">çŒ¿é¢˜åº“ iOS å®¢æˆ·ç«¯æ¶æ„è®¾è®¡</a> &mdash; MVVM without Binding with DataController</p>

<p><a href="http://blog.vars.me/blog/2015/04/26/UICollectionView-Optimizing/">UICollectionViewçš„æ•°æ®é¢„åŠ è½½åŠå›¾ç‰‡åŠ è½½é€»è¾‘çš„ä¼˜åŒ–</a></p>

<p><a href="https://github.com/100mango/zen/blob/master/WWDC%E5%BF%83%E5%BE%97%EF%BC%9AAdvanced%20Graphics%20and%20Animations%20for%20iOS%20Apps/Advanced%20Graphics%20and%20Animations%20for%20iOS%20Apps.md">iOSå›¾å½¢æ€§èƒ½è¿›é˜¶ä¸æµ‹è¯•</a></p>

<p><a href="http://blog.cnbang.net/tech/2578/">iOSå›¾ç‰‡åŠ è½½é€Ÿåº¦æé™ä¼˜åŒ–â€”FastImageCacheè§£æ</a></p>

<p><a href="http://blog.cnbang.net/tech/2544/">iOSå¯æ‰§è¡Œæ–‡ä»¶ç˜¦èº«æ–¹æ³•</a></p>

<p><a href="http://www.jianshu.com/p/0d972f45da86?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_author_hots&amp;utm_source=recommendation">iOSç”Ÿäº§åŠ›ä¹‹å°å·¥å…·åˆé›†</a>
<a href="http://www.jianshu.com/p/9e1f0b44935c">iOSæ€§èƒ½ä¼˜åŒ–</a></p>

<p><a href="http://ios.jobbole.com/83058/">10ä¸ªåŠ é€ŸTable Viewså¼€å‘çš„å»ºè®®</a></p>

<p><a href="http://www.ibm.com/developerworks/cn/mobile/mo-ios-memory/">ä½¿ç”¨ Swift å’Œ Objective-C æ‰§è¡Œ iOS å†…å­˜ç®¡ç†çš„ 7 ä¸ªç®€å•æŠ€å·§</a></p>

<p><a href="http://southpeak.github.io/blog/2015/12/20/perfect-smooth-scrolling-in-uitableviews/">Perfect smooth scrolling in UITableViews</a></p>

<p><a href="http://holko.pl/2016/01/05/typed-table-view-controller/">Typed, yet Flexible Table View Controller</a> &mdash; TableViewController ä»£ç é‡æ„</p>

<h3>ç¼“å­˜</h3>

<p><a href="http://www.jianshu.com/p/8a4dc775c051">(æ…•è¯¾ç½‘)imooc iPhone3.3 æ¥å£æ•°æ®ç¼“å­˜</a> &mdash; ğŸ‘ğŸ‘ğŸ‘</p>

<p><a href="https://github.com/ChenYilong/ParseSourceCodeStudy/blob/master/02_Parse%E7%9A%84%E7%BD%91%E7%BB%9C%E7%BC%93%E5%AD%98%E4%B8%8E%E7%A6%BB%E7%BA%BF%E5%AD%98%E5%82%A8/iOS%E7%BD%91%E7%BB%9C%E7%BC%93%E5%AD%98%E6%89%AB%E7%9B%B2%E7%AF%87.md">ä½¿ç”¨ä¸¤è¡Œä»£ç å°±èƒ½å®Œæˆ80%çš„ç¼“å­˜éœ€æ±‚</a> &mdash; ğŸ‘ğŸ‘ğŸ‘</p>

<h2>åº•å±‚</h2>

<p><a href="https://mp.weixin.qq.com/s?__biz=MzAwNDY1ODY2OQ==&amp;mid=400417748&amp;idx=1&amp;sn=0c5f6747dd192c5a0eea32bb4650c160&amp;scene=1&amp;srcid=1119iAGp9HUSGEMTBjUSM7L0&amp;key=d72a47206eca0ea9f5fd845c39ebee1715577b3db18f002c19b3747d6f2525f50d9ef530d825ee227e428e6dc5bd58a3&amp;ascene=0&amp;uin=MjY5MzMxNTMwMQ%3D%3D">iOS äº‹ä»¶å¤„ç†æœºåˆ¶ä¸å›¾åƒæ¸²æŸ“è¿‡ç¨‹</a></p>

<p><a href="http://swift.gg/2015/12/28/friday-qa-2015-12-11-swift-weak-references/">Swift ä¸­çš„å¼±å¼•ç”¨</a> &mdash; ğŸ‘ğŸ‘ğŸ‘</p>

<h2>å†…å­˜ç®¡ç†</h2>

<p><a href="http://www.oschina.net/translate/automatic-reference-counting-on-ios">iOSå¼€å‘ä¹‹ARC</a></p>

<p><a href="http://onevcat.com/2012/06/arc-hand-by-hand/">æ‰‹æŠŠæ‰‹æ•™ä½ ARCâ€”â€”iOS/Macå¼€å‘ARCå…¥é—¨å’Œä½¿ç”¨</a></p>

<p><a href="http://blog.csdn.net/nicktang/article/details/6792972">IOS 5ç¼–ç¨‹ å†…å­˜ç®¡ç† ARCæŠ€æœ¯æ¦‚è¿°</a></p>

<p><a href="http://www.yifeiyang.net/development-of-the-iphone-simply-1/">iPhoneå¼€å‘ä¹‹æ·±å…¥æµ…å‡º (1) â€” ARCæ˜¯ä»€ä¹ˆ</a></p>

<h2>çº¿ç¨‹</h2>

<p><a href="http://blog.cnbluebox.com/blog/2014/07/01/cocoashen-ru-xue-xi-nsoperationqueuehe-nsoperationyuan-li-he-shi-yong/">Cocoaæ·±å…¥å­¦ä¹ :NSOperationQueueã€NSRunLoopå’Œçº¿ç¨‹å®‰å…¨</a></p>

<p><a href="http://www.cnblogs.com/kenshincui/p/3983982.html">iOSå¼€å‘ç³»åˆ—&ndash;å¹¶è¡Œå¼€å‘å…¶å®å¾ˆå®¹æ˜“</a></p>

<p><a href="http://ksnowlv.github.io/blog/2014/09/07/ios-tong-bu-suo-xing-neng-dui-bi/">iOSåŒæ­¥å¯¹è±¡æ€§èƒ½å¯¹æ¯”</a></p>

<h2>å·¥å…·</h2>

<p><a href="http://www.bmob.cn">Bmobç§»åŠ¨åç«¯äº‘æœåŠ¡å¹³å°</a></p>

<p><a href="https://leancloud.cn/docs/rest_api.html">å’Œåº”ç”¨æœåŠ¡å™¨ã€å­˜å‚¨æœåŠ¡å™¨è¯´å†è§</a></p>

<h2>æ’ä»¶</h2>

<p><a href="https://github.com/wangshengjia/VWInstantRun">VWInstantRun</a> &mdash; ç›´æ¥åœ¨Xcodeä¸­ç¼–è¯‘æ‰§è¡Œé€‰ä¸­çš„Swiftä»£ç ï¼Œæ‰“å°è¾“å‡ºåˆ°console  ğŸ‘</p>

<h2>CoreData</h2>

<p><a href="http://www.jianshu.com/p/5a84008307ad">Core Data: éæ ‡å‡†æ•°æ®ç±»å‹æ€»ç»“</a></p>

<h2>CocoaPods</h2>

<p><a href="http://blog.devtang.com/blog/2014/05/25/use-cocoapod-to-manage-ios-lib-dependency/">ç”¨CocoaPodsåšiOSç¨‹åºçš„ä¾èµ–ç®¡ç†</a></p>

<p><a href="http://gracelancy.com/blog/2013/08/11/make-your-own-cocoapods-spec/">åˆ¶ä½œè‡ªå·±çš„CocoaPods Spec</a></p>

<p><a href="http://www.iwangke.me/2013/04/18/advanced-cocoapods/">CocoaPodsè¿›é˜¶ï¼šæœ¬åœ°åŒ…ç®¡ç†</a></p>

<p><a href="http://lexrus.com/setup-a-mirror-of-cocoapods-specs.html">Setup a mirror of CocoaPods/Specs</a></p>

<p><a href="http://blog.csdn.net/agdsdl/article/details/45218987#0-tsina-1-51027-397232819ff9a47a7b7e80a40613cfe1">CocoaPodså»ºç«‹ç§æœ‰ä»“åº“</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ReactiveCocoa]]></title>
    <link href="http://limon.top/reactivecocoa/"/>
    <updated>2014-09-03T17:44:25+08:00</updated>
    <id>http://limon.top/reactivecocoa</id>
    <content type="html"><![CDATA[<h1>ReactiveCocoa</h1>

<h2>RACSignal</h2>

<h3>è®¢é˜…RACSignal</h3>

<p>1.RACSignal (Subscription)
RACSignal (Subscription)ç±»åˆ«å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„è®¢é˜…äº‹ä»¶çš„æ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½ä¼šå°†ç±»å‹ä¸º(void (^)(id x))çš„blockä½œä¸ºå‚æ•°ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶blockä¸­çš„ä»£ç ä¼šæ‰§è¡Œï¼Œä¾‹å¦‚-subscribeNext:æ–¹æ³•ä¼šä¼ å…¥ä¸€ä¸ªblockä½œä¸ºå‚æ•°ï¼Œå½“Signalçš„nextäº‹ä»¶å‘å‡ºåï¼Œblockä¼šæ¥æ”¶åˆ°äº‹ä»¶å¹¶æ‰§è¡Œã€‚</p>

<p>2.UIKit Category
RACä¸ºUIKitæ·»åŠ äº†å¾ˆå¤šç±»åˆ«æ¥è®©æˆ‘ä»¬å¯ä»¥è®¢é˜…UIç»„ä»¶çš„äº‹ä»¶ï¼Œæ¯”å¦‚UITextField (RACSignalSupport)ä¸­çš„rac_textSignalä¼šåœ¨æ–‡æœ¬åŸŸå†…å®¹å˜åŒ–æ—¶å‘å‡ºnextäº‹ä»¶ã€‚
äº‹ä»¶åŒ…å«çš„å†…å®¹å¯ä»¥æ˜¯ç±»å‹ï¼Œåªè¦æ˜¯å¯¹è±¡å°±è¡Œï¼Œå¦‚æœæ˜¯ä¸€äº›æ•°å­—ï¼Œå¸ƒå°”å€¼ç­‰å­—é¢é‡ï¼Œå¯ä»¥ç”¨@()è¯­æ³•è£…ç®±æˆNSNumberã€‚</p>

<h3>æ“çºµSignal</h3>

<h5>1.RACStream (Operations)</h5>

<p><code>-filter</code>:uses a block to test each value. Returns a new stream with only those values that passed.</p>

<pre><code>- (instancetype)filter:(BOOL (^)(id value))block;
    RACSequence *numbers = [@"1 2 3 4 5 6 7 8 9" componentsSeparatedByString:@"     "].rac_sequence;

// Contains: 2 4 6 8
RACSequence *filtered = [numbers filter:^ BOOL (NSString *value) {
    return (value.intValue % 2) == 0;
}];
</code></pre>

<p><code>-map</code>:Maps block across in the receiver , and transform the values. Returns a new stream with the mapped values.</p>

<pre><code>- (instancetype)map:(id (^)(id value))block;
    RACSequence *letters = [@"A B C D E F G H I" componentsSeparatedByString:@"     "].rac_sequence;

// Contains: AA BB CC DD EE FF GG HH II
RACSequence *mapped = [letters map:^(NSString *value) {
    return [value stringByAppendingString:value];
}];
</code></pre>

<p><code>-flattenMap</code>:Maps block across the values in the receiver and flattens the result. It is used to signal of signal.ç®€å•ç†è§£ä¸ºï¼šå–å‡ºå†…éƒ¨çš„Signal.</p>

<pre><code>[[[self.signInButton
    rac_signalForControlEvents:UIControlEventTouchUpInside]
        map:^id(id x) {
            return [self signInSignal]; // æ­¤signalå†…å«ä¸€ä¸ªBOOL signal
    }]
    subscribeNext:^(id x) {
        NSLog(@"Sign in result: %@", x);
}];
</code></pre>

<p>æ‰“å°å‡ºæ¥çš„ä¸æ˜¯BOOLï¼Œ<code>-subscribeNex</code>t: will execute the block whenever the signal sends a value. ä½†è¿™valueä¸åŒ…æ‹¬ signal of signalsï¼šan outer signal that contains an inner signal.</p>

<pre><code>2014-01-08 21:00:25.919 RWReactivePlayground[33818:a0b] Sign in result: 
                        &lt;RACDynamicSignal: 0xa068a00&gt; name:+createSignal:
</code></pre>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>[[[self.signInButton
</span><span class='line'>   rac_signalForControlEvents:UIControlEventTouchUpInside]
</span><span class='line'>   flattenMap:^id(id x) { // subscribe to the inner signal within the outer signalâ€™s
</span><span class='line'>     return [self signInSignal];
</span><span class='line'>   }]
</span><span class='line'>   // Output: Sign in result: 0
</span><span class='line'>   subscribeNext:^(id x) {
</span><span class='line'>     NSLog(@"Sign in result: %@", x);
</span><span class='line'>   }];</span></code></pre></td></tr></table></div></figure>


<h4>2.RACSignal (Operations)</h4>

<h2>RACObserve</h2>

<pre><code>// When self.username changes, logs the new name to the console.
//
// RACObserve(self, username) creates a new RACSignal that sends the current
// value of self.username, then the new value whenever it changes.
// -subscribeNext: will execute the block whenever the signal sends a value.
[RACObserve(self, username) subscribeNext:^(NSString *newName) {
    NSLog(@"%@", newName);
}];
</code></pre>

<h4>è¿‡æ»¤signal</h4>

<pre><code>// Only logs names that starts with "j".
//
// -filter returns a new RACSignal that only sends a new value when its block
// returns YES.
[[RACObserve(self, username)
    filter:^(NSString *newName) {
        return [newName hasPrefix:@"j"];
    }]
    subscribeNext:^(NSString *newName) {
        NSLog(@"%@", newName);
}];
</code></pre>

<h2>Chip</h2>

<p><code>distinctUntilChanged</code>ï¼šReturns a stream of values for which -isEqual: returns NO when compared to the previous value.
ç”¨æ¥ç¡®ä¿signalåªä¼šå‘é€ä¸åŒçš„å€¼,æ¯”è¾ƒæ•°å€¼æµä¸­å½“å‰å€¼å’Œä¸Šä¸€ä¸ªå€¼ï¼Œå¦‚æœä¸åŒï¼Œå°±è¿”å›å½“å‰å€¼ï¼Œç®€å•ç†è§£,å®ƒå°†è¿™ä¸€æ¬¡çš„å€¼ä¸ä¸Šä¸€æ¬¡åšæ¯”è¾ƒï¼Œå½“ç›¸åŒæ—¶ï¼ˆä¹ŸåŒ…æ‹¬- isEqual:ï¼‰è¢«å¿½ç•¥æ‰ã€‚</p>

<pre><code>RACSignal *validSearchSignal =
[[RACObserve(self, searchText)
  map:^id(NSString *text) {
     return @(text.length &gt; 3);
  }]
  distinctUntilChanged]; // ensure this signal only emits values when the state changes.

[validSearchSignal subscribeNext:^(id x) {
    NSLog(@"search text is valid %@", x);
}];

self.executeSearch =
[[RACCommand alloc] initWithEnabled:validSearchSignal // validSearchSignalå†³å®šbuttonèƒ½ä¸èƒ½ç‚¹å‡»
  signalBlock:^RACSignal *(id input) {
    return  [self executeSearchSignal];
  }];
</code></pre>

<p>ä¾‹å­äºŒï¼šæ¯”å¦‚UIä¸Šä¸€ä¸ªLabelç»‘å®šäº†ä¸€ä¸ªå€¼ï¼Œæ ¹æ®å€¼æ›´æ–°æ˜¾ç¤ºçš„å†…å®¹:</p>

<pre><code>RAC(self.label, text) = [RACObserve(self.user, username) distinctUntilChanged];
self.user.username = @"sunnyxx"; // 1st
self.user.username = @"sunnyxx"; // 2nd
self.user.username = @"sunnyxx"; // 3rd 
</code></pre>

<p>æ‰€ä»¥ï¼Œå¯¹äºç›¸åŒå€¼å¯ä»¥å¿½ç•¥çš„æƒ…å†µï¼Œæœæ–­åŠ ä¸Šå®ƒå§ã€‚</p>

<p><code>-takeUntilBlock</code>ï¼šå¯¹äºæ¯ä¸ªnextå€¼ï¼Œè¿è¡Œblockï¼Œå½“blockè¿”å›YESæ—¶åœæ­¢å–å€¼ï¼Œå¦‚ï¼š</p>

<pre><code>[[self.inputTextField.rac_textSignal takeUntilBlock:^BOOL(NSString *value) {
    return [value isEqualToString:@"stop"];
}] subscribeNext:^(NSString *value) {
    NSLog(@"current value is not `stop`: %@", value);
}];
</code></pre>

<blockquote><p>Noteï¼šåœæ­¢å–å€¼çš„æ„æ€æ˜¯ï¼Œè¾“å…¥stopä¹‹åï¼Œæ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½ä¸ä¼šå†å–å€¼ï¼Œå³è¾“å…¥stopä¹‹åï¼Œä¸ä¼šå†æœ‰ä»»ä½•è¾“å‡ºã€‚
è¿˜æœ‰ä¸€ä¸ªä¾‹å­ï¼š</p></blockquote>

<pre><code>- (RACSignal*) rac_RequestStateSignal
{
    return [[RACObserve(self, state)
        takeUntilBlock:^ BOOL (NSNumber *state){
            return [state intValue] == iRequestStateComplete;
        }]
        flattenMap:^(NSNumber *state){
            if ([state intValue] == iRequestStateErrored)
            { 
                // Create a meaningful NSError here if you can.
                return [RACSignal error:nil];
            }
            else
            { 
                return [RACSignal return:state];
            }
        }];
}
</code></pre>

<p><code>-switchToLatest</code>æ–¹æ³•ç”¨äºsignal-of-signalsï¼Œå®ƒæ€»æ˜¯è¾“å‡ºæœ€æ–°çš„ä¿¡å·çš„å€¼ã€‚</p>

<pre><code>RACSubject *letters = [RACSubject subject];
RACSubject *numbers = [RACSubject subject];
RACSubject *signalOfSignals = [RACSubject subject];

RACSignal *switched = [signalOfSignals switchToLatest];

// Outputs: A B 1 D
[switched subscribeNext:^(NSString *x) {
    NSLog(@"%@", x);
}];

[signalOfSignals sendNext:letters]; // æ‰“å°lettersä¿¡å·å†…çš„å€¼
[letters sendNext:@"A"];
[letters sendNext:@"B"];

[signalOfSignals sendNext:numbers]; // æ‰“å°numbersä¿¡å·å†…çš„å€¼
[letters sendNext:@"C"];
[numbers sendNext:@"1"];

[signalOfSignals sendNext:letters]; // æ‰“å°lettersä¿¡å·å†…çš„å€¼
[numbers sendNext:@"2"];
[letters sendNext:@"D"];
</code></pre>

<p><code>-rac_signalForSelector:fromProtocol:</code></p>

<p>è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯æŠŠ protocal è½¬ä¸ºä¸€ä¸ª Signal ä¾¿äºä½¿ç”¨ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª RACTupleã€‚ è¿™ä¸ª RACTuple åŒ…å«äº† Selector æ–¹æ³•é‡Œé¢æ‰€æœ‰çš„å‚æ•°</p>

<p><code>-rac_liftSelector:withSignalsFromArray:</code>
è¿™ä¸ªæ–¹æ³•å®ƒçš„æ„æ€æ˜¯å½“ä¼ å…¥çš„ Signals éƒ½è‡³å°‘sendNextè¿‡ä¸€æ¬¡ï¼Œæ¥ä¸‹æ¥åªè¦å…¶ä¸­ä»»æ„ä¸€ä¸ªsignalæœ‰äº†æ–°çš„å†…å®¹ã€‚å°±ä¼šå»è§¦å‘ç¬¬ä¸€ä¸ª selector å‚æ•°çš„æ–¹æ³•ã€‚</p>

<blockquote><p><a href="http://iiiyu.com/2014/12/26/learning-ios-notes-thirty-six/">ReactiveCocoa ç”¨ RACSignal æ›¿ä»£ Delegate</a></p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ReactiveCocoaçš„ä¸‰ç§åŸºæœ¬çš„æ¨¡å¼]]></title>
    <link href="http://limon.top/reactivecocoa/"/>
    <updated>2014-06-10T09:35:03+08:00</updated>
    <id>http://limon.top/reactivecocoa</id>
    <content type="html"><![CDATA[<h1>ReactiveCocoa</h1>

<hr />

<h3>ä¸‰ç§åŸºæœ¬çš„æ¨¡å¼</h3>

<p>åœ¨ReactiveCocoaä¸­æœ‰ä¸‰ç§åŸºæœ¬çš„æ¨¡å¼ï¼šè´£ä»»é“¾ã€åˆ†å‰²å’Œç»„åˆæ¨¡å¼ï¼ˆchaining, splitting, and combiningï¼‰ã€‚</p>

<h4>ä¸€ã€ Chainingæ¨¡å¼</h4>

<p>Chainingï¼Œå°†ä¸€ä¸ªå·²æœ‰çš„signalè½¬æ¢ä¸ºä¸€ä¸ªæ–°çš„signalã€‚å¸¸ç”¨çš„æ“ä½œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„signalï¼Œå†å¯¹å®ƒä½¿ç”¨filter:ã€map:æˆ–startWith:ç­‰æ–¹æ³•ã€‚</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>RAC(self.textField.text) = [[[RACSignal interval:1] startWith:[NSDate date]] map:^id(NSDate *value) {  
</span><span class='line'>    NSDateComponents *dateComponents = [[NSCalendar currentCalendar] components:NSMinuteCalendarUnit | NSSecondCalendarUnit fromDate:value];  
</span><span class='line'>      
</span><span class='line'>    return [NSString stringWithFormat:@"%d:%02d", dateComponents.minute, dateComponents.second];  
</span><span class='line'>}]; 
</span></code></pre></td></tr></table></div></figure>


<p>æˆ‘ä»¬å°†textFiledçš„textå±æ€§ç»‘å®šä¸ºä¸‰ä¸ªä¸²è¿çš„signalsçš„ç»“æœã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé—´éš”ä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·æ¯éš”ä¸€ç§’é’Ÿå°±å‘é€å½“å‰æ—¶é—´ã€‚é—´éš”ä¿¡å·åœ¨æ²¡æœ‰å¯åŠ¨çš„æ—¶å€™æ˜¯ä¸ä¼šæœ‰å€¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨startWith:å¯åŠ¨èµ·æ¥ã€‚æœ€åï¼Œä½¿ç”¨map:å°†signalçš„NSDateå€¼è½¬æ¢ä¸ºä¸€ä¸ªNSStringå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°†ä¼šè¢«èµ‹å€¼åˆ°textFieldçš„textå±æ€§ä¸Šã€‚
<img src="http://teehanlax.com.s3.amazonaws.com/wordpress/wp-content/uploads/chaining.png" alt="Chaining" /></p>

<p> Chainingæ˜¯æœ€å¸¸ç”¨çš„æ“ä½œï¼Œè€Œä¸”å®ƒé€šå¸¸ä¸ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œè€Œæ˜¯åƒä¸Šé¢é‚£æ ·ä¸²è¿èµ·æ¥æ“ä½œã€‚ä¸‹é¢çš„ä»£ç ä¸ä¸Šé¢çš„ä»£ç æ˜¯ç­‰åŒçš„ã€‚</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>RACSignal *intervalSignal = [RACSignal interval:1];  
</span><span class='line'>RACSignal *startedIntervalSignal = [intervalSignal startWith:[NSDate date]];  
</span><span class='line'>RACSignal *mappedIntervalSignal = [startedIntervalSignal map:^id(NSDate *value) {  
</span><span class='line'>    NSDateComponents *dateComponents = [[NSCalendar currentCalendar] components:NSMinuteCalendarUnit | NSSecondCalendarUnit fromDate:value];  
</span><span class='line'>      
</span><span class='line'>    return [NSString stringWithFormat:@"%d:%02d", dateComponents.minute, dateComponents.second];  
</span><span class='line'>}];  
</span><span class='line'>   
</span><span class='line'>RAC(self.textField.text) = mappedIntervalSignal;  </span></code></pre></td></tr></table></div></figure>


<h4>äºŒã€Splittingæ¨¡å¼</h4>

<p>Splittingä¸chainingæ¯”è¾ƒç±»ä¼¼ï¼Œä¹Ÿæ˜¯å°†signalè½¬æ¢ä¸ºå…¶å®ƒçš„sginalï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼ŒSplittingä¼šé‡å¤ä½¿ç”¨signalã€‚Splittingçœ‹èµ·æ¥è¦å¤æ‚äº›ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ä¸€ä¸ªsignalä½¿ç”¨å¤šæ¬¡ã€‚</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>RACSignal *dateComponentsSignal = [[[RACSignal interval:1] startWith:[NSDate date]] map:^id(NSDate *value) {  
</span><span class='line'>    NSDateComponents *dateComponents = [[NSCalendar currentCalendar] components:NSMinuteCalendarUnit | NSSecondCalendarUnit fromDate:value];  
</span><span class='line'>    return dateComponents;  
</span><span class='line'>}];  
</span><span class='line'>   
</span><span class='line'>RAC(self.minuteTextField.text) = [dateComponentsSignal map:^id(NSDateComponents *dateComponents) {  
</span><span class='line'>    return [NSString stringWithFormat:@"%d", dateComponents.minute];  
</span><span class='line'>}];  
</span><span class='line'>   
</span><span class='line'>RAC(self.secondTextField.text) = [dateComponentsSignal map:^id(NSDateComponents *dateComponents) {  
</span><span class='line'>    return [NSString stringWithFormat:@"%d", dateComponents.second];  
</span><span class='line'>}];  </span></code></pre></td></tr></table></div></figure>


<p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªsignalï¼Œå³å±€éƒ¨å˜é‡ï¼šdateComponentsSignalã€‚æ¥ç€å†ç”¨dateComponentsSignalåˆ›å»ºä¸¤ä¸ªæ–°çš„signalï¼Œå¹¶å°†å®ƒä»¬åˆ†åˆ«ä¸ä¸¤ä¸ªtextfieldçš„textå±æ€§è¿›è¡Œç»‘å®šã€‚</p>

<blockquote><p>Note: æŠŠdateComponentsSignalçœ‹ä½œä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå°±åƒ,int a = 9; ç„¶åå¤šæ¬¡ä½¿ç”¨aæ¥è®¡ç®—ã€‚</p></blockquote>

<p><img src="http://teehanlax.com.s3.amazonaws.com/wordpress/wp-content/uploads/Splitting.png" alt="Splitting" /></p>

<h4>ä¸‰ã€Combiningæ¨¡å¼</h4>

<p>combiningå°±æ˜¯å°†å‡ ä¸ªsignalç»“åˆèµ·æ¥åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„signalã€‚æ¯”å¦‚â€œç™»å½•â€æŒ‰é’®ï¼Œåªæœ‰åœ¨â€œç”¨æˆ·åâ€ä¸â€œå¯†ç â€è¾“å…¥æ¡†ä¸­çš„æ–‡æœ¬é•¿åº¦éƒ½è¶…è¿‡6æ—¶æ‰èƒ½è¢«ç‚¹å‡»ï¼Œå¦åˆ™å¤„äºä¸å¯ç”¨çš„çŠ¶æ€ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¸ºâ€œç™»å½•â€æŒ‰é’®çš„enabledçŠ¶æ€åˆ›å»ºä¸€ä¸ªsignalï¼Œè¿™ä¸ªsignalåˆ™æ˜¯ç”±â€œç”¨æˆ·åâ€ä¸â€œå¯†ç â€æ¡†å®ƒä»¬ä¸¤ä¸ªè‡ªå·±çš„signalç»„åˆèµ·æ¥ï¼š</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>RAC(self.submitButton.enabled) = [RACSignal combineLatest:@[self.usernameField.rac_textSignal, self.passwordField.rac_textSignal] reduce:^id(NSString *userName, NSString *password) {  
</span><span class='line'>    return @(userName.length &gt;= 6 && password.length &gt;= 6);  
</span><span class='line'>}]; </span></code></pre></td></tr></table></div></figure>


<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†â€œç™»å½•â€æŒ‰é’®çš„enableçŠ¶æ€ç»‘å®šåˆ°ä½¿ç”¨combineLatest:reduce:æ–¹æ³•åˆ›å»ºçš„signalä¸Šã€‚è¿™ä¸ªæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªblockï¼Œè¿™ä¸ªblockçš„å‚æ•°æ˜¯combineLatestä¸­çš„å‚æ•°çš„<strong>æœ€æ–°å€¼</strong>çš„ç»„åˆã€‚æˆ‘ä»¬å°†ä¸¤ä¸ªæ–‡æœ¬æ¡†çš„text signalä¸€èµ·ä¼ åˆ°combineLatestï¼Œåœ¨reduceçš„blockä¸­ï¼Œè¯¥blockä¹Ÿå°±ä¼šæ¥æ”¶åˆ°ä¸¤ä¸ªNSStringçš„å‚æ•°ï¼Œè¿™ä¸ªblockçš„å·¥ä½œå°±æ˜¯å°†ä¸¤ä¸ªå‚æ•°å€¼ç»„åˆèµ·æ¥ç”Ÿæˆä¸€ä¸ªå€¼ï¼Œç„¶åè¿”å›ã€‚è¯¥æ–¹æ³•çš„è¯´æ˜ï¼š</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>// +combineLatest:reduce: takes an array of signals, executes the block with the
</span><span class='line'>// latest value from each signal whenever any of them changes, and returns a new
</span><span class='line'>// RACSignal that sends the return value of that block as values.</span></code></pre></td></tr></table></div></figure>


<p><img src="http://teehanlax.com.s3.amazonaws.com/wordpress/wp-content/uploads/combining.png" alt="Combining" /></p>

<p>Combiningå¸¸ç”¨äºä¸¤ç§æƒ…å†µï¼š</p>

<ol>
<li>éœ€è¦åŒæ—¶æ»¡è¶³å¤šç§æ¡ä»¶ã€‚</li>
<li>åœ¨å¤šä¸ªsignalä¸­è¿›è¡Œé€‰æ‹©ã€‚</li>
</ol>


<h2>ä¼˜ç§€æ–‡ç« </h2>

<p><a href="http://www.teehanlax.com/blog/getting-started-with-reactivecocoa/">Getting Started with ReactiveCocoa</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[#01-å­—é¢é‡è¯­æ³•]]></title>
    <link href="http://limon.top/number-01-zi-mian-liang-yu-fa/"/>
    <updated>2014-05-26T12:40:19+08:00</updated>
    <id>http://limon.top/number-01-zi-mian-liang-yu-fa</id>
    <content type="html"><![CDATA[<h2>å­—é¢é‡æ•°å€¼</h2>

<p>æ™®é€šåˆ›å»ºï¼š</p>

<pre><code>NSNumber *num = [NSNumber numberWithInt:1];
</code></pre>

<p>å­—é¢é‡åˆ›å»º</p>

<pre><code>NSNumber *nub = @1;

int a = 5;
float b = 5.32f;
NSNumber *num = @(a * b);
</code></pre>

<h2>å­—é¢é‡æ•°ç»„</h2>

<p>æ™®é€šåˆ›å»º</p>

<pre><code>NSArray *fruits = [NSArray arrayWithObjects:@"Lemon",@"Apple",nil];
[fruits objectAtIndex:1]; // Apple
</code></pre>

<p>å­—é¢é‡åˆ›å»º</p>

<pre><code>NSArray *fruits = @[@"Lemon",@"Apple"];
fruits[1]; // Apple
</code></pre>

<p><code>fruits[1]</code>è¿™ç§°ä¸ºå–ä¸‹æ ‡æ“ä½œ(subscripting)</p>

<h2>nil</h2>

<p>å­—é¢é‡åˆ›å»ºæ•°ç»„ï¼Œè‹¥æ•°ç»„å…ƒç´ å¯¹è±¡ä¸­æœ‰nilï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å› ä¸ºå­—é¢é‡è¯­æ³•å®é™…ä¸Šæ˜¯ä¸€ç§è¯­æ³•ç³–(syntactic sugar)ï¼Œå…¶æ•ˆæœç­‰äºæ˜¯å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åæŠŠæ–¹æ‹¬å·å†…çš„æ‰€æœ‰å¯¹è±¡éƒ½åŠ åˆ°è¿™ä¸ªæ•°ç»„ã€‚</p>

<pre><code>NSObject *nilObject = nil;
NSArray *fruits = @[@"Lemon",nilObject,@"Apple"]; // å´©äº†
</code></pre>

<p>å¦‚æœä¸ç”¨å­—é¢é‡åˆ›å»ºï¼Œç”¨<code>NSArray arrayWithObjects:</code>åˆ™ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œåªä¼šæå‰ç»“æŸã€‚å¦‚ä¸‹ä¾‹å­ï¼Œé‡åˆ°nilç»“æŸï¼Œfruitsåªæœ‰ä¸€ä¸ªå…ƒç´ </p>

<pre><code>NSObject *nilObject = nil;
NSArray *fruits = [NSArray arrayWithObjects:@"Lemon",nilObject,@"Apple",nil];
</code></pre>

<blockquote><p>å¾®å¦™çš„å·®åˆ«è¡¨æ˜ï¼Œä½¿ç”¨å­—é¢é‡è¯­æ³•æ›´å®‰å…¨ã€‚å‘æ•°ç»„æ’å…¥nilé€šå¸¸è¯´æ˜ç¨‹åºæœ‰é”™ï¼Œè€Œé€šè¿‡å¼‚å¸¸å¯ä»¥æ›´å¿«åœ°å‘ç°è¿™ä¸ªé”™è¯¯ã€‚</p></blockquote>

<h2>å­—é¢é‡å­—å…¸</h2>

<p>å€¼ -> é”®ï¼šæ™®é€šåˆ›å»º</p>

<pre><code>NSDictionary *personData = [NSDictionary dictionaryWithObjectsAndKeys:@"Tom",@"name",[NSNumber numberWithInt:18],@"age", nil];
[personData objectForKey:@"name"]; // Tom
</code></pre>

<p>é”® -> å€¼ï¼šå­—é¢é‡è¯­æ³•åˆ›å»º</p>

<pre><code>NSDictionary *personData = @{@"name": @"Tom",@"age":@18};
personData[@"age"]; // 18
</code></pre>

<h2>å¯å˜æ•°ç»„å’Œå­—å…¸</h2>

<p>å¦‚æœæ•°ç»„ä¸å­—å…¸å¯¹è±¡æ˜¯å¯å˜çš„(mutable)ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡ä¿®æ”¹å¯å˜æ•°ç»„æˆ–å­—å…¸çš„å€¼</p>

<pre><code>mutableArray[1] = @"dog";
mutableDictionary[@"name"] = @"Mary";
</code></pre>

<p>æ™®é€šåšæ³•ï¼š</p>

<pre><code>[mutableArray replaceObjectAtIndex:1 withObject:@"dog"];
[mutableDic setObject:@"Mary" forKey:@"name"];
</code></pre>

<h2>å±€é™</h2>

<p>ä½¿ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºå‡ºæ¥çš„å­—ç¬¦ä¸²ã€æ•°ç»„ã€å­—å…¸å¯¹è±¡éƒ½æ˜¯ä¸å¯å˜çš„(immutable),è‹¥æƒ³å¯å˜ç‰ˆæœ¬çš„å¯¹è±¡ï¼Œåˆ™éœ€è¦èµ‹å€¼ä¸€ä»½</p>

<pre><code>NSMutableDictionary *mutableDic = [@{@"name": @"Tom",@"age":@18} mutableCopy];
</code></pre>

<h2>è¦ç‚¹</h2>

<ul>
<li>åº”è¯¥ä½¿ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºå­—ç¬¦ä¸²ã€æ•°å€¼ã€æ•°ç»„ã€å­—å…¸ã€‚ä¸åˆ›å»ºæ­¤ç±»å¯¹è±¡çš„å¸¸è§„æ–¹æ³•ç›¸æ¯”ï¼Œæ›´åŠ ç®€æ˜æ‰¼è¦ã€‚</li>
<li>åº”è¯¥é€šè¿‡ä¸‹æ ‡æ¥è®¿é—®æ•°ç»„å’Œå­—å…¸</li>
<li>ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºæ•°ç»„æˆ–å­—å…¸æ—¶ï¼Œè‹¥å€¼ä¸­æœ‰nilï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>


<h2>ç•ªå¤–</h2>

<p>JSONæ ¼å¼ï¼Œä¸€å¯¹ <code>{ }</code> ä»£è¡¨ä¸€ä¸ªå­—å…¸ï¼Œä¸€å¯¹<code>[]</code>ä»£è¡¨ä¸€ä¸ªæ•°ç»„</p>

<pre><code>{
    "result": 1,

    "school_list": [
        {
            "id": "5",
            "school_name": "æ¸…åå¤§å­¦"             
        },
        {
            "id": "6",
            "school_name": "åŒ—äº¬é‚®ç”µå¤§å­¦"
        }
    ],

    "school_near": "åŒ—äº¬äº¤é€šå¤§å­¦"
}
</code></pre>

<p>ä»JSON<strong>å­—å…¸</strong>ä¸­é€šè¿‡é”®<code>school_list</code>å–å‡ºæ•°ç»„å¯¹è±¡</p>

<pre><code>NSArray *arr = json[@"school_list"];
NSArray *arr = [json objectForKey:@"school_list"];
</code></pre>

<p>arræ•°ç»„çš„å…ƒç´ æ˜¯ä¸€ä¸ªä¸ªå­—å…¸ï¼Œéå†æ•°ç»„å¾—åˆ°å­—å…¸å†…çš„å­¦æ ¡å</p>

<pre><code>for( int i=0; i&lt;arr.count; i++){
        NSString *schoolName = arr[i][@"school_name"];
        NSString *schoolName = [[arr objectAtIndex:i] objectForKey:@"school_name"];
    }
</code></pre>

<p>å…¶å®arræ•°ç»„å°±æ˜¯PHPå†…çš„äºŒç»´æ•°ç»„ï¼Œåªä¸è¿‡åœ¨OSä¸­ï¼Œ</p>

<ul>
<li>æ•°ç»„ - ä¸‹æ ‡ä¸ºæ•°å­—ï¼ˆPHPä¸­çš„ç´¢å¼•æ•°ç»„ï¼‰</li>
<li>å­—å…¸ - ä¸‹æ ‡ä¸ºå­—ç¬¦ä¸²ï¼ˆPHPä¸­çš„å…³è”æ•°ç»„ï¼‰</li>
</ul>


<p>ä¸Šé¢ä¾‹å­ä¸­äºŒç»´æ•°ç»„arrçš„éå†ï¼Œé€šè¿‡æ•°å­—ä¸‹æ ‡éå†äºŒç»´æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œç„¶åé€šè¿‡å­—ç¬¦ä¸²ä¸‹æ ‡å–å‡ºå­¦æ ¡åã€‚</p>

<blockquote><p>ä¸‹æ ‡ä¹Ÿç§°ä¸ºé”®</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç©è½¬Mantle]]></title>
    <link href="http://limon.top/mantlede-shi-yong/"/>
    <updated>2014-04-23T10:05:15+08:00</updated>
    <id>http://limon.top/mantlede-shi-yong</id>
    <content type="html"><![CDATA[<h2>MTLModel</h2>

<p>MTLModel provides an easy way to map NSDictionary objects to Objective-C classes and vice-versa.</p>

<p>å‡è®¾è¿”å›çš„JSONä¸ºï¼š</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'> {
</span><span class='line'>  "uid": 1,
</span><span class='line'>  "title": "Found a bug",
</span><span class='line'>  "url": "https://api.github.com/repos/octocat/Hello-World/issues/1347",
</span><span class='line'>  "number": 1347,
</span><span class='line'>  "state": "open",
</span><span class='line'>  "user": {
</span><span class='line'>    "login": "octocat",
</span><span class='line'>    "id": 1
</span><span class='line'>  },
</span><span class='line'>  "assignee": {
</span><span class='line'>    "login": "octocat",
</span><span class='line'>    "id": 1,
</span><span class='line'>    "type": "User"
</span><span class='line'>  }
</span><span class='line'>  "created_at": "2011-04-22T13:33:48Z",
</span><span class='line'>  "awesome": true  
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ç»§æ‰¿<code>MTLModel</code>éµå®ˆ<code>&lt;MTLJSONSerializing&gt;</code>åè®®</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>#import &lt;Mantle.h&gt;
</span><span class='line'>
</span><span class='line'>typedef enum : NSUInteger {
</span><span class='line'>    GHIssueStateOpen,
</span><span class='line'>    GHIssueStateClosed
</span><span class='line'>} GHIssueState;
</span><span class='line'>
</span><span class='line'>@interface GHIssue : MTLModel&lt;MTLJSONSerializing&gt;
</span><span class='line'>@property (nonatomic, copy, readonly) NSNumber *uid;
</span><span class='line'>@property (nonatomic, copy, readonly) NSURL *URL;
</span><span class='line'>@property (nonatomic, copy, readonly) NSNumber *number;
</span><span class='line'>@property (nonatomic, assign, readonly) GHIssueState state;
</span><span class='line'>@property (nonatomic, copy, readonly) NSString *reporterLogin;
</span><span class='line'>@property (nonatomic, copy, readonly) NSDate *updatedAt;
</span><span class='line'>@property (nonatomic, strong, readonly) GHUser *assignee;
</span><span class='line'>@property(nonatomic, getter=isAwesome) BOOL awesome;
</span><span class='line'>@property (nonatomic, copy) NSString *title;
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p><code>&lt;MTLJSONSerializing&gt;</code>åè®®å‘Šè¯‰Mantleåºåˆ—åŒ–è¯¥å¯¹è±¡å¦‚ä½•ä»JSONæ˜ å°„åˆ°Objective-Cçš„å±æ€§ã€‚</p>

<h3>NSValueTransformer</h3>

<p>åœ¨.mæ–‡ä»¶ï¼Œå®ç°<code>&lt;MTLJSONSerializing&gt;</code>çš„åè®®<code>@required</code>çš„æ–¹æ³•<code>+ (NSDictionary *)JSONKeyPathsByPropertyKey</code>
å®ƒæŒ‡æ˜äº†å¦‚ä½•æŠŠjsonçš„keypathå’ŒModelçš„å±æ€§å¯¹åº”èµ·æ¥</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>+ (NSDictionary *)JSONKeyPathsByPropertyKey {
</span><span class='line'>  // properties defined in header  :  key in JSON Dictionaryï¼Œæœ¬åœ°å­—æ®µåœ¨å‰ï¼ŒæœåŠ¡ç«¯å­—æ®µåœ¨å
</span><span class='line'>    return @{
</span><span class='line'>        @"URL": @"url",
</span><span class='line'>        @"HTMLURL": @"html_url",
</span><span class='line'>        @"reporterLogin": @"user.login",
</span><span class='line'>        @"assignee": @"assignee",
</span><span class='line'>        @"updatedAt": @"updated_at"
</span><span class='line'>    };
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>å› ä¸ºå¦‚æœå±æ€§åå’ŒJSONçš„é”®åä¸€è‡´æ—¶ï¼Œå¯ä»¥çœç•¥ä¸å†™æ˜ å°„ï¼Œä¾‹å¦‚title</p>

<p>ä»¥ä¸Šåˆ†äº†å‡ ç§æƒ…å†µï¼š
Mantleä½¿ç”¨ä¸»è¦çœ‹å±æ€§propertyä¸­çš„ç±»å‹ï¼Œä¸»è¦åˆ†å‡ ç§ï¼š</p>

<ol>
<li>NSNumberã€NSString&hellip;.</li>
<li>NSArray</li>
<li>NSURL</li>
<li>NSDate</li>
<li>æšä¸¾</li>
<li>æ¨¡å‹</li>
<li>BOOL</li>
</ol>


<p>å…ˆä»‹ç»ä¸€ä¸ªæ–¹æ³•ï¼š<code>+ (NSValueTransformer *)JSONTransformerForKey:(NSString *)key</code></p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>// Specifies how to convert a JSON value to the given property key. If
</span><span class='line'>// reversible, the transformer will also be used to convert the property value
</span><span class='line'>// back to JSON.
</span><span class='line'>//
</span><span class='line'>// If the receiver implements a `+&lt;key&gt;JSONTransformer` method, MTLJSONAdapter
</span><span class='line'>// will use the result of that method instead.
</span><span class='line'>//
</span><span class='line'>// Returns a value transformer, or nil if no transformation should be performed.
</span><span class='line'>+ (NSValueTransformer *)JSONTransformerForKey:(NSString *)key;
</span></code></pre></td></tr></table></div></figure>


<p>ä»¥ä¸‹æ–¹æ³•çš„å‘½åéƒ½è¦éµä»ï¼š<code>SEL selector = MTLSelectorWithKeyPattern(key, "JSONTransformer");</code></p>

<p>1ã€ä¸€èˆ¬åƒtittleï¼Œ<code>@"title": @"title"</code>ä¸ç”¨å†™è¿™è¡Œä¹Ÿè‡ªåŠ¨è½¬åŒ–ã€‚æˆ‘ä¸ªäººè®¤ä¸ºä»æœåŠ¡å™¨è¿”å›çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚æ‰€æœ‰ç†è®ºä¸Šï¼Œuidè¿˜è¦ç”¨<code>NSValueTransformer</code>è½¬åŒ–ï¼Œå¦‚ä¸‹ï¼š</p>

<pre><code>+ (NSValueTransformer *)uidJSONTransformer{
    return [MTLValueTransformer reversibleTransformerWithForwardBlock:^id(NSString *string) {
    return @([string integerValue]);
} reverseBlock:^id(NSNumber *number) {
    return [number stringValue];
}];
</code></pre>

<p>}</p>

<p>ä½†æ˜¯ï¼Œå¦‚æœä½ çš„uidå±æ€§ç±»å‹å®šä¹‰ä¸ºNSNumberï¼Œè¿˜æ˜¯ä¸éœ€ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œåº”è¯¥æ˜¯Mantleè‡ªå·±å¤„ç†äº†ã€‚</p>

<blockquote><p>å¦‚æœä½ å®šä¹‰çš„uidç±»å‹ä¸ºNSUIntegerï¼Œè¿˜æ˜¯éœ€è¦uidJSONTransformer</p></blockquote>

<p>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯<code>@"reporterLogin": @"user.login"</code>
   loginæ˜¯åœ¨JSONå†…å±‚çš„å…ƒç´ ï¼Œéœ€è¦ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•</p>

<pre><code class="```">   + (NSValueTransformer *)reporterLoginJSONTransformer {
        return [MTLValueTransformer reversibleTransformerWithForwardBlock:^(NSArray *values) {
            return [values firstObject];
        } reverseBlock:^(NSString *str) {
            return @[str];
        }];
    }
</code></pre>

<p>2ã€NSArrayè£…æ¨¡å‹</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>  name: "Bob",
</span><span class='line'>  cars: [
</span><span class='line'>    { make: "ford", year: "1972" },
</span><span class='line'>    { make: "mazda", year: "2000" }
</span><span class='line'>  ],
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>@interface CarModel : MTLModel
</span><span class='line'>
</span><span class='line'>@property (nonatomic, strong) NSString *make;
</span><span class='line'>@property (nonatomic, strong) NSString *year;
</span><span class='line'>
</span><span class='line'>@end
</span><span class='line'>
</span><span class='line'>@interface PersonModel : MTLModel
</span><span class='line'>
</span><span class='line'>@property (nonatomic, strong) NSString *name;
</span><span class='line'>@property (nonatomic, strong) NSArray *cars; // NSArraå…ƒç´ æ˜¯Caræ¨¡å‹
</span><span class='line'>
</span><span class='line'>@end</span></code></pre></td></tr></table></div></figure>


<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>+ (NSValueTransformer *)carsJSONTransformer {
</span><span class='line'>    return [NSValueTransformer mtl_JSONArrayTransformerWithModelClass:CarModel.class];
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>3ã€NSURL</p>

<pre><code>+ (NSValueTransformer *)URLJSONTransformer {
    return [NSValueTransformer valueTransformerForName:MTLURLValueTransformerName];
}           
</code></pre>

<p>4ã€NSDate</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>+ (NSDateFormatter *)dateFormatter {
</span><span class='line'>    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
</span><span class='line'>    dateFormatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
</span><span class='line'>    dateFormatter.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss'Z'";
</span><span class='line'>    return dateFormatter;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>+ (NSValueTransformer *)updatedAtJSONTransformer { // æŠŠ"updated_at": "2011-04-22T13:33:48Z"ä¼ ç»™ForwardBlock
</span><span class='line'>    return [MTLValueTransformer reversibleTransformerWithForwardBlock:^(NSString *str) {
</span><span class='line'>        return [self.dateFormatter dateFromString:str]; // æŠŠdateFormatterå†ä¼ ç»™reverseBlock
</span><span class='line'>    } reverseBlock:^(NSDate *date) {
</span><span class='line'>        return [self.dateFormatter stringFromDate:date];
</span><span class='line'>    }]
</span><span class='line'>}
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœJSONçš„æ•°æ®æ ¼å¼æ˜¯Unixæ—¶é—´æˆ³ï¼Œ&#8221;date&#8221;: 1418202490,</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>+ (NSValueTransformer *)dateJSONTransformer {
</span><span class='line'>    return [MTLValueTransformer reversibleTransformerWithForwardBlock:^(NSString *str) {
</span><span class='line'>        return [NSDate dateWithTimeIntervalSince1970:str.floatValue];
</span><span class='line'>    } reverseBlock:^(NSDate *date) {
</span><span class='line'>        return [NSString stringWithFormat:@"%f",[date timeIntervalSince1970]];
</span><span class='line'>    }];
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>5ã€æšä¸¾</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>+ (NSValueTransformer *)stateJSONTransformer {
</span><span class='line'>    return [NSValueTransformer mtl_valueMappingTransformerWithDictionary:@{
</span><span class='line'>        @"open": @(GHIssueStateOpen),
</span><span class='line'>        @"closed": @(GHIssueStateClosed)
</span><span class='line'>    }];
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>6ã€æ¨¡å‹</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>+ (NSValueTransformer *)assigneeJSONTransformer {
</span><span class='line'>    return [NSValueTransformer mtl_JSONDictionaryTransformerWithModelClass:GHUser.class];
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>7ã€ BOOL</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>+ (NSValueTransformer *)awesomeJSONTransformer {
</span><span class='line'>    return [NSValueTransformer valueTransformerForName:MTLBooleanValueTransformerName];
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>ç©ºå¯¹è±¡å¤„ç†</h2>

<p>åœ¨æ¨¡å‹.mæ–‡ä»¶æ·»åŠ <code>-setNilValueForKey</code>ï¼ŒMantleæ˜¯åŸºäºKVCç»™propertyèµ‹å€¼çš„ï¼ŒKVCæä¾›äº†<code>-setNilValueForKey</code>æ–¹æ³•ï¼Œè®©æˆ‘ä»¬ä¸ºnilæŒ‡å®šä¸€ä¸ªåˆç†çš„æ›¿ä»£å€¼</p>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>@interface MTLModel (KTVNullableScalar)
</span><span class='line'>@end
</span><span class='line'>@implementation MTLModel (KTVNullableScalar)
</span><span class='line'>- (void)setNilValueForKey:(NSString *)key {
</span><span class='line'>    [self setValue:@0 forKey:key];  // For NSInteger/CGFloat/BOOL
</span><span class='line'>}
</span><span class='line'>@end</span></code></pre></td></tr></table></div></figure>


<h2>Create model objects from JSON</h2>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>// create NSDictionary from JSON data
</span><span class='line'>NSData JSONData = ... // the JSON response from the API
</span><span class='line'>NSError *error = nil;
</span><span class='line'>NSDictionary *JSONDict = [NSJSONSerialization JSONObjectWithData:JSONData options:0 error:&error];
</span><span class='line'>
</span><span class='line'>// create model object from NSDictionary using MTLJSONSerialisation
</span><span class='line'>CATProfile *profile = [MTLJSONAdapter modelOfClass:CATProfile.class fromJSONDictionary:JSONDict error:NULL];</span></code></pre></td></tr></table></div></figure>


<h2>Create JSON from model objects</h2>

<figure class='code'><div class="highlight"><table style="margin-top: 5px; margin-left: -15px;"><tr><td class="gutter"><pre></pre></td><td class='code'><pre><code class=''><span class='line'>// create NSDictionary from model class using MTLJSONSerialisation
</span><span class='line'>CATProfile *profile = ...
</span><span class='line'>NSDictionary *profileDict = [MTLJSONAdapter JSONDictionaryFromModel:profile];
</span><span class='line'>NSError *error = nil;
</span><span class='line'>// convert NSDictionary to JSON data
</span><span class='line'>NSData *JSONData = [NSJSONSerialization dataWithJSONObject:profileDict options:0 error:&error];</span></code></pre></td></tr></table></div></figure>


<blockquote><p>Noteï¼šå¦‚æœä¸æƒ³JSONDataå«æœ‰æ¨¡å‹çš„æŸä¸ªå±æ€§ï¼Œå¯ä»¥åœ¨æ¨¡å‹JSONKeyPathsByPropertyKeyæ–¹æ³•ä¸­
    return @{ @&ldquo;Name&rdquo;: NSNull.null };</p></blockquote>

<h2>Serialize åºåˆ—åŒ–</h2>

<p>å¾…ç»­&hellip;</p>

<h2>ä¼˜ç§€æ–‡ç« </h2>

<p><a href="http://spin.atomicobject.com/2014/06/23/ios-models-mantle/">Simplify iOS Models With Mantle â€“ An Intro</a></p>

<p><a href="http://www.objc.at/mantle">mantle</a></p>

<p><a href="http://www.cnblogs.com/ipinka/p/4041835.html">iOSçš„Mantleå®æˆ˜</a></p>

<p><a href="http://ke.gitcafe.io/2014/10/13/Why-Changba-iOS-choose-Mantle/">ä¸ºä»€ä¹ˆå”±å§iOS 6.0é€‰æ‹©äº†Mantle</a></p>
]]></content>
  </entry>
  
</feed>
